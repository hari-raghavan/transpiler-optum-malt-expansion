{"textPassword":"${DB_Password}","refreshKrb5Config":null,"keytab":null,"format":"jdbc","cascadeTruncate":null,"secretPassword":[{"type":"pipelineConfiguration","value":["DB_Password"]}],"lowerBound":null,"writeMode":null,"description":"","preSQL":null,"customSchema":null,"postSQL":null,"partitionColumn":null,"pushDownPredicate":true,"truncate":null,"batchsize":null,"query":"SELECT \n              FDS.FORMULARY_DATA_SET_ID,\n              FDS.FORMULARY_NAME,\n              FDS.CAG_CARRIER                           AS  CARRIER,\n              FDS.CAG_ACCOUNT                           AS  'ACCOUNT',\n              FDS.CAG_GROUP                             AS  'GROUP',\n              FDS.RXCLAIM_ENV_NAME ,\n              FDS.FORMULARY_CUSTOMER_ID                 AS CUSTOMER_NAME ,\n              FDS.LAST_EXP_DT,\n              FDS.RUN_EFF_DT,\n              FDSD.FORMULARY_DATA_SET_DTL_ID,\n              FDSD.NDC                                  AS NDC11,\n              FDSD.FORMULARY_TIER,\n              FDSD.FORMULARY_STATUS, \n              FDSD.PA_REQD_IND,\n              FDSD.SPECIALTY_IND,\n              FDSD.STEP_THERAPY_IND,\n              FDSD.FORMULARY_TIER_DESC,\n              FDSD.FORMULARY_STATUS_DESC,\n              FDSD.PA_TYPE_CD,\n              FDSD.STEP_THERAPY_TYPE_CD,\n              FDSD.STEP_THERAPY_GROUP_NAME,\n              FDSD.STEP_THERAPY_STEP_NUMBER\nFROM   \n        FA_OWNER.FORMULARY_DATA_SET_DTL FDSD, FA_OWNER.FORMULARY_DATA_SET FDS,\n(       SELECT OP.CAG_CARRIER, OP.CAG_ACCOUNT, OP.CAG_GROUP, OP.FORMULARY_CUSTOMER_ID, OPFD.FORMULARY_NAME\n        FROM FA_OWNER.OUTPUT_PROFILE OP, FA_OWNER.OUTPUT_PROFILE_FORM_DTL OPFD\n        WHERE OP.OUTPUT_PROFILE_ID = OPFD.OUTPUT_PROFILE_ID\n        AND OP.RXCLAIM_ENV_NAME = '${ENV_NM}' AND OP.REC_ACTIVE_IND = 'Y' AND OP.PUBLISHED_IND = 'Y' AND OPFD.REC_ACTIVE_IND = 'Y'\n        AND OP.FORMULARY_CUSTOMER_ID IS NOT NULL\n        AND OPFD.FORMULARY_NAME IN \n        (\n                SELECT DISTINCT OPFD.FORMULARY_NAME FROM \n                  FA_OWNER.OUTPUT_PROFILE OP, FA_OWNER.OUTPUT_PROFILE_FORM_DTL OPFD,\n                  FA_OWNER.OUTPUT_PROFILE_JOB_DTL OPJD, FA_OWNER.JOB JB\n                WHERE     OP.OUTPUT_PROFILE_ID = OPFD.OUTPUT_PROFILE_ID\n                      AND OP.OUTPUT_PROFILE_ID = OPJD.OUTPUT_PROFILE_ID\n                      AND OPJD.JOB_NAME        = JB.JOB_NAME\n                      AND OP.RXCLAIM_ENV_NAME = '${ENV_NM}' AND OP.REC_ACTIVE_IND = 'Y' AND OP.PUBLISHED_IND = 'Y' \n                      AND OPFD.REC_ACTIVE_IND = 'Y' \n                      AND OPJD.REC_ACTIVE_IND = 'Y'\n                      AND OP.FORMULARY_CUSTOMER_ID IS NOT NULL\n                      AND JB.REC_ACTIVE_IND = 'Y' \n                      AND (TO_DATE('${BUSINESS_DATE}','YYYYMMDD') BETWEEN JB .EFF_DT AND JB .TERM_DT)\n                      AND  (          JB .RUN_DAY IS NULL\n                              OR (    JB .JOB_RUN_FREQ_CD = 2        AND     TO_CHAR(TO_DATE('${BUSINESS_DATE}','YYYYMMDD'),'D') = JB .RUN_DAY )\n                              OR (    JB .JOB_RUN_FREQ_CD = 3        AND     TO_CHAR(TO_DATE('${BUSINESS_DATE}','YYYYMMDD'),'DD') = JB .RUN_DAY )\n                            )\n        )\n        GROUP BY OP.CAG_CARRIER, OP.CAG_ACCOUNT, OP.CAG_GROUP, OP.FORMULARY_CUSTOMER_ID, FORMULARY_NAME )FORM\n        WHERE FORM.FORMULARY_NAME  = FDS.FORMULARY_NAME\n        AND   FORM.FORMULARY_CUSTOMER_ID = FDS.FORMULARY_CUSTOMER_ID\n        AND   FDS.RXCLAIM_ENV_NAME = '${ENV_NM}' AND (FDS.RUN_EFF_DT IS NULL OR (TO_CHAR(FDS.RUN_EFF_DT, 'DDD') = '001' ))\n        AND   FDS.FORMULARY_DATA_SET_ID = FDSD.FORMULARY_DATA_SET_ID\n        AND ( FDS.CAG_CARRIER IS NULL OR \n              FDS.CAG_CARRIER = '*ALL' OR \n              ( ( FDS.CAG_CARRIER = FORM.CAG_CARRIER AND FDS.CAG_ACCOUNT = FORM.CAG_ACCOUNT AND FDS.CAG_GROUP = FORM.CAG_GROUP )\n                OR\n                ( FDS.CAG_CARRIER = FORM.CAG_CARRIER AND FDS.CAG_ACCOUNT = FORM.CAG_ACCOUNT AND FDS.CAG_GROUP = '*ALL' )\n                OR\n                ( FDS.CAG_CARRIER = FORM.CAG_CARRIER AND FDS.CAG_ACCOUNT = '*ALL' AND FDS.CAG_GROUP = '*ALL' )\n              )\n            )","sessionInitStatement":null,"isolationLevel":null,"readFromSource":"sqlQuery","credentialScope":null,"secretUsername":[{"type":"pipelineConfiguration","value":["DB_User"]}],"upperBound":null,"pushDownAggregate":null,"schema":{"type":"struct","fields":[{"name":"formulary_data_set_id","type":"decimal(10,0)","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_name","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_id","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_cd","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"carrier","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"account","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"group","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"rxclaim_env_name","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"customer_name","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"last_exp_dt","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"run_eff_dt","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_data_set_dtl_id","type":"decimal(10,0)","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"ndc11","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_tier","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_status","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pa_reqd_ind","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"specialty_ind","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"step_therapy_ind","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_tier_desc","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"formulary_status_desc","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"pa_type_cd","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"step_therapy_type_cd","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"step_therapy_group_name","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"step_therapy_step_number","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}},{"name":"newline","type":"string","nullable":true,"metadata":{"description":"","mappings":[],"tags":[]}}]},"driver":"${DB_Driver}","createTableColumnTypes":null,"jdbcUrl":"${DB_Url}","fetchsize":null,"dbtable":null,"componentInfo":{"gemId":"gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/jdbc","projectName":"ProphecySparkBasicsScala"},"principal":null,"textUsername":"${DB_User}","createTableOptions":null,"secretJdbcUrl":[{"type":"pipelineConfiguration","value":["DB_Url"]}],"queryTimeout":null,"numPartitions":null,"datasetType":"Warehouse","credType":"userPwd"}