{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : false
    },
    "id" : "altexp_output_profile_cag_mapping",
    "uri" : "pipelines/altexp_output_profile_cag_mapping_inet",
    "language" : "scala",
    "fabricId" : "4856",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "hariprophecyioteam.transpilermaltexpansion.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions" ],
      "initialCode" : "",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "TAR_DTL_LKP_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "DB_User",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "FILE_LOAD_ERR_DTL_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "RUN_TS",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_RUN_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "DB_ALTERNATE_USER",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "UDL_REF_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "DB_Url",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "OUTPUT_PROFILE_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "DB_Password",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAC_DTL_LKP_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "MASTER_REF_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "FORM_REF_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAL_DTL_LKP_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "BUSINESS_DATE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "DB_Driver",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_RUN_JOB_DETAILS_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "CAG_REF_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TSD_DTL_LKP_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "e1",
    "source" : "Get_FILE_LOAD_CNTL_ID",
    "sourcePort" : "Get_FILE_LOAD_CNTL_ID__out",
    "target" : "ALT_RUN_JOB_DETAILS_load_ready",
    "targetPort" : "ALT_RUN_JOB_DETAILS_load_ready__in"
  }, {
    "id" : "e6",
    "source" : "Get_ALT_RUN_ID_jdbc",
    "sourcePort" : "Get_ALT_RUN_ID_jdbc__out",
    "target" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
    "targetPort" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__right"
  }, {
    "id" : "e5",
    "source" : "Generate_Records_For_Load_Ready_Files",
    "sourcePort" : "Generate_Records_For_Load_Ready_Files__out",
    "target" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
    "targetPort" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__left"
  }, {
    "id" : "e9",
    "source" : "Get_FILE_LOAD_CNTL_ID_jdbc",
    "sourcePort" : "Get_FILE_LOAD_CNTL_ID_jdbc__out",
    "target" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
    "targetPort" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__right"
  }, {
    "id" : "e8",
    "source" : "Generate_Record_For_Each_OP_and_Job_Combination",
    "sourcePort" : "Generate_Record_For_Each_OP_and_Job_Combination__out",
    "target" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
    "targetPort" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__left"
  }, {
    "id" : "e11",
    "source" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2__out",
    "target" : "UDL_ref_File",
    "targetPort" : "UDL_ref_File__in"
  }, {
    "id" : "e12",
    "source" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out1",
    "target" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2",
    "targetPort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2__in"
  }, {
    "id" : "e13",
    "source" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0__out",
    "target" : "Master_Cag_Mapping_File",
    "targetPort" : "Master_Cag_Mapping_File__in"
  }, {
    "id" : "e0",
    "source" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__out",
    "target" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
    "targetPort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0__in"
  }, {
    "id" : "e4",
    "source" : "Map_Cag_and_Formulary_Override_URLs_Reformat",
    "sourcePort" : "Map_Cag_and_Formulary_Override_URLs_Reformat__out",
    "target" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
    "targetPort" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__in"
  }, {
    "id" : "e16",
    "source" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out0",
    "target" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
    "targetPort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__in3"
  }, {
    "id" : "e14",
    "source" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out0",
    "target" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
    "targetPort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__in2"
  }, {
    "id" : "e18",
    "source" : "Get_ALT_RUN_ID",
    "sourcePort" : "Get_ALT_RUN_ID__out",
    "target" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1",
    "targetPort" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1__in"
  }, {
    "id" : "e19",
    "source" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0",
    "sourcePort" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0__out",
    "target" : "ALT_RUN_load_ready",
    "targetPort" : "ALT_RUN_load_ready__in"
  }, {
    "id" : "e20",
    "source" : "Get_ALT_RUN_ID",
    "sourcePort" : "Get_ALT_RUN_ID__out",
    "target" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0",
    "targetPort" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0__in"
  }, {
    "id" : "e21",
    "source" : "CAG_Override_Ref",
    "sourcePort" : "CAG_Override_Ref__out",
    "target" : "CAG_Override_Ref_lookup",
    "targetPort" : "CAG_Override_Ref_lookup__in"
  }, {
    "id" : "e22",
    "source" : "Formulary_Override_Ref",
    "sourcePort" : "Formulary_Override_Ref__out",
    "target" : "Formulary_Override_Ref_lookup",
    "targetPort" : "Formulary_Override_Ref_lookup__in"
  }, {
    "id" : "e23",
    "source" : "TAC_Dtl",
    "sourcePort" : "TAC_Dtl__out",
    "target" : "TAC_Dtl_lookup",
    "targetPort" : "TAC_Dtl_lookup__in"
  }, {
    "id" : "e24",
    "source" : "TAL_Dtl",
    "sourcePort" : "TAL_Dtl__out",
    "target" : "TAL_Dtl_lookup",
    "targetPort" : "TAL_Dtl_lookup__in"
  }, {
    "id" : "e26",
    "source" : "TSD_Dtl",
    "sourcePort" : "TSD_Dtl__out",
    "target" : "TSD_Dtl_lookup",
    "targetPort" : "TSD_Dtl_lookup__in"
  }, {
    "id" : "e7",
    "source" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
    "sourcePort" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__out",
    "target" : "Get_ALT_RUN_ID_jdbc_drop_duplicate",
    "targetPort" : "Get_ALT_RUN_ID_jdbc_drop_duplicate__in"
  }, {
    "id" : "e15",
    "source" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
    "sourcePort" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0__out",
    "target" : "Generate_Records_For_Load_Ready_Files",
    "targetPort" : "Generate_Records_For_Load_Ready_Files__in"
  }, {
    "id" : "e28",
    "source" : "Generate_Records_For_Load_Ready_Files",
    "sourcePort" : "Generate_Records_For_Load_Ready_Files__out",
    "target" : "Get_ALT_RUN_ID",
    "targetPort" : "Get_ALT_RUN_ID__left"
  }, {
    "id" : "e27",
    "source" : "Get_ALT_RUN_ID_jdbc_drop_duplicate",
    "sourcePort" : "Get_ALT_RUN_ID_jdbc_drop_duplicate__out",
    "target" : "Get_ALT_RUN_ID",
    "targetPort" : "Get_ALT_RUN_ID__right"
  }, {
    "id" : "e10",
    "source" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
    "sourcePort" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__out",
    "target" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate",
    "targetPort" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate__in"
  }, {
    "id" : "e17",
    "source" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1",
    "sourcePort" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1__out",
    "target" : "Generate_Record_For_Each_OP_and_Job_Combination",
    "targetPort" : "Generate_Record_For_Each_OP_and_Job_Combination__in"
  }, {
    "id" : "e30",
    "source" : "Generate_Record_For_Each_OP_and_Job_Combination",
    "sourcePort" : "Generate_Record_For_Each_OP_and_Job_Combination__out",
    "target" : "Get_FILE_LOAD_CNTL_ID",
    "targetPort" : "Get_FILE_LOAD_CNTL_ID__left"
  }, {
    "id" : "e29",
    "source" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate",
    "sourcePort" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate__out",
    "target" : "Get_FILE_LOAD_CNTL_ID",
    "targetPort" : "Get_FILE_LOAD_CNTL_ID__right"
  }, {
    "id" : "y0mcjImXnY2GkIA6Od-rU",
    "source" : "Output_Profile_Extract",
    "sourcePort" : "Output_Profile_Extract__out",
    "target" : "syLtdOT4Ihbx5GgyVg-7z$$RNRBsuspMldUum9t7qhhf",
    "targetPort" : "5Ksu8GOsqJ8p2xXRTAg29$$h88lbA-ba4gTkFFzUdOUM"
  }, {
    "id" : "NiK4NTvKByvXdg1nugSSk$$nEnt5o3TwkLuT3BCEpUYa",
    "source" : "syLtdOT4Ihbx5GgyVg-7z$$RNRBsuspMldUum9t7qhhf",
    "sourcePort" : "MWcC9QjG9uaLgaIGgOjgt$$epvohc8u5CbhmkK_r9RdT",
    "target" : "Map_Cag_and_Formulary_Override_URLs_Reformat",
    "targetPort" : "Map_Cag_and_Formulary_Override_URLs_Reformat__in"
  }, {
    "id" : "PTYvMnvF7P0aEs9Sp9Jns",
    "source" : "YsAQTP757HhG6zfNscHRp$$Ad20DiTfB2bKocr0BKEz5",
    "sourcePort" : "4OW84t2bpUpk1S-fGX_1n$$2bOH1WdczfzKuExCfuq1K",
    "target" : "UcUq2e2GRk6VQIP8j-w8X$$JGfYINNHK-VUgAtYk2TUE",
    "targetPort" : "31orhINwF-C_M1V-zLpdD$$u1xLT7le9tAXaJ33LRJ14"
  }, {
    "id" : "m-hmqbsTwz2_pS4fw8Al0",
    "source" : "TAR_Dtl",
    "sourcePort" : "TAR_Dtl__out",
    "target" : "by5mtQMLZ1DT15LoBl5gM$$BxPAbsTA4hN7znrksjdsi",
    "targetPort" : "-1xOFtntTqm0MDfUjyscr$$Fv1EuMyBF9jLa_1E-3h4t"
  } ],
  "processes" : {
    "Map_Cag_and_Formulary_Override_URLs_Reformat" : {
      "id" : "Map_Cag_and_Formulary_Override_URLs_Reformat",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Map_Cag_and_Formulary_Override_URLs_Reformat",
        "slug" : "Map_Cag_and_Formulary_Override_URLs_Reformat",
        "x" : 420,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Map_Cag_and_Formulary_Override_URLs_Reformat__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Map_Cag_and_Formulary_Override_URLs_Reformat__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "carrier",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"carrier\")"
          },
          "description" : ""
        }, {
          "target" : "account",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"account\")"
          },
          "description" : ""
        }, {
          "target" : "group",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"group\")"
          },
          "description" : ""
        }, {
          "target" : "future_flg",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"future_flg\"), lit(\"C\"))"
          },
          "description" : ""
        }, {
          "target" : "cag_override_data_path",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"cag_override_data_path\")"
          },
          "description" : ""
        }, {
          "target" : "qual_output_profile_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"qual_output_profile_ids\")"
          },
          "description" : ""
        }, {
          "target" : "op_dtls",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"op_dtls\")"
          },
          "description" : ""
        }, {
          "target" : "non_qual_output_profile_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"non_qual_output_profile_ids\")"
          },
          "description" : ""
        }, {
          "target" : "err_msgs",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"err_msgs\")"
          },
          "description" : ""
        }, {
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"as_of_dt\")"
          },
          "description" : ""
        }, {
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown" : {
      "id" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
      "component" : "Script",
      "metadata" : {
        "label" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
        "slug" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown",
        "x" : 1420,
        "y" : 820,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__right",
          "slug" : "right",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "nextval",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__left",
          "slug" : "left",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_ALT_RUN_ID_jdbcdb_predicate_pushdown__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "nextval",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "  lazy val out = right.collectDataFrameColumnsToApplyFilter(List(\"\"), left)\n\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, left: DataFrame, right: DataFrame) : Script = {",
        "scriptMethodFooter" : "out"
      }
    },
    "TSD_Dtl_lookup" : {
      "id" : "TSD_Dtl_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "TSD_Dtl_lookup",
        "slug" : "TSD_Dtl_lookup",
        "x" : 220,
        "y" : 1220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TSD_Dtl_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tsd_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tsd_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tsd_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tsd_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tsd_name" ],
        "valueColumns" : [ "tsd_dtl_id", "tsd_id", "tsd_name", "tsd_cd", "formulary_tier", "formulary_status", "priority", "eff_dt", "term_dt", "newline" ],
        "processName" : "TSD_Dtl"
      }
    },
    "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1" : {
      "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1",
        "slug" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1",
        "x" : 2080,
        "y" : 1120,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_1__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "alt_run_id",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
          },
          "description" : ""
        }, {
          "target" : "output_profile_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"output_profile_id\")"
          },
          "description" : ""
        }, {
          "target" : "job_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"job_ids\")"
          },
          "description" : ""
        }, {
          "target" : "err_msg",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"err_msg\")"
          },
          "description" : ""
        }, {
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"as_of_dt\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Master_Cag_Mapping_File" : {
      "id" : "Master_Cag_Mapping_File",
      "component" : "Target",
      "metadata" : {
        "label" : "Master_Cag_Mapping_File",
        "slug" : "Master_Cag_Mapping_File",
        "x" : 1220,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Master_Cag_Mapping_File__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Master_Cag_Mapping_File"
      }
    },
    "UDL_ref_File" : {
      "id" : "UDL_ref_File",
      "component" : "Target",
      "metadata" : {
        "label" : "UDL_ref_File",
        "slug" : "UDL_ref_File",
        "x" : 1020,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "UDL_ref_File__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/UDL_ref_File"
      }
    },
    "Get_ALT_RUN_ID_jdbc_drop_duplicate" : {
      "id" : "Get_ALT_RUN_ID_jdbc_drop_duplicate",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Get_ALT_RUN_ID_jdbc_drop_duplicate",
        "slug" : "Get_ALT_RUN_ID_jdbc_drop_duplicate",
        "x" : 1620,
        "y" : 820,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_ALT_RUN_ID_jdbc_drop_duplicate__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "nextval",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_ALT_RUN_ID_jdbc_drop_duplicate__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "dedupColumns" : [ {
          "colName" : "nextval"
        } ],
        "dedupType" : "any",
        "columnsSelector" : [ "Get_ALT_RUN_ID_jdbc_drop_duplicate__in##nextval" ],
        "orders" : [ ],
        "useOrderBy" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Deduplicate",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll" : {
      "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
      "component" : "SetOperation",
      "metadata" : {
        "label" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
        "slug" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll",
        "x" : 820,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__in3",
          "slug" : "in3",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__in2",
          "slug" : "in2",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0_UnionAll__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "operationType" : "unionAll",
        "allowMissingColumns" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Get_ALT_RUN_ID" : {
      "id" : "Get_ALT_RUN_ID",
      "component" : "Join",
      "metadata" : {
        "label" : "Get_ALT_RUN_ID",
        "slug" : "Get_ALT_RUN_ID",
        "x" : 1880,
        "y" : 920,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_ALT_RUN_ID__left",
          "slug" : "left",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Get_ALT_RUN_ID__right",
          "slug" : "right",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "nextval",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_ALT_RUN_ID__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "right",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(true)"
          },
          "joinType" : "left_outer"
        } ],
        "expressions" : [ {
          "_row_id" : null,
          "target" : "alt_run_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"right.nextval\").cast(DecimalType(16, 0))"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "output_profile_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"left.output_profile_id\")"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "job_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"left.job_ids\")"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "err_msg",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"left.err_msg\")"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"left.as_of_dt\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "in0",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "in1",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "left"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Join",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "TAR_Dtl" : {
      "id" : "TAR_Dtl",
      "component" : "Source",
      "metadata" : {
        "label" : "TAR_Dtl",
        "slug" : "TAR_Dtl",
        "x" : 20,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAR_Dtl__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAR_Dtl"
      }
    },
    "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0" : {
      "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0",
        "slug" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0",
        "x" : 2080,
        "y" : 720,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Create_ALT_RUN_ALT_RUN_JOB_DETAILS_Load_Ready_FileReformat_0__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "alt_run_id",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
          },
          "description" : ""
        }, {
          "target" : "output_profile_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"output_profile_id\").cast(DecimalType(10, 0))"
          },
          "description" : ""
        }, {
          "target" : "run_start_ts",
          "expression" : {
            "format" : "scala",
            "expression" : "date_format(\n    to_timestamp(\n      substring(\n        datetime_add(\n          datetime_from_unixtime(file_information(lit(Config.OUTPUT_PROFILE_FILE)).getField(\"created\"))\n            .cast(StringType),\n          lit(0).cast(LongType),\n          lit(-6).cast(LongType),\n          lit(0).cast(LongType),\n          lit(0).cast(LongType)\n        ),\n        1,\n        14\n      ),\n      \"yyyyMMddHHmmss\"\n    ),\n    \"yyyy-MM-dd HH:mm:ss\"\n  )"
          },
          "description" : ""
        }, {
          "target" : "run_complete_ts",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.RUN_TS)"
          },
          "description" : ""
        }, {
          "target" : "alt_run_status_cd",
          "expression" : {
            "format" : "scala",
            "expression" : "when(is_blank(col(\"err_msg\")), lit(1)).otherwise(lit(4)).cast(StringType)"
          },
          "description" : ""
        }, {
          "target" : "published_ind",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(\"Y\")"
          },
          "description" : ""
        }, {
          "target" : "rec_crt_ts",
          "expression" : {
            "format" : "scala",
            "expression" : "date_format(\n    to_timestamp(\n      substring(\n        datetime_add(\n          datetime_from_unixtime(file_information(lit(Config.OUTPUT_PROFILE_FILE)).getField(\"created\"))\n            .cast(StringType),\n          lit(0).cast(LongType),\n          lit(-6).cast(LongType),\n          lit(0).cast(LongType),\n          lit(0).cast(LongType)\n        ),\n        1,\n        14\n      ),\n      \"yyyyMMddHHmmss\"\n    ),\n    \"yyyy-MM-dd HH:mm:ss\"\n  )"
          },
          "description" : ""
        }, {
          "target" : "rec_crt_user_id",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.DB_ALTERNATE_USER)"
          },
          "description" : ""
        }, {
          "target" : "rec_last_upd_ts",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.RUN_TS)"
          },
          "description" : ""
        }, {
          "target" : "rec_last_upd_user_id",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.DB_ALTERNATE_USER)"
          },
          "description" : ""
        }, {
          "target" : "run_eff_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.BUSINESS_DATE)"
          },
          "description" : ""
        }, {
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"as_of_dt\")"
          },
          "description" : ""
        }, {
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(rpad(lit(\"\\n\"), 1, \" \"), lit(\"\\n\"))"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Output_Profile_Extract" : {
      "id" : "Output_Profile_Extract",
      "component" : "Source",
      "metadata" : {
        "label" : "Output_Profile_Extract",
        "slug" : "Output_Profile_Extract",
        "x" : 20,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Output_Profile_Extract__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Output_Profile_Extract"
      }
    },
    "Get_FILE_LOAD_CNTL_ID_jdbc" : {
      "id" : "Get_FILE_LOAD_CNTL_ID_jdbc",
      "component" : "Source",
      "metadata" : {
        "label" : "Get_FILE_LOAD_CNTL_ID_jdbc",
        "slug" : "Get_FILE_LOAD_CNTL_ID_jdbc",
        "x" : 2280,
        "y" : 920,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbc__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Get_FILE_LOAD_CNTL_ID_jdbc"
      }
    },
    "CAG_Override_Ref" : {
      "id" : "CAG_Override_Ref",
      "component" : "Source",
      "metadata" : {
        "label" : "CAG_Override_Ref",
        "slug" : "CAG_Override_Ref",
        "x" : 20,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "CAG_Override_Ref__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/CAG_Override_Ref"
      }
    },
    "ALT_RUN_load_ready" : {
      "id" : "ALT_RUN_load_ready",
      "component" : "Target",
      "metadata" : {
        "label" : "ALT_RUN_load_ready",
        "slug" : "ALT_RUN_load_ready",
        "x" : 2280,
        "y" : 720,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ALT_RUN_load_ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_start_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_complete_ts",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_status_cd",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "published_ind",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_last_upd_ts",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_last_upd_user_id",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_eff_dt",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/ALT_RUN_load_ready"
      }
    },
    "YsAQTP757HhG6zfNscHRp$$Ad20DiTfB2bKocr0BKEz5" : {
      "id" : "YsAQTP757HhG6zfNscHRp$$Ad20DiTfB2bKocr0BKEz5",
      "component" : "Source",
      "metadata" : {
        "label" : "Form_ref_file_lkp",
        "slug" : "Form_ref_file_lkp",
        "x" : 460,
        "y" : 420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "4OW84t2bpUpk1S-fGX_1n$$2bOH1WdczfzKuExCfuq1K",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Form_ref_file_lkp"
      }
    },
    "TAL_Dtl" : {
      "id" : "TAL_Dtl",
      "component" : "Source",
      "metadata" : {
        "label" : "TAL_Dtl",
        "slug" : "TAL_Dtl",
        "x" : 20,
        "y" : 220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAL_Dtl__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAL_Dtl"
      }
    },
    "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate" : {
      "id" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate",
        "slug" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate",
        "x" : 2680,
        "y" : 940,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "file_load_cntl_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbc_drop_duplicate__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "dedupColumns" : [ {
          "colName" : "job_id"
        } ],
        "dedupType" : "any",
        "columnsSelector" : [ ],
        "orders" : [ ],
        "useOrderBy" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Deduplicate",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Separate_records_to_create_as_of_dt_reference_fileReformat_2" : {
      "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2",
        "slug" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2",
        "x" : 820,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_2__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"as_of_dt\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Separate_records_to_create_as_of_dt_reference_fileReformat_0" : {
      "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
        "slug" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0",
        "x" : 1020,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_fileReformat_0__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "carrier",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"carrier\")"
          },
          "description" : ""
        }, {
          "target" : "account",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"account\")"
          },
          "description" : ""
        }, {
          "target" : "group",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"group\")"
          },
          "description" : ""
        }, {
          "target" : "future_flg",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"future_flg\"), lit(\"C\"))"
          },
          "description" : ""
        }, {
          "target" : "cag_override_data_path",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"cag_override_data_path\")"
          },
          "description" : ""
        }, {
          "target" : "qual_output_profile_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"qual_output_profile_ids\")"
          },
          "description" : ""
        }, {
          "target" : "op_dtls",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"op_dtls\")"
          },
          "description" : ""
        }, {
          "target" : "non_qual_output_profile_ids",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"non_qual_output_profile_ids\")"
          },
          "description" : ""
        }, {
          "target" : "err_msgs",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"err_msgs\")"
          },
          "description" : ""
        }, {
          "target" : "as_of_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"as_of_dt\")"
          },
          "description" : ""
        }, {
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "TAC_Dtl_lookup" : {
      "id" : "TAC_Dtl_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "TAC_Dtl_lookup",
        "slug" : "TAC_Dtl_lookup",
        "x" : 220,
        "y" : 1020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TAC_Dtl_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tac_name" ],
        "valueColumns" : [ "tac_dtl_id", "tac_id", "tac_name", "priority", "target_rule", "alt_rule", "eff_dt", "term_dt", "newline" ],
        "processName" : "TAC_Dtl"
      }
    },
    "Formulary_Override_Ref_lookup" : {
      "id" : "Formulary_Override_Ref_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Formulary_Override_Ref_lookup",
        "slug" : "Formulary_Override_Ref_lookup",
        "x" : 220,
        "y" : 620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Formulary_Override_Ref_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_future_snap",
              "type" : "decimal(1,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "data_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "formulary_name", "carrier", "account", "group", "customer_name", "is_future_snap" ],
        "valueColumns" : [ "formulary_name", "carrier", "account", "group", "customer_name", "is_future_snap", "data_path", "run_eff_dt", "newline" ],
        "processName" : "Formulary_Override_Ref"
      }
    },
    "Get_FILE_LOAD_CNTL_ID" : {
      "id" : "Get_FILE_LOAD_CNTL_ID",
      "component" : "Join",
      "metadata" : {
        "label" : "Get_FILE_LOAD_CNTL_ID",
        "slug" : "Get_FILE_LOAD_CNTL_ID",
        "x" : 2940,
        "y" : 1020,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID__left",
          "slug" : "left",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Get_FILE_LOAD_CNTL_ID__right",
          "slug" : "right",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "file_load_cntl_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "right",
          "expression" : {
            "format" : "scala",
            "expression" : "(col(\"left.job_id\") === col(\"right.job_id\"))"
          },
          "joinType" : "left_outer"
        } ],
        "expressions" : [ {
          "_row_id" : null,
          "target" : "alt_run_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"left.alt_run_id\")"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "job_run_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"right.file_load_cntl_id\").cast(DecimalType(16, 0))"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "rec_crt_ts",
          "expression" : {
            "format" : "scala",
            "expression" : "date_format(to_timestamp(substring(datetime_add(datetime_from_unixtime(file_information(lit(Config.OUTPUT_PROFILE_FILE)).getField(\"created\")).cast(StringType), lit(0).cast(LongType), lit(-6).cast(LongType), lit(0).cast(LongType), lit(0).cast(LongType)), 1, 14), \"yyyyMMddHHmmss\"), \"yyyy-MM-dd HH:mm:ss\")"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "rec_crt_user_id",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(Config.DB_ALTERNATE_USER)"
          },
          "description" : ""
        }, {
          "_row_id" : null,
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "lit(\"\\n\").cast(StringType)"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "in0",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "in1",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "left"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Join",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "ALT_RUN_JOB_DETAILS_load_ready" : {
      "id" : "ALT_RUN_JOB_DETAILS_load_ready",
      "component" : "Target",
      "metadata" : {
        "label" : "ALT_RUN_JOB_DETAILS_load_ready",
        "slug" : "ALT_RUN_JOB_DETAILS_load_ready",
        "x" : 3140,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ALT_RUN_JOB_DETAILS_load_ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/ALT_RUN_JOB_DETAILS_load_ready"
      }
    },
    "TAL_Dtl_lookup" : {
      "id" : "TAL_Dtl_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "TAL_Dtl_lookup",
        "slug" : "TAL_Dtl_lookup",
        "x" : 220,
        "y" : 220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TAL_Dtl_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_dtl_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "nested_tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tal_name" ],
        "valueColumns" : [ "tal_dtl_id", "tal_id", "tal_name", "tal_desc", "tal_dtl_type_cd", "nested_tal_name", "tal_assoc_name", "priority", "eff_dt", "term_dt", "newline" ],
        "processName" : "TAL_Dtl"
      }
    },
    "Generate_Record_For_Each_OP_and_Job_Combination" : {
      "id" : "Generate_Record_For_Each_OP_and_Job_Combination",
      "component" : "Script",
      "metadata" : {
        "label" : "Generate_Record_For_Each_OP_and_Job_Combination",
        "slug" : "Generate_Record_For_Each_OP_and_Job_Combination",
        "x" : 2280,
        "y" : 1120,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Generate_Record_For_Each_OP_and_Job_Combination__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Generate_Record_For_Each_OP_and_Job_Combination__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"job_ids\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List((element_at(col(\"job_ids\"), col(\"index\") + lit(1))).as(\"job_id\")),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"alt_run_id\").cast(DecimalType(16, 0))).as(\"alt_run_id\"),\n    (col(\"output_profile_id\")).as(\"output_profile_id\"),\n    (col(\"job_id\")).as(\"job_id\"),\n    (col(\"err_msg\")).as(\"err_msg\")\n  )\n\n  val out = simpleSelect_in_DF\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
        "scriptMethodFooter" : "out"
      }
    },
    "TAC_Dtl" : {
      "id" : "TAC_Dtl",
      "component" : "Source",
      "metadata" : {
        "label" : "TAC_Dtl",
        "slug" : "TAC_Dtl",
        "x" : 20,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAC_Dtl__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAC_Dtl"
      }
    },
    "UcUq2e2GRk6VQIP8j-w8X$$JGfYINNHK-VUgAtYk2TUE" : {
      "id" : "UcUq2e2GRk6VQIP8j-w8X$$JGfYINNHK-VUgAtYk2TUE",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Form_ref_file_lkp_lookup",
        "slug" : "Form_ref_file_lkp_lookup",
        "x" : 680,
        "y" : 420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "31orhINwF-C_M1V-zLpdD$$u1xLT7le9tAXaJ33LRJ14",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_future_snap",
              "type" : "decimal(1,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "data_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "formulary_name", "carrier", "account", "group", "customer_name", "is_future_snap" ],
        "valueColumns" : [ "formulary_name", "carrier", "account", "group", "customer_name", "is_future_snap", "data_path", "run_eff_dt", "newline" ],
        "processName" : "form_ref_file_lkp"
      }
    },
    "Formulary_Override_Ref" : {
      "id" : "Formulary_Override_Ref",
      "component" : "Source",
      "metadata" : {
        "label" : "Formulary_Override_Ref",
        "slug" : "Formulary_Override_Ref",
        "x" : 20,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Formulary_Override_Ref__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Formulary_Override_Ref"
      }
    },
    "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown" : {
      "id" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
      "component" : "Script",
      "metadata" : {
        "label" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
        "slug" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown",
        "x" : 2480,
        "y" : 940,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__right",
          "slug" : "right",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "file_load_cntl_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__left",
          "slug" : "left",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Get_FILE_LOAD_CNTL_ID_jdbcdb_predicate_pushdown__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "file_load_cntl_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "  lazy val out = right.collectDataFrameColumnsToApplyFilter(List(\"job_id\"), left)\n\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, right: DataFrame, left: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out\n}"
      }
    },
    "Generate_Records_For_Load_Ready_Files" : {
      "id" : "Generate_Records_For_Load_Ready_Files",
      "component" : "Script",
      "metadata" : {
        "label" : "Generate_Records_For_Load_Ready_Files",
        "slug" : "Generate_Records_For_Load_Ready_Files",
        "x" : 1220,
        "y" : 1020,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Generate_Records_For_Load_Ready_Files__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Generate_Records_For_Load_Ready_Files__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "output_profile_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_ids",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some((size(col(\"qual_output_profile_ids\")) + size(col(\"non_qual_output_profile_ids\")))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (when(col(\"index\") < col(\"qual_len\"), element_at(col(\"qual_output_profile_ids\"), col(\"index\") + lit(1)))\n        .otherwise(\n          element_at(col(\"non_qual_output_profile_ids\"), (col(\"index\") - col(\"qual_len\")).cast(IntegerType) + lit(1))\n            .getField(\"non_qual_op_id\")\n        )\n        .cast(StringType))\n        .as(\"output_profile_id\"),\n      (when(col(\"index\") < col(\"qual_len\"), element_at(col(\"op_dtls\"), col(\"index\") + lit(1)).getField(\"job_ids\"))\n        .otherwise(\n          element_at(col(\"non_qual_output_profile_ids\"), (col(\"index\") - col(\"qual_len\")).cast(IntegerType) + lit(1))\n            .getField(\"job_ids\")\n        ))\n        .as(\"job_ids\"),\n      (when(col(\"index\") >= col(\"qual_len\"),\n            element_at(col(\"err_msgs\"), (col(\"index\") - col(\"qual_len\")).cast(IntegerType) + lit(1))\n      ).otherwise(lit(\"\"))).as(\"err_msg\")\n    ),\n    lengthRelatedGlobalExpressions = Map(\"qual_len\" -> size(col(\"qual_output_profile_ids\"))),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select((col(\"output_profile_id\")).as(\"output_profile_id\"),\n                                                   (col(\"job_ids\")).as(\"job_ids\"),\n                                                   (col(\"err_msg\")).as(\"err_msg\"),\n                                                   (col(\"as_of_dt\")).as(\"as_of_dt\")\n  )\n\n  val out = simpleSelect_in_DF\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
        "scriptMethodFooter" : "out"
      }
    },
    "by5mtQMLZ1DT15LoBl5gM$$BxPAbsTA4hN7znrksjdsi" : {
      "id" : "by5mtQMLZ1DT15LoBl5gM$$BxPAbsTA4hN7znrksjdsi",
      "component" : "Script",
      "metadata" : {
        "label" : "TAR_Dtl_lookup",
        "slug" : "TAR_Dtl_lookup",
        "x" : 220,
        "y" : 420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "-1xOFtntTqm0MDfUjyscr$$Fv1EuMyBF9jLa_1E-3h4t",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tar_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "sort_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "filter_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_roa_df_set_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rebate_elig_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      },
      "properties" : {
        "script" : "createExtendedLookup(\n      \"TAR_Dtl\",\n      in0,\n      spark,\n      List(LookupCondition(\"tar_name\", \"==\", \"in1\"), LookupCondition(\"eff_dt\", \"<=\", \"in2\"), LookupCondition(\"term_dt\", \">\", \"in2\")),\n      List(\"in1\", \"in2\"),\n      \"tar_id\",\n      \"tar_dtl_id\",\n      \"tar_name\",\n      \"sort_ind\",\n      \"filter_ind\",\n      \"priority\",\n      \"tar_dtl_type_cd\",\n      \"tar_roa_df_set_id\",\n      \"target_rule\",\n      \"alt_rule\",\n      \"rebate_elig_cd\",\n      \"eff_dt\",\n      \"term_dt\",\n      \"newline\"\n)",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): Unit = {",
        "scriptMethodFooter" : "    \n}"
      }
    },
    "Get_ALT_RUN_ID_jdbc" : {
      "id" : "Get_ALT_RUN_ID_jdbc",
      "component" : "Source",
      "metadata" : {
        "label" : "Get_ALT_RUN_ID_jdbc",
        "slug" : "Get_ALT_RUN_ID_jdbc",
        "x" : 1220,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Get_ALT_RUN_ID_jdbc__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Get_ALT_RUN_ID_jdbc"
      }
    },
    "TSD_Dtl" : {
      "id" : "TSD_Dtl",
      "component" : "Source",
      "metadata" : {
        "label" : "TSD_Dtl",
        "slug" : "TSD_Dtl",
        "x" : 20,
        "y" : 1220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TSD_Dtl__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TSD_Dtl"
      }
    },
    "Separate_records_to_create_as_of_dt_reference_file_RowDistributor" : {
      "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
      "component" : "RowDistributor",
      "metadata" : {
        "label" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
        "slug" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor",
        "x" : 620,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out0",
          "slug" : "out0"
        }, {
          "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out1",
          "slug" : "out1"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "outports" : [ {
          "path" : "out0",
          "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out0",
          "model" : {
            "format" : "scala",
            "expression" : "lit(true)"
          }
        }, {
          "path" : "out1",
          "id" : "Separate_records_to_create_as_of_dt_reference_file_RowDistributor__out1",
          "model" : {
            "format" : "scala",
            "expression" : "lit(true)"
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "syLtdOT4Ihbx5GgyVg-7z$$RNRBsuspMldUum9t7qhhf" : {
      "id" : "syLtdOT4Ihbx5GgyVg-7z$$RNRBsuspMldUum9t7qhhf",
      "component" : "Script",
      "metadata" : {
        "label" : "Map_Cag_and_Formulary_Override_URLs",
        "slug" : "Map_Cag_and_Formulary_Override_URLs",
        "x" : 220,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "5Ksu8GOsqJ8p2xXRTAg29$$h88lbA-ba4gTkFFzUdOUM",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "output_profile_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rxclaim_env_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_form_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_job_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alias_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alias_priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tsd_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "job_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "customer_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_day",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "lob_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_jan1_start_mmdd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_jan1_end_mmdd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_pseudonym",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "notes_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "output_profile_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_option_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "layout_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "st_tac_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "MWcC9QjG9uaLgaIGgOjgt$$epvohc8u5CbhmkK_r9RdT",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "future_flg",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "as_of_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "cag_override_data_path",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "op_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qual_output_profile_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "form_override_data_paths",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tal_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tac_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tar_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "tsd_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "st_tac_ind",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "non_qual_output_profile_ids",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "non_qual_op_id",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rxclaim_env_name",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_ids",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "formulary_pseudonyms",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alias_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "job_names",
                    "type" : {
                      "type" : "array",
                      "elementType" : "string",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "err_msgs",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "def frmlry_url() = {\n  when(\n    (coalesce(\n      lookup(\"Formulary_Override_Ref\",\n             col(\"formulary_id\"),\n             lit(null),\n             lit(null),\n             lit(null),\n             lit(null),\n             col(\"future_flg\")\n      ).getField(\"data_path\"),\n      when(lit(Config.ENV_NM) === lit(\"RXBK1-PRD\"),\n           lookup(\"form_ref_file_lkp\", col(\"formulary_id\"), lit(null), lit(null), lit(null), lit(null), col(\"future_flg\")).getField(\n             \"data_path\"\n           )\n      ).otherwise(lit(null)),\n      lit(\"FORMULARY_NOT_FOUND\")\n    ) =!= lit(\"FORMULARY_NOT_FOUND\")).and(col(\"future_flg\") === lit(2)),\n    when(\n      coalesce(\n        lookup(\"Formulary_Override_Ref\",\n               col(\"formulary_id\"),\n               lit(null),\n               lit(null),\n               lit(null),\n               lit(null),\n               col(\"future_flg\")\n        ).getField(\"run_eff_dt\"),\n        when(lit(Config.ENV_NM) === lit(\"RXBK1-PRD\"),\n             lookup(\"form_ref_file_lkp\", col(\"formulary_id\"), lit(null), lit(null), lit(null), lit(null), col(\"future_flg\")).getField(\n               \"run_eff_dt\"\n             )\n        )\n      ) > col(\"as_of_dt\"),\n      lit(\"NOT_A_VALID_AS_OF_DT\")\n    ).otherwise(\n      coalesce(\n        lookup(\"Formulary_Override_Ref\",\n               col(\"formulary_id\"),\n               lit(null),\n               lit(null),\n               lit(null),\n               lit(null),\n               col(\"future_flg\")\n        ).getField(\"data_path\"),\n        when(lit(Config.ENV_NM) === lit(\"RXBK1-PRD\"),\n             lookup(\"form_ref_file_lkp\", col(\"formulary_id\"), lit(null), lit(null), lit(null), lit(null), col(\"future_flg\"))\n               .getField(\"data_path\")\n        ).otherwise(lit(null)),\n        lit(\"FORMULARY_NOT_FOUND\")\n      )\n    )\n  ).otherwise(\n    coalesce(\n      lookup(\"Formulary_Override_Ref\",\n             col(\"formulary_id\"),\n             lit(null),\n             lit(null),\n             lit(null),\n             lit(null),\n             col(\"future_flg\")\n      ).getField(\"data_path\"),\n      when(lit(Config.ENV_NM) === lit(\"RXBK1-PRD\"),\n           lookup(\"form_ref_file_lkp\", col(\"formulary_id\"), lit(null), lit(null), lit(null), lit(null), col(\"future_flg\"))\n             .getField(\"data_path\")\n      ).otherwise(lit(null)),\n      lit(\"FORMULARY_NOT_FOUND\")\n    )\n  )\n}\n\ndef cag_url() = {\n  when(\n    col(\"future_flg\") === lit(2),\n    when(\n      isnull(col(\"carrier\")),\n      coalesce(\n        lookup(\n          \"CAG_Override_Ref\",\n          lit(null),\n          lit(null),\n          lit(null),\n          col(\"future_flg\")\n        ).getField(\"data_path\"),\n        lookup(\"CAG_Override_Ref\", lit(null), lit(null), lit(null), lit(0))\n          .getField(\"data_path\"),\n        lit(\"CAG_NOT_FOUND\")\n      )\n    ).otherwise(\n      coalesce(\n        lookup(\n          \"CAG_Override_Ref\",\n          col(\"carrier\"),\n          col(\"account\"),\n          col(\"group\"),\n          col(\"future_flg\")\n        )\n          .getField(\"data_path\"),\n        lookup(\n          \"CAG_Override_Ref\",\n          col(\"carrier\"),\n          col(\"account\"),\n          lit(\"*ALL\"),\n          col(\"future_flg\")\n        )\n          .getField(\"data_path\"),\n        lookup(\n          \"CAG_Override_Ref\",\n          col(\"carrier\"),\n          lit(\"*ALL\"),\n          lit(\"*ALL\"),\n          col(\"future_flg\")\n        ).getField(\"data_path\"),\n        lookup(\n          \"CAG_Override_Ref\",\n          lit(\"*ALL\"),\n          lit(\"*ALL\"),\n          lit(\"*ALL\"),\n          col(\"future_flg\")\n        ).getField(\"data_path\"),\n        when(\n          month(\n            date_format(to_date(Config.BUSINESS_DATE, \"yyyyMMdd\"), \"yyyy-MM-dd\")\n          ) === lit(12),\n          lookup(\n            \"CAG_Override_Ref\",\n            col(\"carrier\"),\n            col(\"account\"),\n            col(\"group\"),\n            lit(1)\n          ).getField(\"data_path\")\n        ),\n        when(\n          month(\n            date_format(to_date(Config.BUSINESS_DATE, \"yyyyMMdd\"), \"yyyy-MM-dd\")\n          ) === lit(12),\n          lookup(\n            \"CAG_Override_Ref\",\n            col(\"carrier\"),\n            col(\"account\"),\n            lit(\"*ALL\"),\n            lit(1)\n          ).getField(\"data_path\")\n        ),\n        when(\n          month(\n            date_format(to_date(Config.BUSINESS_DATE, \"yyyyMMdd\"), \"yyyy-MM-dd\")\n          ) === lit(12),\n          lookup(\n            \"CAG_Override_Ref\",\n            col(\"carrier\"),\n            lit(\"*ALL\"),\n            lit(\"*ALL\"),\n            lit(1)\n          ).getField(\"data_path\")\n        ),\n        when(\n          month(\n            date_format(to_date(Config.BUSINESS_DATE, \"yyyyMMdd\"), \"yyyy-MM-dd\")\n          ) === lit(12),\n          lookup(\n            \"CAG_Override_Ref\",\n            lit(\"*ALL\"),\n            lit(\"*ALL\"),\n            lit(\"*ALL\"),\n            lit(1)\n          ).getField(\"data_path\")\n        ),\n        lookup(\n          \"CAG_Override_Ref\",\n          col(\"carrier\"),\n          col(\"account\"),\n          col(\"group\"),\n          lit(0)\n        ).getField(\"data_path\"),\n        lookup(\n          \"CAG_Override_Ref\",\n          lit(null),\n          lit(null),\n          lit(null),\n          col(\"future_flg\")\n        ).getField(\"data_path\"),\n        lookup(\"CAG_Override_Ref\", lit(null), lit(null), lit(null), lit(0))\n          .getField(\"data_path\"),\n        lit(\"CAG_NOT_FOUND\")\n      )\n    )\n  ).when(\n    isnull(col(\"carrier\")),\n    lookup(\"CAG_Override_Ref\", lit(null), lit(null), lit(null), lit(0))\n      .getField(\"data_path\")\n  ).otherwise(\n    coalesce(\n      lookup(\n        \"CAG_Override_Ref\",\n        col(\"carrier\"),\n        col(\"account\"),\n        col(\"group\"),\n        when(col(\"future_flg\") === lit(0), lit(0))\n          .otherwise(lit(1))\n          .cast(IntegerType)\n      ).getField(\"data_path\"),\n      lookup(\n        \"CAG_Override_Ref\",\n        col(\"carrier\"),\n        col(\"account\"),\n        lit(\"*ALL\"),\n        when(col(\"future_flg\") === lit(0), lit(0))\n          .otherwise(lit(1))\n          .cast(IntegerType)\n      ).getField(\"data_path\"),\n      lookup(\n        \"CAG_Override_Ref\",\n        col(\"carrier\"),\n        lit(\"*ALL\"),\n        lit(\"*ALL\"),\n        when(col(\"future_flg\") === lit(0), lit(0))\n          .otherwise(lit(1))\n          .cast(IntegerType)\n      ).getField(\"data_path\"),\n      lookup(\n        \"CAG_Override_Ref\",\n        lit(\"*ALL\"),\n        lit(\"*ALL\"),\n        lit(\"*ALL\"),\n        when(col(\"future_flg\") === lit(0), lit(0))\n          .otherwise(lit(1))\n          .cast(IntegerType)\n      ).getField(\"data_path\"),\n      lookup(\n        \"CAG_Override_Ref\",\n        lit(null),\n        lit(null),\n        lit(null),\n        when(col(\"future_flg\") === lit(0), lit(0))\n          .otherwise(lit(1))\n          .cast(IntegerType)\n      ).getField(\"data_path\"),\n      lit(\"CAG_NOT_FOUND\")\n    )\n  )\n}\n\ndef filter_output_profile_record(\n    frmlry_url: org.apache.spark.sql.Column,\n    cag_url: org.apache.spark.sql.Column,\n    future_flg: org.apache.spark.sql.Column,\n    business_dt: org.apache.spark.sql.Column\n) = {\n  var error_message: org.apache.spark.sql.Column = lit(\"\")\n  var is_current: org.apache.spark.sql.Column =\n    when(col(\"future_flg\") === lit(2), lit(\"Next Month\"))\n      .when(col(\"future_flg\") === lit(1), lit(\"Next Year\"))\n      .otherwise(lit(\"Current\"))\n  error_message = array_join(\n    array(\n      lit(\"\"),\n      array_join(\n        array(\n          when(\n            !lookup_match(\"TAL_Dtl\", col(\"tal_name\")).cast(BooleanType),\n            array_join(\n              array(\n                lit(\"Invalid TAL=\"),\n                col(\"tal_name\"),\n                lit(\" used for Output Profile=\"),\n                col(\"output_profile_name\"),\n                lit(\".\")\n              ),\n              \"\"\n            )\n          ),\n          when(\n            !lookup_match(\"TAC_Dtl\", col(\"tac_name\")).cast(BooleanType),\n            array_join(\n              array(\n                lit(\"Invalid TAC=\"),\n                col(\"tac_name\"),\n                lit(\" used for Output Profile=\"),\n                col(\"output_profile_name\"),\n                lit(\".\")\n              ),\n              \"\"\n            )\n          ),\n          when(\n            !lookup_match(\"TAR_Dtl\", col(\"tar_name\"), business_dt)\n              .cast(BooleanType),\n            array_join(\n              array(\n                lit(\"Invalid TAR=\"),\n                col(\"tar_name\"),\n                lit(\" used for Output Profile=\"),\n                col(\"output_profile_name\"),\n                lit(\".\")\n              ),\n              \"\"\n            )\n          ),\n          when(\n            !lookup_match(\"TSD_Dtl\", col(\"tsd_name\")).cast(BooleanType),\n            array_join(\n              array(\n                lit(\"Invalid TSD=\"),\n                col(\"tsd_name\"),\n                lit(\" used for Output Profile=\"),\n                col(\"output_profile_name\"),\n                lit(\".\")\n              ),\n              \"\"\n            )\n          ),\n          when(\n            cag_url === lit(\"CAG_NOT_FOUND\"),\n            array_join(\n              array(\n                is_current,\n                lit(\n                  \" Dated Drug data snapshot is not available for Output Profile=\"\n                ),\n                col(\"output_profile_name\"),\n                lit(\".\")\n              ),\n              \"\"\n            )\n          ),\n          when(\n            frmlry_url === lit(\"FORMULARY_NOT_FOUND\"),\n            array_join(\n              array(\n                is_current,\n                lit(\n                  \" Dated Formulary data snapshot is not available for Output Profile=\"\n                ),\n                col(\"output_profile_name\"),\n                lit(\" and Formulary=\"),\n                col(\"formulary_name\"),\n                lit(\" and Customer=\"),\n                coalesce(col(\"customer_name\"), lit(\"NULL\"))\n              ),\n              \"\"\n            )\n          ),\n          when(\n            frmlry_url === lit(\"NOT_A_VALID_AS_OF_DT\"),\n            array_join(\n              array(\n                is_current,\n                lit(\n                  \" Dated Formulary data snapshot is not having valid run_eff_dt for Output Profile=\"\n                ),\n                col(\"output_profile_name\"),\n                lit(\" and Formulary=\"),\n                col(\"formulary_name\"),\n                lit(\" and Customer=\"),\n                coalesce(col(\"customer_name\"), lit(\"NULL\"))\n              ),\n              \"\"\n            )\n          )\n        ),\n        \"\"\n      )\n    ),\n    \"\"\n  )\n  error_message\n}\n\ndef error_message() = {\n  filter_output_profile_record(frmlry_url(), cag_url(), col(\"future_flg\"), col(\"as_of_dt\"))\n}\n\nval processUDF = udf(\n  (inputRows: Seq[Row], cag_url: String) => {\n    var non_qual_output_profile_ids = Array[Row]()\n    var qual_output_profile_ids = Array[String]()\n    var op_dtls = Array[Row]()\n    var index = 0\n    var err_msgs = Array[String]()\n\n    var carrier = \"\"\n    var account = \"\"\n    var group = \"\"\n    var future_flg = \"\"\n    var as_of_dt = \"\"\n    var cag_override_data_path = \"\"\n    var newline = \"\"\n    inputRows.zipWithIndex.foreach { case (in, jdx) =>\n      var error_msg = in.getAs[String](\"error_message\")\n      var formulary_pseudonym = in.getAs[String](\"formulary_pseudonym\")\n      var frmlry_url = in.getAs[String](\"frmlry_url\")\n      var is_current = (if (in.getAs[String](\"future_flg\").toInt == 2)\n                          \"Next Month\"\n                        else {\n                          if (in.getAs[String](\"future_flg\").toInt == 1)\n                            \"Next Year\"\n                          else\n                            \"Current\"\n                        }).toString\n\n      carrier = in.getAs[String](\"carrier\")\n      account = in.getAs[String](\"account\")\n      group = in.getAs[String](\"group\")\n      future_flg =\n        if (in.getAs[String](\"future_flg\") == \"2\") \"NM\"\n        else if (in.getAs[String](\"future_flg\") == \"1\") \"NY\"\n        else in.getAs[String](\"future_flg\")\n      as_of_dt = in.getAs[String](\"as_of_dt\")\n      cag_override_data_path = if (cag_url != \"CAG_NOT_FOUND\") cag_url else \"\"\n      newline = in.getAs[String](\"newline\")\n      if (_is_blank(error_msg.toString)) {\n        if (\n          qual_output_profile_ids\n            .contains(in.getAs[String](\"output_profile_id\"))\n        ) {\n          if (\n            !op_dtls(convertToInt(index))\n              .getAs[Seq[String]](\"formulary_names\")\n              .toArray\n              .contains(in.getAs[String](\"formulary_name\"))\n          )\n            op_dtls(index) = Row(\n              op_dtls(convertToInt(index)).getAs[String](0),\n              op_dtls(convertToInt(index)).getAs[String](1),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](2).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](3).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](4).toArray,\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](5).toArray,\n                Array.fill(1)(in.getAs[String](\"formulary_name\"))\n              ),\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](6).toArray,\n                Array.fill(1)(frmlry_url)\n              ),\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](7).toArray,\n                Array.fill(1)(formulary_pseudonym)\n              ),\n              op_dtls(convertToInt(index)).getAs[String](8),\n              op_dtls(convertToInt(index)).getAs[String](9),\n              op_dtls(convertToInt(index)).getAs[String](10),\n              op_dtls(convertToInt(index)).getAs[String](11),\n              op_dtls(convertToInt(index)).getAs[String](12)\n            )\n          if (\n            !op_dtls(convertToInt(index))\n              .getAs[Seq[String]](2)\n              .toArray\n              .contains(in.getAs[String](\"job_id\"))\n          )\n            op_dtls(index) = Row(\n              op_dtls(convertToInt(index)).getAs[String](0),\n              op_dtls(convertToInt(index)).getAs[String](1),\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](2).toArray,\n                Array.fill(1)(in.getAs[String](\"job_id\"))\n              ),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](3).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](4).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](5).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](6).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](7).toArray,\n              op_dtls(convertToInt(index)).getAs[String](8),\n              op_dtls(convertToInt(index)).getAs[String](9),\n              op_dtls(convertToInt(index)).getAs[String](10),\n              op_dtls(convertToInt(index)).getAs[String](11),\n              op_dtls(convertToInt(index)).getAs[String](12)\n            )\n          if (\n            (!_isnull(in.getAs[String](\"alias_name\"))) && (!op_dtls(\n              convertToInt(index)\n            )\n              .getAs[Seq[String]](\"alias_names\")\n              .toArray\n              .contains(in.getAs[String](\"alias_name\")))\n          )\n            op_dtls(index) = Row(\n              op_dtls(convertToInt(index)).getAs[String](0),\n              op_dtls(convertToInt(index)).getAs[String](1),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](2).toArray,\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](3).toArray,\n                Array.fill(1)(in.getAs[String](\"alias_name\"))\n              ),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](4).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](5).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](6).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](7).toArray,\n              op_dtls(convertToInt(index)).getAs[String](8),\n              op_dtls(convertToInt(index)).getAs[String](9),\n              op_dtls(convertToInt(index)).getAs[String](10),\n              op_dtls(convertToInt(index)).getAs[String](11),\n              op_dtls(convertToInt(index)).getAs[String](12)\n            )\n          if (\n            (!_isnull(in.getAs[String](\"job_name\"))) && (!op_dtls(\n              convertToInt(index)\n            )\n              .getAs[Seq[String]](\"job_names\")\n              .toArray\n              .contains(in.getAs[String](\"job_name\")))\n          )\n            op_dtls(index) = Row(\n              op_dtls(convertToInt(index)).getAs[String](0),\n              op_dtls(convertToInt(index)).getAs[String](1),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](2).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](3).toArray,\n              Array.concat(\n                op_dtls(convertToInt(index)).getAs[Seq[String]](4).toArray,\n                Array.fill(1)(in.getAs[String](\"job_name\"))\n              ),\n              op_dtls(convertToInt(index)).getAs[Seq[String]](5).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](6).toArray,\n              op_dtls(convertToInt(index)).getAs[Seq[String]](7).toArray,\n              op_dtls(convertToInt(index)).getAs[String](8),\n              op_dtls(convertToInt(index)).getAs[String](9),\n              op_dtls(convertToInt(index)).getAs[String](10),\n              op_dtls(convertToInt(index)).getAs[String](11),\n              op_dtls(convertToInt(index)).getAs[String](12)\n            )\n        } else {\n          idx = non_qual_output_profile_ids.indexWhere(xx =>\n            xx.getAs[String](0) == in.getAs[String](\"output_profile_id\")\n          )\n          if (idx == -1) {\n            qual_output_profile_ids = Array.concat(\n              qual_output_profile_ids,\n              Array.fill(1)(in.getAs[String](\"output_profile_id\"))\n            )\n            op_dtls = Array.concat(\n              op_dtls,\n              Array.fill(1)(\n                Row(\n                  in.getAs[String](\"output_profile_name\"),\n                  in.getAs[String](\"rxclaim_env_name\"),\n                  Array(in.getAs[String](\"job_id\")),\n                  if (\n                    (try Array(in.getAs[String](\"alias_name\"))\n                    catch {\n                      case error: Throwable => null\n                    }) == null\n                  )\n                    Array[Any]()\n                  else\n                    Array(in.getAs[String](\"alias_name\")),\n                  Array(in.getAs[String](\"job_name\")),\n                  Array(in.getAs[String](\"formulary_name\")),\n                  Array(frmlry_url),\n                  Array(formulary_pseudonym),\n                  in.getAs[String](\"tal_name\"),\n                  in.getAs[String](\"tac_name\"),\n                  in.getAs[String](\"tar_name\"),\n                  in.getAs[String](\"tsd_name\"),\n                  in.getAs[String](\"st_tac_ind\")\n                )\n              )\n            )\n            index = (op_dtls.length - 1)\n          } else {\n            len = non_qual_output_profile_ids.length - 1\n            if (\n              !non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](\"job_ids\")\n                .toArray\n                .contains(in.getAs[String](\"job_id\"))\n            )\n              non_qual_output_profile_ids(len) = Row(\n                (non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(len))\n                    .getAs[Seq[String]](2)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"job_id\"))\n                ),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](5)\n                .toArray\n                .contains(\n                  if (\n                    (try in.getAs[String](\"alias_name\")\n                    catch {\n                      case error: Throwable => null\n                    }) == null\n                  )\n                    \"\"\n                  else\n                    in.getAs[String](\"alias_name\")\n                )\n            )\n              non_qual_output_profile_ids(len) = Row(\n                (non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(len))\n                    .getAs[Seq[String]](5)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"alias_name\"))\n                ),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](\"formulary_names\")\n                .toArray\n                .contains(in.getAs[String](\"formulary_name\"))\n            )\n              non_qual_output_profile_ids(len) = Row(\n                (non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(len))\n                    .getAs[Seq[String]](3)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"formulary_name\"))\n                ),\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(len))\n                    .getAs[Seq[String]](4)\n                    .toArray,\n                  Array.fill(1)(formulary_pseudonym)\n                ),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](\"job_names\")\n                .toArray\n                .contains(in.getAs[String](\"job_name\"))\n            )\n              non_qual_output_profile_ids(len) = Row(\n                (non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(len))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(len))\n                    .getAs[Seq[String]](6)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"job_name\"))\n                )\n              )\n          }\n        }\n      } else if (!err_msgs.contains(error_msg)) {\n        if (\n          qual_output_profile_ids\n            .contains(in.getAs[String](\"output_profile_id\"))\n        ) {\n          idx = qual_output_profile_ids.indexWhere(xx =>\n            xx == in.getAs[String](\"output_profile_id\")\n          )\n          qual_output_profile_ids = (1 until convertToInt((idx - 1) + 1))\n            .map(xslice => element_at(qual_output_profile_ids, xslice))\n            .toArray\n            .filter(yslice => !_isnull(yslice))\n            .toArray\n          op_dtls = (1 until convertToInt((idx - 1) + 1))\n            .map(xslice => element_at(op_dtls, xslice))\n            .toArray\n            .filter(yslice => !_isnull(yslice))\n            .toArray\n          non_qual_output_profile_ids = Array.concat(\n            non_qual_output_profile_ids,\n            Array.fill(1)(\n              Row(\n                in.getAs[String](\"output_profile_id\"),\n                in.getAs[String](\"rxclaim_env_name\"),\n                Array(in.getAs[String](\"job_id\")),\n                Array(in.getAs[String](\"formulary_name\")),\n                Array(formulary_pseudonym),\n                Array(in.getAs[String](\"alias_name\")),\n                Array(in.getAs[String](\"job_name\"))\n              )\n            )\n          )\n          err_msgs = Array.concat(err_msgs, Array.fill(1)(error_msg))\n        } else {\n          idx = non_qual_output_profile_ids.indexWhere(xx =>\n            (xx.getAs[String](0)) == in.getAs[String](\"output_profile_id\")\n          )\n          if (idx != -1) {\n            len = err_msgs.length - 1\n            err_msgs(len) =\n              Array(err_msgs(convertToInt(len)), \".\", error_msg).mkString(\"\")\n            if (\n              !non_qual_output_profile_ids(convertToInt(idx))\n                .getAs[Seq[String]](2)\n                .toArray\n                .contains(in.getAs[String](\"job_id\"))\n            )\n              non_qual_output_profile_ids(idx) = Row(\n                (non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(idx)).getAs[String](1),\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(idx))\n                    .getAs[Seq[String]](2)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"job_id\"))\n                ),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(idx))\n                .getAs[Seq[String]](5)\n                .toArray\n                .contains(\n                  if (\n                    (try in.getAs[String](\"alias_name\")\n                    catch {\n                      case error: Throwable => null\n                    }) == null\n                  )\n                    \"\"\n                  else\n                    in.getAs[String](\"alias_name\")\n                )\n            )\n              non_qual_output_profile_ids(idx) = Row(\n                (non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(idx)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(idx))\n                    .getAs[Seq[String]](5)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"alias_name\"))\n                ),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(idx))\n                .getAs[Seq[String]](\"formulary_names\")\n                .toArray\n                .contains(in.getAs[String](\"formulary_name\"))\n            )\n              non_qual_output_profile_ids(idx) = Row(\n                (non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(idx)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(idx))\n                    .getAs[Seq[String]](3)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"formulary_name\"))\n                ),\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(idx))\n                    .getAs[Seq[String]](4)\n                    .toArray,\n                  Array.fill(1)(formulary_pseudonym)\n                ),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](6)\n                  .toArray\n              )\n            if (\n              !non_qual_output_profile_ids(convertToInt(idx))\n                .getAs[Seq[String]](\"job_names\")\n                .toArray\n                .contains(in.getAs[String](\"job_name\"))\n            )\n              non_qual_output_profile_ids(idx) = Row(\n                (non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[String](0)),\n                non_qual_output_profile_ids(convertToInt(idx)).getAs[String](1),\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](2)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](3)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](4)\n                  .toArray,\n                non_qual_output_profile_ids(convertToInt(idx))\n                  .getAs[Seq[String]](5)\n                  .toArray,\n                Array.concat(\n                  non_qual_output_profile_ids(convertToInt(idx))\n                    .getAs[Seq[String]](3)\n                    .toArray,\n                  Array.fill(1)(in.getAs[String](\"job_name\"))\n                )\n              )\n          } else {\n            non_qual_output_profile_ids = Array.concat(\n              non_qual_output_profile_ids,\n              Array.fill(1)(\n                Row(\n                  in.getAs[String](\"output_profile_id\"),\n                  in.getAs[String](\"rxclaim_env_name\"),\n                  Array(in.getAs[String](\"job_id\")),\n                  Array(in.getAs[String](\"formulary_name\")),\n                  Array(formulary_pseudonym),\n                  Array(\n                    if (\n                      (try in.getAs[String](\"alias_name\")\n                      catch {\n                        case error: Throwable => null\n                      }) == null\n                    )\n                      \"\"\n                    else\n                      in.getAs[String](\"alias_name\")\n                  ),\n                  Array(in.getAs[String](\"job_name\"))\n                )\n              )\n            )\n            err_msgs = Array.concat(err_msgs, Array.fill(1)(error_msg))\n          }\n        }\n      } else {\n        len = non_qual_output_profile_ids.length - 1\n        if (\n          !non_qual_output_profile_ids(convertToInt(len))\n            .getAs[Seq[String]](\"job_ids\")\n            .toArray\n            .contains(in.getAs[String](\"job_id\"))\n        )\n          non_qual_output_profile_ids(len) = Row(\n            (non_qual_output_profile_ids(convertToInt(len)).getAs[String](0)),\n            non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n            Array.concat(\n              non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](2)\n                .toArray,\n              Array.fill(1)(in.getAs[String](\"job_id\"))\n            ),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](3)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](4)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](5)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](6)\n              .toArray\n          )\n        if (\n          !non_qual_output_profile_ids(convertToInt(len))\n            .getAs[String](\"alias_names\")\n            .contains(\n              if (\n                (try in.getAs[String](\"alias_name\")\n                catch {\n                  case error: Throwable => null\n                }) == null\n              )\n                \"\"\n              else\n                in.getAs[String](\"alias_name\")\n            )\n        )\n          non_qual_output_profile_ids(len) = Row(\n            (non_qual_output_profile_ids(convertToInt(len)).getAs[String](0)),\n            non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](2)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](3)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](4)\n              .toArray,\n            Array.concat(\n              non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](5)\n                .toArray,\n              Array.fill(1)(in.getAs[String](\"alias_name\"))\n            ),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](6)\n              .toArray\n          )\n        if (\n          !non_qual_output_profile_ids(convertToInt(len))\n            .getAs[Seq[String]](3)\n            .toArray\n            .contains(in.getAs[String](\"formulary_name\"))\n        )\n          non_qual_output_profile_ids(len) = Row(\n            (non_qual_output_profile_ids(convertToInt(len)).getAs[String](0)),\n            non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](2)\n              .toArray,\n            Array.concat(\n              non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](3)\n                .toArray,\n              Array.fill(1)(in.getAs[String](\"formulary_name\"))\n            ),\n            Array.concat(\n              non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](4)\n                .toArray,\n              Array.fill(1)(formulary_pseudonym)\n            ),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](5)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](6)\n              .toArray\n          )\n        if (\n          !non_qual_output_profile_ids(convertToInt(len))\n            .getAs[Seq[String]](\"job_names\")\n            .toArray\n            .contains(in.getAs[String](\"job_name\"))\n        )\n          non_qual_output_profile_ids(len) = Row(\n            (non_qual_output_profile_ids(convertToInt(len)).getAs[String](0)),\n            non_qual_output_profile_ids(convertToInt(len)).getAs[String](1),\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](2)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](3)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](4)\n              .toArray,\n            non_qual_output_profile_ids(convertToInt(len))\n              .getAs[Seq[String]](5)\n              .toArray,\n            Array.concat(\n              non_qual_output_profile_ids(convertToInt(len))\n                .getAs[Seq[String]](6)\n                .toArray,\n              Array.fill(1)(in.getAs[String](\"job_name\"))\n            )\n          )\n      }\n    }\n\n    Row(\n      carrier,\n      account,\n      group,\n      future_flg,\n      as_of_dt,\n      cag_override_data_path,\n      convertToStringList(qual_output_profile_ids),\n      op_dtls.map { x =>\n        Row(\n          (x.get(0)).toString,\n          (x.get(1)).toString,\n          convertToStringList(x.get(2)),\n          x.get(3),\n          x.get(4),\n          x.get(5),\n          x.get(6),\n          x.get(7),\n          (x.get(8)).toString,\n          (x.get(9)).toString,\n          (x.get(10)).toString,\n          (x.get(11)).toString,\n          (x.get(12)).toString\n        )\n      }.toArray,\n      non_qual_output_profile_ids.map { x =>\n        Row(\n          (x.get(0)).toString,\n          (x.get(1)).toString,\n          convertToStringList(x.get(2)),\n          x.get(3),\n          x.get(4),\n          x.get(5),\n          x.get(6)\n        )\n      }.toArray,\n      err_msgs,\n      newline\n    )\n  },\n  StructType(\n    List(\n      StructField(\"carrier\", StringType, false),\n      StructField(\"account\", StringType, false),\n      StructField(\"group\", StringType, false),\n      StructField(\"future_flg\", StringType, false),\n      StructField(\"as_of_dt\", StringType, false),\n      StructField(\"cag_override_data_path\", StringType, false),\n      StructField(\"qual_output_profile_ids\", ArrayType(StringType), false),\n      StructField(\n        \"op_dtls\",\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"qual_output_profile_name\", StringType, false), // 0\n              StructField(\"rxclaim_env_name\", StringType, false), // 1\n              StructField(\"job_ids\", ArrayType(StringType), false), // 1\n              StructField(\"alias_names\", ArrayType(StringType), false), // 2\n              StructField(\"job_names\", ArrayType(StringType), false), // 3\n              StructField(\"formulary_names\", ArrayType(StringType), false), // 4\n              StructField(\n                \"form_override_data_paths\",\n                ArrayType(StringType),\n                false\n              ), // 5\n              StructField(\n                \"formulary_pseudonyms\",\n                ArrayType(StringType),\n                false\n              ), // 6\n              StructField(\"tal_name\", StringType, false), // 7\n              StructField(\"tac_name\", StringType, false), // 8\n              StructField(\"tar_name\", StringType, false), // 9\n              StructField(\"tsd_name\", StringType, false), // 10\n              StructField(\"st_tac_ind\", StringType, false) // 11\n            )\n          )\n        ),\n        false\n      ),\n      StructField(\n        \"non_qual_output_profile_ids\",\n        ArrayType(\n          StructType(\n            List(\n              StructField(\"non_qual_op_id\", StringType, false), // 0\n              StructField(\"rxclaim_env_name\", StringType, false), // 1\n              StructField(\"job_ids\", ArrayType(StringType), false), // 2\n              StructField(\"formulary_names\", ArrayType(StringType), false), // 3\n              StructField(\n                \"formulary_pseudonyms\",\n                ArrayType(StringType),\n                false\n              ), // 4\n              StructField(\"alias_names\", ArrayType(StringType), false), // 5\n              StructField(\"job_names\", ArrayType(StringType), false) // 6\n            )\n          )\n        ),\n        false\n      ),\n      StructField(\"err_msgs\", ArrayType(StringType), false),\n      StructField(\"newline\", StringType, false)\n    )\n  )\n)\n\nval origColumns = in0.columns.map(col)\nval groupedDF = in0\n  .groupBy(\"carrier\", \"account\", \"group\", \"future_flg\", \"as_of_dt\")\n  .agg(\n    collect_list(\n      struct(\n        (origColumns :+ frmlry_url().alias(\"frmlry_url\") :+ error_message()\n          .alias(\"error_message\")): _*\n      )\n    ).alias(\"inputRows\"),\n    first(cag_url()).alias(\"cag_url\")\n  )\n  .select((process_udf(col(\"inputRows\"), col(\"cag_url\"))).alias(\"output\"))\n  .select(col(\"output.*\"))\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out0\n}"
      }
    },
    "CAG_Override_Ref_lookup" : {
      "id" : "CAG_Override_Ref_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "CAG_Override_Ref_lookup",
        "slug" : "CAG_Override_Ref_lookup",
        "x" : 220,
        "y" : 20,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "CAG_Override_Ref_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "is_future_snap",
              "type" : "decimal(1,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "data_path",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "carrier", "account", "group", "is_future_snap" ],
        "valueColumns" : [ "carrier", "account", "group", "is_future_snap", "data_path", "newline" ],
        "processName" : "CAG_Override_Ref"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}