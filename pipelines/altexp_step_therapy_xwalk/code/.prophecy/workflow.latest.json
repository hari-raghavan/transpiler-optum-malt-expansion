{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "7.1.83"
      }
    },
    "id" : "altexp_step_therapy_xwalk",
    "uri" : "pipelines/altexp_step_therapy_xwalk",
    "language" : "scala",
    "fabricId" : "1593",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "hariprophecyioteam.transpilermaltexpansion.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions" ],
      "initialCode" : "def get_rule_def(xml: org.apache.spark.sql.Column) = {\n    concat(\n      transform(\n        xml.getField(\"Rule\").getField(\"Rule\"),\n        (rule, i) =>\n          flatten(\n            transform(\n              rule.getField(\"Qual\"),\n              (qual, j) =>\n                struct(\n                  qual.getField(\"type0\").as(\"qualifier_cd\"),\n                  qual.getField(\"op\").as(\"operator\"),\n                  qual.getField(\"Qual\").as(\"compare_value\"),\n                  when(lit(j) < size(rule.getField(\"OR\")), lit(\"0\"))\n                    .otherwise(lit(\"\"))\n                    .as(\"conjunction_cd\"),\n                  (monotonically_increasing_id() + lit(50)).as(\n                    \"rule_expression_id\"\n                  )\n                )\n            )\n          )\n      ),\n      transform(\n        xml.getField(\"Rule\").getField(\"Qual\"),\n        (qual, i) =>\n          struct(\n            qual.getField(\"type0\").as(\"qualifier_cd\"),\n            qual.getField(\"op\").as(\"compare_value\"),\n            qual.getField(\"Qual\").as(\"compare_value\"),\n            lit(\"\").as(\"conjunction_cd\"),\n            (monotonically_increasing_id() + lit(50)).as(\"rule_expression_id\")\n          )\n      )\n    )\n  }",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "TAC_RULE_XWALK",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "CAG_TAL_CONTAINER_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "PRODUCT_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "FORM_OVRRD_DATA_PATH",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAC_NM",
          "kind" : {
            "type" : "string",
            "value" : "TAC_NM"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "STEP_THERAPY_DTL_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAC_CONTAINER_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAC_CONDITION",
          "kind" : {
            "type" : "int",
            "value" : 1
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "e0",
    "source" : "Gather",
    "sourcePort" : "Gather__out",
    "target" : "TAC_Container_Step_Therapy",
    "targetPort" : "TAC_Container_Step_Therapy__in"
  }, {
    "id" : "e3",
    "source" : "Rollup_Group_Numbers_Reformat",
    "sourcePort" : "Rollup_Group_Numbers_Reformat__out",
    "target" : "Step_Therapy_DTL_File_lookup",
    "targetPort" : "Step_Therapy_DTL_File_lookup__in"
  }, {
    "id" : "e2",
    "source" : "Rollup_Group_Numbers",
    "sourcePort" : "Rollup_Group_Numbers__out",
    "target" : "Rollup_Group_Numbers_Reformat",
    "targetPort" : "Rollup_Group_Numbers_Reformat__in"
  }, {
    "id" : "e4",
    "source" : "Rollup_Group_Numbers_Reformat",
    "sourcePort" : "Rollup_Group_Numbers_Reformat__out",
    "target" : "Step_Therapy_DTL_File",
    "targetPort" : "Step_Therapy_DTL_File__in"
  }, {
    "id" : "e5",
    "source" : "Rollup_Group_Numbers_input_select_filter",
    "sourcePort" : "Rollup_Group_Numbers_input_select_filter__out",
    "target" : "Rollup_Group_Numbers",
    "targetPort" : "Rollup_Group_Numbers__in"
  }, {
    "id" : "e7",
    "source" : "Reformat_To_separate_NFST_and_STReformat_1",
    "sourcePort" : "Reformat_To_separate_NFST_and_STReformat_1__out",
    "target" : "Map_T_A_pairs_as_per_ST_Group_NM_ST",
    "targetPort" : "Map_T_A_pairs_as_per_ST_Group_NM_ST__in"
  }, {
    "id" : "e8",
    "source" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
    "sourcePort" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out1",
    "target" : "Reformat_To_separate_NFST_and_STReformat_1",
    "targetPort" : "Reformat_To_separate_NFST_and_STReformat_1__in"
  }, {
    "id" : "e10",
    "source" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
    "sourcePort" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out0",
    "target" : "Reformat_To_separate_NFST_and_STReformat_0",
    "targetPort" : "Reformat_To_separate_NFST_and_STReformat_0__in"
  }, {
    "id" : "e1",
    "source" : "OFIL_TAC_Rule_Xwalk",
    "sourcePort" : "OFIL_TAC_Rule_Xwalk__out",
    "target" : "Reformat_To_separate_NFST_and_ST_Filter_select",
    "targetPort" : "Reformat_To_separate_NFST_and_ST_Filter_select__in"
  }, {
    "id" : "e11",
    "source" : "Reformat_To_separate_NFST_and_ST_Filter_select",
    "sourcePort" : "Reformat_To_separate_NFST_and_ST_Filter_select__out",
    "target" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
    "targetPort" : "Reformat_To_separate_NFST_and_ST_RowDistributor__in"
  }, {
    "id" : "e9",
    "source" : "Reformat_To_separate_NFST_and_STReformat_0",
    "sourcePort" : "Reformat_To_separate_NFST_and_STReformat_0__out",
    "target" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST",
    "targetPort" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST__in"
  }, {
    "id" : "e14",
    "source" : "Products",
    "sourcePort" : "Products__out",
    "target" : "Products_lookup",
    "targetPort" : "Products_lookup__in"
  }, {
    "id" : "e15",
    "source" : "Sort_ST_Group_ST_Numbers",
    "sourcePort" : "Sort_ST_Group_ST_Numbers__out",
    "target" : "Rollup_Group_Numbers_input_select_filter",
    "targetPort" : "Rollup_Group_Numbers_input_select_filter__in"
  }, {
    "id" : "e16",
    "source" : "IFIL_Formulary_Dataset",
    "sourcePort" : "IFIL_Formulary_Dataset__out",
    "target" : "Sort_ST_Group_ST_Numbers",
    "targetPort" : "Sort_ST_Group_ST_Numbers__in"
  }, {
    "id" : "e13",
    "source" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST",
    "sourcePort" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST__out",
    "target" : "Concat",
    "targetPort" : "Concat__in3"
  }, {
    "id" : "e12",
    "source" : "TAL_Container",
    "sourcePort" : "TAL_Container__out",
    "target" : "Concat",
    "targetPort" : "Concat__in4"
  }, {
    "id" : "e6",
    "source" : "Map_T_A_pairs_as_per_ST_Group_NM_ST",
    "sourcePort" : "Map_T_A_pairs_as_per_ST_Group_NM_ST__out",
    "target" : "Gather",
    "targetPort" : "Gather__in3"
  }, {
    "id" : "YX1xnRie1xsFwP8di1-qI",
    "source" : "Concat",
    "sourcePort" : "Concat__out",
    "target" : "mi8dCTZVSKQRLXo2pySbQ$$WInQj4qCmAoD0M2t8_ks3",
    "targetPort" : "toY74TiEuRBlCIZG1cB9v$$i5oPO2QF5L4cj0eLTeLuo"
  }, {
    "id" : "sAoHrLGpFpzPxwUNCT0Tc$$RBeAjNg4VTP_Yd6pVBPZL",
    "source" : "mi8dCTZVSKQRLXo2pySbQ$$WInQj4qCmAoD0M2t8_ks3",
    "sourcePort" : "FIGWDJcgE_8E6n0r6CJVZ$$6zKAjzalFGbUe5J7LnHW2",
    "target" : "Gather",
    "targetPort" : "Gather__in4"
  } ],
  "processes" : {
    "Reformat_To_separate_NFST_and_STReformat_1" : {
      "id" : "Reformat_To_separate_NFST_and_STReformat_1",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Reformat_To_separate_NFST_and_STReformat_1",
        "slug" : "Reformat_To_separate_NFST_and_STReformat_1",
        "x" : 620,
        "y" : 740,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_STReformat_1__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_STReformat_1__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "tac_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"tac_id\").cast(DecimalType(10, 0))"
          },
          "description" : ""
        }, {
          "target" : "tac_name",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"tac_name\")"
          },
          "description" : ""
        }, {
          "target" : "priority",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"priority\").cast(StringType)"
          },
          "description" : ""
        }, {
          "target" : "eff_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"eff_dt\")"
          },
          "description" : ""
        }, {
          "target" : "term_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"term_dt\")"
          },
          "description" : ""
        }, {
          "target" : "target_rule_def",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"target_rule_def\")"
          },
          "description" : ""
        }, {
          "target" : "alt_rule_def",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"alt_rule_def\")"
          },
          "description" : ""
        }, {
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Step_Therapy_DTL_File" : {
      "id" : "Step_Therapy_DTL_File",
      "component" : "Target",
      "metadata" : {
        "label" : "Step_Therapy_DTL_File",
        "slug" : "Step_Therapy_DTL_File",
        "x" : 1020,
        "y" : 20,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Step_Therapy_DTL_File__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Step_Therapy_DTL_File"
      }
    },
    "Concat" : {
      "id" : "Concat",
      "component" : "SetOperation",
      "metadata" : {
        "label" : "Concat",
        "slug" : "Concat",
        "x" : 1020,
        "y" : 500,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Concat__in3",
          "slug" : "in3",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Concat__in4",
          "slug" : "in4",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Concat__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "operationType" : "unionAll",
        "allowMissingColumns" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Products_lookup" : {
      "id" : "Products_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Products_lookup",
        "slug" : "Products_lookup",
        "x" : 220,
        "y" : 400,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Products_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "dl_bit",
              "type" : "integer",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inactive_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "msc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rx_otc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "desi",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_strength",
              "type" : "decimal(14,5)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "repack_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11" ],
        "valueColumns" : [ "dl_bit", "ndc11", "gpi14", "status_cd", "inactive_dt", "msc", "drug_name", "rx_otc", "desi", "roa_cd", "dosage_form_cd", "prod_strength", "repack_cd", "prod_short_desc", "gpi14_desc", "gpi8_desc", "newline" ],
        "processName" : "Products"
      }
    },
    "mi8dCTZVSKQRLXo2pySbQ$$WInQj4qCmAoD0M2t8_ks3" : {
      "id" : "mi8dCTZVSKQRLXo2pySbQ$$WInQj4qCmAoD0M2t8_ks3",
      "component" : "Script",
      "metadata" : {
        "label" : "Drop_Targets_From_Tal_Assoc",
        "slug" : "Drop_Targets_From_Tal_Assoc",
        "x" : 1220,
        "y" : 500,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "toY74TiEuRBlCIZG1cB9v$$i5oPO2QF5L4cj0eLTeLuo",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "FIGWDJcgE_8E6n0r6CJVZ$$6zKAjzalFGbUe5J7LnHW2",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\nimport scala.collection.mutable.ArrayBuffer\n\nval process_udf = udf(\n  { (input: Seq[Row]) ⇒\n    var st_tar_prdcts = Array[Byte]()\n    var results = ArrayBuffer[Row]()\n\n    input.foreach { row ⇒\n      var target_prdcts = ArrayBuffer[Array[Byte]]()\n      var result = row\n      if (row.getAs[String](1) == \"N/A - follows ST TAC\")\n        st_tar_prdcts = _bv_or(st_tar_prdcts, _bv_vector_or(\n          row.getSeq[Array[Byte]](7).toArray\n        ))\n      else {\n        row.getSeq[Array[Byte]](7).toArray.foreach { in_tar_prd ⇒\n          target_prdcts.append(_bv_difference(in_tar_prd, st_tar_prdcts))\n        }\n      }\n      result = updateIndexInRow(result,\n        7,\n        if (row.getAs[String](1) == \"N/A - follows ST TAC\")\n          row.getSeq[Array[Byte]](7).toArray\n        else target_prdcts\n      )\n      results.append(result)\n    }\n    results.toArray\n  },\n  ArrayType(\n    StructType(List(\n      StructField(\"tal_id\", DecimalType(10, 0), true),\n      StructField(\"tal_name\", StringType, true),\n      StructField(\"tal_assoc_name\", StringType, true),\n      StructField(\"tar_udl_nm\", StringType, true),\n      StructField(\"tal_desc\", StringType, true),\n      StructField(\"priority\", StringType, true),\n      StructField(\"tal_assoc_type_cd\", StringType, true),\n      StructField(\"target_prdcts\", ArrayType(BinaryType), true),\n      StructField(\n        \"alt_constituent_prdcts\",\n        ArrayType(\n          StructType(List(\n            StructField(\"alt_prdcts\", BinaryType, true),\n            StructField(\"constituent_group\", StringType, true),\n            StructField(\"constituent_reqd\", StringType, true),\n            StructField(\"udl_nm\", StringType, true)\n          )),\n          true\n        ),\n        true\n      ),\n      StructField(\"shared_qual\", StringType, true),\n      StructField(\"override_tac_name\", StringType, true),\n      StructField(\"override_tar_name\", StringType, true),\n      StructField(\"constituent_grp_vec\", ArrayType(StringType, true), true),\n      StructField(\"newline\", StringType, true)\n    ))\n  )\n)\n\nval out0 = in0\n  .select(struct(in0.columns.map(col): _*).as(\"tmp\"))\n  .groupBy(lit(1))\n  .agg(collect_list(col(\"tmp\")).as(\"input\"))\n  .select(explode(process_udf(col(\"input\")).as(\"output\")))\n  .select(col(\"output.*\"))\nout0",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out0\n}"
      }
    },
    "TAC_Container_Step_Therapy" : {
      "id" : "TAC_Container_Step_Therapy",
      "component" : "Target",
      "metadata" : {
        "label" : "TAC_Container_Step_Therapy",
        "slug" : "TAC_Container_Step_Therapy",
        "x" : 1620,
        "y" : 600,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TAC_Container_Step_Therapy__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAC_Container_Step_Therapy"
      }
    },
    "Rollup_Group_Numbers_Reformat" : {
      "id" : "Rollup_Group_Numbers_Reformat",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Rollup_Group_Numbers_Reformat",
        "slug" : "Rollup_Group_Numbers_Reformat",
        "x" : 820,
        "y" : 120,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Rollup_Group_Numbers_Reformat__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Rollup_Group_Numbers_Reformat__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "Rollup_Group_Numbers_Reformat__in##step_therapy_group_name", "Rollup_Group_Numbers_Reformat__in##step_therapy_step_number", "Rollup_Group_Numbers_Reformat__in##products" ],
        "expressions" : [ {
          "target" : "step_therapy_group_name",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_group_name\")"
          },
          "description" : ""
        }, {
          "target" : "step_therapy_step_number",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_step_number\").cast(StringType)"
          },
          "description" : ""
        }, {
          "target" : "products",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"products\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Reformat_To_separate_NFST_and_STReformat_0" : {
      "id" : "Reformat_To_separate_NFST_and_STReformat_0",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Reformat_To_separate_NFST_and_STReformat_0",
        "slug" : "Reformat_To_separate_NFST_and_STReformat_0",
        "x" : 620,
        "y" : 400,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_STReformat_0__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_STReformat_0__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "tac_id",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"tac_id\").cast(DecimalType(10, 0))"
          },
          "description" : ""
        }, {
          "target" : "tac_name",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"tac_name\")"
          },
          "description" : ""
        }, {
          "target" : "priority",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"priority\").cast(StringType)"
          },
          "description" : ""
        }, {
          "target" : "eff_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"eff_dt\")"
          },
          "description" : ""
        }, {
          "target" : "term_dt",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"term_dt\")"
          },
          "description" : ""
        }, {
          "target" : "target_rule_def",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"target_rule_def\")"
          },
          "description" : ""
        }, {
          "target" : "alt_rule_def",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"alt_rule_def\")"
          },
          "description" : ""
        }, {
          "target" : "newline",
          "expression" : {
            "format" : "scala",
            "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Step_Therapy_DTL_File_lookup" : {
      "id" : "Step_Therapy_DTL_File_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Step_Therapy_DTL_File_lookup",
        "slug" : "Step_Therapy_DTL_File_lookup",
        "x" : 1020,
        "y" : 220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Step_Therapy_DTL_File_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "step_therapy_step_number" ],
        "valueColumns" : [ "step_therapy_group_name", "step_therapy_step_number", "products" ],
        "processName" : "Step_Therapy_DTL_File"
      }
    },
    "TAL_Container" : {
      "id" : "TAL_Container",
      "component" : "Source",
      "metadata" : {
        "label" : "TAL_Container",
        "slug" : "TAL_Container",
        "x" : 820,
        "y" : 600,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "if(_root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(context.config.TAC_CONDITION > 1)) _root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(1) else _root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(0)"
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAL_Container__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAL_Container"
      }
    },
    "Sort_ST_Group_ST_Numbers" : {
      "id" : "Sort_ST_Group_ST_Numbers",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_ST_Group_ST_Numbers",
        "slug" : "Sort_ST_Group_ST_Numbers",
        "x" : 220,
        "y" : 120,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Sort_ST_Group_ST_Numbers__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Sort_ST_Group_ST_Numbers__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "Sort_ST_Group_ST_Numbers__in##step_therapy_group_name", "Sort_ST_Group_ST_Numbers__in##step_therapy_step_number" ],
        "orders" : [ {
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_group_name\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_step_number\")"
          },
          "sortType" : "asc"
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Map_T_A_pairs_as_per_ST_Group_NM_ST" : {
      "id" : "Map_T_A_pairs_as_per_ST_Group_NM_ST",
      "component" : "Script",
      "metadata" : {
        "label" : "Map_T_A_pairs_as_per_ST_Group_NM_ST",
        "slug" : "Map_T_A_pairs_as_per_ST_Group_NM_ST",
        "x" : 1020,
        "y" : 740,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Map_T_A_pairs_as_per_ST_Group_NM_ST__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Map_T_A_pairs_as_per_ST_Group_NM_ST__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\nimport scala.collection.mutable.ArrayBuffer\n\nval inputFilter_in_DF = in.filter(\n  (element_at(col(\"target_rule_def\"), lit(1)).getField(\"qualifier_cd\") === lit(\"ST_STEP_NUM\"))\n    .and(col(\"tac_name\") === lit(Config.TAC_NM))\n)\n\nval process_udf = udf({ (row: Row) => {\n  val target_prdcts = row.getAs[Seq[Row]](\"target_prdcts\")\n  val st_therapy_dtl_data_lkp = row.getAs[Seq[Row]](\"st_therapy_dtl_data_lkp\")\n  val alternate_prdcts = ArrayBuffer[Row]()\n  val final_target_prdcts = ArrayBuffer[Array[Byte]]()\n  val final_alternate_prdcts = ArrayBuffer[Row]()\n\n  val results = ArrayBuffer[Row]()\n  if (target_prdcts.length > 0) {\n    st_therapy_dtl_data_lkp.foreach { lkp_data ⇒\n      val compare_value = lkp_data.getAs[String](0)\n\n      lkp_data.getAs[Seq[Row]](1).toArray.foreach { st_therapy_dtl_data ⇒\n        if (target_prdcts.indexWhere(t ⇒ t.getAs[String](1) == st_therapy_dtl_data.getAs[String](0)) != -1) {\n          val vec_index = alternate_prdcts.indexWhere(t ⇒ t.getAs[String](1) == st_therapy_dtl_data.getAs[String](0))\n          if (vec_index == -1) {\n            alternate_prdcts.append(\n              Row(\n                compare_value,\n                st_therapy_dtl_data.getAs[String](0),\n                st_therapy_dtl_data.getAs[Array[Byte]](2)\n              )\n            )\n          } else {\n            alternate_prdcts(vec_index) = Row(\n              compare_value,\n              st_therapy_dtl_data.getAs[String](0),\n              _bv_or(alternate_prdcts(vec_index).getAs[Array[Byte]](2), st_therapy_dtl_data.getAs[Array[Byte]](2))\n            )\n          }\n        }\n      }\n    }\n  }\n\n  target_prdcts.toArray.foreach { tar_prd ⇒\n    final_target_prdcts.append(tar_prd.getAs[Array[Byte]](2))\n    val vec_index = alternate_prdcts.indexWhere(t ⇒ t.getAs[String](1) == tar_prd.getAs[String](1))\n\n    if (vec_index == -1) {\n      final_alternate_prdcts.append(\n        Row(\n          _bv_all_zeros(),\n          \"\",\n          \"\",\n          \"N/A\"\n        )\n      )\n    } else {\n      final_alternate_prdcts.append(\n        Row(\n          alternate_prdcts(vec_index).getAs[Array[Byte]](2),\n          \"\",\n          \"\",\n          \"N/A\"\n        )\n      )\n    }\n  }\n\n  final_target_prdcts.zipWithIndex.foreach {\n    case (r, idx) ⇒\n      results.append(\n        Row(\n          new java.math.BigDecimal(0),\n          \"N/A - follows ST TAC\",\n          \"N/A - follows ST TAC\",\n          null,\n          \"N/A - follows ST TAC\",\n          \"0\",\n          Array(final_target_prdcts(idx)),\n          Array(final_alternate_prdcts(idx)),\n          \"N/A\",\n          null,\n          null,\n          Array[String](),\n          row.getAs[String](13)\n        ))\n  }\n  results.toArray\n}\n}, ArrayType(StructType(List(\n  StructField(\"tal_id\", DecimalType(10, 0), true),\n  StructField(\"tal_name\", StringType, true),\n  StructField(\"tal_assoc_name\", StringType, true),\n  StructField(\"tar_udl_nm\", StringType, true),\n  StructField(\"tal_desc\", StringType, true),\n  StructField(\"priority\", StringType, true),\n  StructField(\"tal_assoc_type_cd\", StringType, true),\n  StructField(\"target_prdcts\", ArrayType(BinaryType), true),\n  StructField(\n    \"alt_constituent_prdcts\",\n    ArrayType(\n      StructType(List(\n        StructField(\"alt_prdcts\", BinaryType, true),\n        StructField(\"constituent_group\", StringType, true),\n        StructField(\"constituent_reqd\", StringType, true),\n        StructField(\"udl_nm\", StringType, true)\n      )),\n      true\n    ),\n    true\n  ),\n  StructField(\"shared_qual\", StringType, true),\n  StructField(\"override_tac_name\", StringType, true),\n  StructField(\"override_tar_name\", StringType, true),\n  StructField(\"constituent_grp_vec\", ArrayType(StringType, true), true),\n  StructField(\"newline\", StringType, true)\n))))\n\nval df = inputFilter_in_DF\n  .withColumn(\n    \"target_prdcts\",\n    transform(\n      lookup_row(\"Step_Therapy_DTL_File\", element_at(col(\"target_rule_def\"), 0).getField(\"compare_value\")),\n      st_therapy_dtl_data ⇒\n        struct(\n          (element_at(col(\"target_rule_def\"), 0).getField(\"compare_value\")).as(\"number\"),\n          (st_therapy_dtl_data.getField(\"step_therapy_group_name\")).as(\"group\"),\n          (st_therapy_dtl_data.getField(\"products\")).as(\"products\")\n        )\n    )\n  )\n  .withColumn(\n    \"st_therapy_dtl_data_lkp\",\n    transform(\n      col(\"alt_rule_def\"),\n      alt_rules ⇒\n        struct(\n          alt_rules.getField(\"compare_value\").as(\"compare_value\"),\n          lookup_row(\"Step_Therapy_DTL_File\", alt_rules.getField(\"compare_value\")).as(\"st_therapy_dtl_data\")\n        )\n    )\n  )\n\nval origColumns = in.columns.map(col)\nval out = in\n  .select(struct(origColumns: _*).as(\"inputRows\"))\n  .select(explode(process_udf(col(\"inputRows\"))).alias(\"output\"))\n  .select(col(\"output.*\"))\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out\n}"
      }
    },
    "IFIL_Formulary_Dataset" : {
      "id" : "IFIL_Formulary_Dataset",
      "component" : "Source",
      "metadata" : {
        "label" : "IFIL_Formulary_Dataset",
        "slug" : "IFIL_Formulary_Dataset",
        "x" : 20,
        "y" : 120,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "IFIL_Formulary_Dataset__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/IFIL_Formulary_Dataset"
      }
    },
    "Rollup_Group_Numbers_input_select_filter" : {
      "id" : "Rollup_Group_Numbers_input_select_filter",
      "component" : "Filter",
      "metadata" : {
        "label" : "Rollup_Group_Numbers_input_select_filter",
        "slug" : "Rollup_Group_Numbers_input_select_filter",
        "x" : 420,
        "y" : 120,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Rollup_Group_Numbers_input_select_filter__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Rollup_Group_Numbers_input_select_filter__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "Rollup_Group_Numbers_input_select_filter__in##step_therapy_step_number" ],
        "condition" : {
          "format" : "scala",
          "expression" : "!isnull(col(\"step_therapy_step_number\"))"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Rollup_Group_Numbers" : {
      "id" : "Rollup_Group_Numbers",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "Rollup_Group_Numbers",
        "slug" : "Rollup_Group_Numbers",
        "x" : 620,
        "y" : 120,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Rollup_Group_Numbers__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Rollup_Group_Numbers__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : true
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "products",
          "expression" : {
            "format" : "scala",
            "expression" : "bv_from_index_vector(\n    collect_list(lookup(\"product\", col(\"ndc11\")).getField(\"dl_bit\"))\n)"
          },
          "description" : ""
        } ],
        "allowSelection" : true,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "Rollup_Group_Numbers__in##step_therapy_group_name", "Rollup_Group_Numbers__in##step_therapy_step_number", "Rollup_Group_Numbers__in##ndc11" ],
        "groupBy" : [ {
          "target" : "step_therapy_group_name",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_group_name\")"
          },
          "description" : ""
        }, {
          "target" : "step_therapy_step_number",
          "expression" : {
            "format" : "scala",
            "expression" : "col(\"step_therapy_step_number\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Reformat_To_separate_NFST_and_ST_RowDistributor" : {
      "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
      "component" : "RowDistributor",
      "metadata" : {
        "label" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
        "slug" : "Reformat_To_separate_NFST_and_ST_RowDistributor",
        "x" : 420,
        "y" : 600,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out0",
          "slug" : "out0"
        }, {
          "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out1",
          "slug" : "out1"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "outports" : [ {
          "path" : "out0",
          "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out0",
          "model" : {
            "format" : "scala",
            "expression" : "lit(Config.TAC_CONDITION).cast(IntegerType) > lit(1)"
          }
        }, {
          "path" : "out1",
          "id" : "Reformat_To_separate_NFST_and_ST_RowDistributor__out1",
          "model" : {
            "format" : "scala",
            "expression" : "!(lit(Config.TAC_CONDITION).cast(IntegerType) > lit(1))"
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Reformat_To_separate_NFST_and_ST_Filter_select" : {
      "id" : "Reformat_To_separate_NFST_and_ST_Filter_select",
      "component" : "Filter",
      "metadata" : {
        "label" : "Reformat_To_separate_NFST_and_ST_Filter_select",
        "slug" : "Reformat_To_separate_NFST_and_ST_Filter_select",
        "x" : 220,
        "y" : 600,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_ST_Filter_select__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Reformat_To_separate_NFST_and_ST_Filter_select__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "format" : "scala",
          "expression" : "col(\"tac_name\") === lit(Config.TAC_NM)"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Map_T_A_pairs_as_per_ST_Group_NM_NFST" : {
      "id" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST",
      "component" : "Script",
      "metadata" : {
        "label" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST",
        "slug" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST",
        "x" : 820,
        "y" : 400,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_rule_def",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "qualifier_cd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "operator",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "compare_value",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "conjunction_cd",
                    "type" : "string",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "rule_expression_id",
                    "type" : "integer",
                    "nullable" : false,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : false
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Map_T_A_pairs_as_per_ST_Group_NM_NFST__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\nimport scala.collection.mutable.ArrayBuffer\n\nval inputFilter_in_DF = in.filter(\n  (element_at(col(\"target_rule_def\"), lit(1)).getField(\"qualifier_cd\") === lit(\"ST_STEP_NUM\"))\n    .and(col(\"tac_name\") === lit(Config.TAC_NM))\n)\n\nval process_udf = udf({ (row: Row) => {\n  val target_prdcts = row.getAs[Seq[Row]](\"target_prdcts\")\n  val st_therapy_dtl_data_lkp = row.getAs[Seq[Row]](\"st_therapy_dtl_data_lkp\")\n  val alternate_prdcts = ArrayBuffer[Row]()\n  val final_target_prdcts = ArrayBuffer[Array[Byte]]()\n  val final_alternate_prdcts = ArrayBuffer[Row]()\n\n  val results = ArrayBuffer[Row]()\n  if (target_prdcts.length > 0) {\n    st_therapy_dtl_data_lkp.foreach { lkp_data ⇒\n      val compare_value = lkp_data.getAs[String](0)\n\n      lkp_data.getAs[Seq[Row]](1).toArray.foreach { st_therapy_dtl_data ⇒\n        if (target_prdcts.indexWhere(t ⇒ t.getAs[String](1) == st_therapy_dtl_data.getAs[String](0)) != -1) {\n          val vec_index = alternate_prdcts.indexWhere(t ⇒ t.getAs[String](1) == st_therapy_dtl_data.getAs[String](0))\n          if (vec_index == -1) {\n            alternate_prdcts.append(\n              Row(\n                compare_value,\n                st_therapy_dtl_data.getAs[String](0),\n                st_therapy_dtl_data.getAs[Array[Byte]](2)\n              )\n            )\n          } else {\n            alternate_prdcts(vec_index) = Row(\n              compare_value,\n              st_therapy_dtl_data.getAs[String](0),\n              _bv_or(alternate_prdcts(vec_index).getAs[Array[Byte]](2), st_therapy_dtl_data.getAs[Array[Byte]](2))\n            )\n          }\n        }\n      }\n    }\n  }\n\n  target_prdcts.toArray.foreach { tar_prd ⇒\n    final_target_prdcts.append(tar_prd.getAs[Array[Byte]](2))\n    val vec_index = alternate_prdcts.indexWhere(t ⇒ t.getAs[String](1) == tar_prd.getAs[String](1))\n\n    if (vec_index == -1) {\n      final_alternate_prdcts.append(\n        Row(\n          _bv_all_zeros(),\n          \"\",\n          \"\",\n          \"N/A\"\n        )\n      )\n    } else {\n      final_alternate_prdcts.append(\n        Row(\n          alternate_prdcts(vec_index).getAs[Array[Byte]](2),\n          \"\",\n          \"\",\n          \"N/A\"\n        )\n      )\n    }\n  }\n\n  final_target_prdcts.zipWithIndex.foreach {\n    case (r, idx) ⇒\n      results.append(\n        Row(\n          new java.math.BigDecimal(0),\n          \"N/A - follows ST TAC\",\n          \"N/A - follows ST TAC\",\n          null,\n          \"N/A - follows ST TAC\",\n          \"0\",\n          Array(final_target_prdcts(idx)),\n          Array(final_alternate_prdcts(idx)),\n          \"N/A\",\n          null,\n          null,\n          Array[String](),\n          row.getAs[String](13)\n        ))\n  }\n  results.toArray\n}\n}, ArrayType(StructType(List(\n  StructField(\"tal_id\", DecimalType(10, 0), true),\n  StructField(\"tal_name\", StringType, true),\n  StructField(\"tal_assoc_name\", StringType, true),\n  StructField(\"tar_udl_nm\", StringType, true),\n  StructField(\"tal_desc\", StringType, true),\n  StructField(\"priority\", StringType, true),\n  StructField(\"tal_assoc_type_cd\", StringType, true),\n  StructField(\"target_prdcts\", ArrayType(BinaryType), true),\n  StructField(\n    \"alt_constituent_prdcts\",\n    ArrayType(\n      StructType(List(\n        StructField(\"alt_prdcts\", BinaryType, true),\n        StructField(\"constituent_group\", StringType, true),\n        StructField(\"constituent_reqd\", StringType, true),\n        StructField(\"udl_nm\", StringType, true)\n      )),\n      true\n    ),\n    true\n  ),\n  StructField(\"shared_qual\", StringType, true),\n  StructField(\"override_tac_name\", StringType, true),\n  StructField(\"override_tar_name\", StringType, true),\n  StructField(\"constituent_grp_vec\", ArrayType(StringType, true), true),\n  StructField(\"newline\", StringType, true)\n))))\n\nval df = inputFilter_in_DF\n  .withColumn(\n    \"target_prdcts\",\n    transform(\n      lookup_row(\"Step_Therapy_DTL_File\", element_at(col(\"target_rule_def\"), 0).getField(\"compare_value\")),\n      st_therapy_dtl_data ⇒\n        struct(\n          (element_at(col(\"target_rule_def\"), 0).getField(\"compare_value\")).as(\"number\"),\n          (st_therapy_dtl_data.getField(\"step_therapy_group_name\")).as(\"group\"),\n          (st_therapy_dtl_data.getField(\"products\")).as(\"products\")\n        )\n    )\n  )\n  .withColumn(\n    \"st_therapy_dtl_data_lkp\",\n    transform(\n      col(\"alt_rule_def\"),\n      alt_rules ⇒\n        struct(\n          alt_rules.getField(\"compare_value\").as(\"compare_value\"),\n          lookup_row(\"Step_Therapy_DTL_File\", alt_rules.getField(\"compare_value\")).as(\"st_therapy_dtl_data\")\n        )\n    )\n  )\n\nval origColumns = in.columns.map(col)\nval out = in\n  .select(struct(origColumns: _*).as(\"inputRows\"))\n  .select(explode(process_udf(col(\"inputRows\"))).alias(\"output\"))\n  .select(col(\"output.*\"))\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
        "scriptMethodFooter" : "    out\n}"
      }
    },
    "OFIL_TAC_Rule_Xwalk" : {
      "id" : "OFIL_TAC_Rule_Xwalk",
      "component" : "Source",
      "metadata" : {
        "label" : "OFIL_TAC_Rule_Xwalk",
        "slug" : "OFIL_TAC_Rule_Xwalk",
        "x" : 20,
        "y" : 600,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "OFIL_TAC_Rule_Xwalk__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/OFIL_TAC_Rule_Xwalk"
      }
    },
    "Gather" : {
      "id" : "Gather",
      "component" : "SetOperation",
      "metadata" : {
        "label" : "Gather",
        "slug" : "Gather",
        "x" : 1420,
        "y" : 600,
        "phase" : 4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Gather__in4",
          "slug" : "in4",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "Gather__in3",
          "slug" : "in3",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "Gather__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "operationType" : "unionAll",
        "allowMissingColumns" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
        "projectName" : "ProphecySparkBasicsScala"
      }
    },
    "Products" : {
      "id" : "Products",
      "component" : "Source",
      "metadata" : {
        "label" : "Products",
        "slug" : "Products",
        "x" : 20,
        "y" : 400,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Products__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Products"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}