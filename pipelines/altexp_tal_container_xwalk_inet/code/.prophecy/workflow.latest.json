{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "7.1.83"
      }
    },
    "id" : "altexp_tal_container_xwalk",
    "uri" : "pipelines/altexp_tal_container_xwalk_inet",
    "language" : "scala",
    "fabricId" : "1593",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "hariprophecyioteam.transpilermaltexpansion.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions" ],
      "initialCode" : "",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "TARGET_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_CLINC_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "CAG_TAL_CONTAINER_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_PRXY_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "Association_Processing",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "PRODUCTS_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_ALT_REJECT_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "USER_ID",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "RUN_TS",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ALIAS_PRODUCT_FILE",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "REBATE_ELIGIBLE_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "CLIN_INDCN",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "constituent_group",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "STEP_GRP_NM_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORMULARY_NM",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "GPI_RANK_RATIO",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAD_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "RULE_PRODUCTS_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "STEP_GRP_NUM_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_CAG_OVRRD_DATA_PATH",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_TARGET_REJECT_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Alternative_Rollup_Processing",
              "kind" : {
                "type" : "record",
                "fields" : [ ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "e45",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out",
    "target" : "Alt_Load_Ready",
    "targetPort" : "Alt_Load_Ready__in"
  }, {
    "id" : "e46",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out1",
    "target" : "Target_Load_Ready",
    "targetPort" : "Target_Load_Ready__in"
  }, {
    "id" : "e47",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out2",
    "target" : "Alt_Proxy_Load_Ready",
    "targetPort" : "Alt_Proxy_Load_Ready__in"
  }, {
    "id" : "e48",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out3",
    "target" : "Clinical_indn_Load_Ready",
    "targetPort" : "Clinical_indn_Load_Ready__in"
  }, {
    "id" : "e23",
    "source" : "Expanded_UDL",
    "sourcePort" : "Expanded_UDL__out",
    "target" : "Expanded_UDL_lookup",
    "targetPort" : "Expanded_UDL_lookup__in"
  }, {
    "id" : "e24",
    "source" : "Expanded_UDL_wt_rl_priority",
    "sourcePort" : "Expanded_UDL_wt_rl_priority__out",
    "target" : "Expanded_UDL_wt_rl_priority_lookup",
    "targetPort" : "Expanded_UDL_wt_rl_priority_lookup__in"
  }, {
    "id" : "e25",
    "source" : "Gpi_rank_ratio",
    "sourcePort" : "Gpi_rank_ratio__out",
    "target" : "Gpi_rank_ratio_lookup",
    "targetPort" : "Gpi_rank_ratio_lookup__in"
  }, {
    "id" : "e26",
    "source" : "LKP_Alias_Prod",
    "sourcePort" : "LKP_Alias_Prod__out",
    "target" : "LKP_Alias_Prod_lookup",
    "targetPort" : "LKP_Alias_Prod_lookup__in"
  }, {
    "id" : "e27",
    "source" : "LKP_CLIN_INDCN",
    "sourcePort" : "LKP_CLIN_INDCN__out",
    "target" : "LKP_CLIN_INDCN_lookup",
    "targetPort" : "LKP_CLIN_INDCN_lookup__in"
  }, {
    "id" : "e28",
    "source" : "LKP_Form_CAG_dataset",
    "sourcePort" : "LKP_Form_CAG_dataset__out",
    "target" : "LKP_Form_CAG_dataset_lookup",
    "targetPort" : "LKP_Form_CAG_dataset_lookup__in"
  }, {
    "id" : "e29",
    "source" : "LKP_Prod",
    "sourcePort" : "LKP_Prod__out",
    "target" : "LKP_Prod_lookup",
    "targetPort" : "LKP_Prod_lookup__in"
  }, {
    "id" : "e30",
    "source" : "LKP_Rebate_eligible",
    "sourcePort" : "LKP_Rebate_eligible__out",
    "target" : "LKP_Rebate_eligible_lookup",
    "targetPort" : "LKP_Rebate_eligible_lookup__in"
  }, {
    "id" : "e31",
    "source" : "LKP_Rule_Products",
    "sourcePort" : "LKP_Rule_Products__out",
    "target" : "LKP_Rule_Products_lookup",
    "targetPort" : "LKP_Rule_Products_lookup__in"
  }, {
    "id" : "e32",
    "source" : "LKP_ST_GRP_NUM",
    "sourcePort" : "LKP_ST_GRP_NUM__out",
    "target" : "LKP_ST_GRP_NUM_with_sequence",
    "targetPort" : "LKP_ST_GRP_NUM_with_sequence__in"
  }, {
    "id" : "e33",
    "source" : "LKP_ST_GRP_NUM_with_sequence",
    "sourcePort" : "LKP_ST_GRP_NUM_with_sequence__out",
    "target" : "LKP_ST_GRP_NUM_lookup",
    "targetPort" : "LKP_ST_GRP_NUM_lookup__in"
  }, {
    "id" : "e34",
    "source" : "LKP_Step_Grp_NM",
    "sourcePort" : "LKP_Step_Grp_NM__out",
    "target" : "LKP_Step_Grp_NM_lookup",
    "targetPort" : "LKP_Step_Grp_NM_lookup__in"
  }, {
    "id" : "e35",
    "source" : "LKP_TAC_Exp",
    "sourcePort" : "LKP_TAC_Exp__out",
    "target" : "LKP_TAC_Exp_lookup",
    "targetPort" : "LKP_TAC_Exp_lookup__in"
  }, {
    "id" : "e36",
    "source" : "LKP_TAR_Exp",
    "sourcePort" : "LKP_TAR_Exp__out",
    "target" : "LKP_TAR_Exp_lookup",
    "targetPort" : "LKP_TAR_Exp_lookup__in"
  }, {
    "id" : "e37",
    "source" : "TAD_Xwalk",
    "sourcePort" : "TAD_Xwalk__out",
    "target" : "TAD_Xwalk_lookup",
    "targetPort" : "TAD_Xwalk_lookup__in"
  }, {
    "id" : "e49",
    "source" : "IFIL_CAG_TAL_Container",
    "sourcePort" : "IFIL_CAG_TAL_Container__out",
    "target" : "Association_Processing",
    "targetPort" : "altexp_tal_container_xwalk__Association_Processing__in"
  } ],
  "processes" : {
    "LKP_TAR_Exp_lookup" : {
      "id" : "LKP_TAR_Exp_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_TAR_Exp_lookup",
        "slug" : "LKP_TAR_Exp_lookup",
        "x" : 220,
        "y" : 1020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_TAR_Exp_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tar_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "target_prdcts",
                    "type" : {
                      "type" : "array",
                      "elementType" : "binary",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alt_contents",
                    "type" : {
                      "type" : "array",
                      "elementType" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_prdcts",
                          "type" : {
                            "type" : "array",
                            "elementType" : "binary",
                            "containsNull" : true
                          },
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prdcts_all_prio",
                          "type" : {
                            "type" : "array",
                            "elementType" : {
                              "type" : "array",
                              "elementType" : "binary",
                              "containsNull" : true
                            },
                            "containsNull" : true
                          },
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "common_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "common_alt_prdcts",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "common_target_prdcts",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keep_all_targets",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tar_name" ],
        "valueColumns" : [ "tar_id", "tar_dtl_id", "tar_name", "tar_dtl_type_cd", "contents", "common_alt_prdcts", "common_target_prdcts", "keep_all_targets", "newline" ],
        "processName" : "LKP_TAR_Exp"
      }
    },
    "Expanded_UDL_wt_rl_priority" : {
      "id" : "Expanded_UDL_wt_rl_priority",
      "component" : "Source",
      "metadata" : {
        "label" : "Expanded_UDL_wt_rl_priority",
        "slug" : "Expanded_UDL_wt_rl_priority",
        "x" : 20,
        "y" : 3020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Expanded_UDL_wt_rl_priority__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Expanded_UDL_wt_rl_priority"
      }
    },
    "LKP_TAC_Exp_lookup" : {
      "id" : "LKP_TAC_Exp_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_TAC_Exp_lookup",
        "slug" : "LKP_TAC_Exp_lookup",
        "x" : 220,
        "y" : 2220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_TAC_Exp_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_contents",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "target_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "contents",
                    "type" : {
                      "type" : "array",
                      "elementType" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "target_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ST_flag",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "priority",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "xtra_proc_flg",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tac_name" ],
        "valueColumns" : [ "tac_id", "tac_name", "tac_contents", "eff_dt", "term_dt", "newline" ],
        "processName" : "LKP_TAC_Exp"
      }
    },
    "LKP_Rebate_eligible" : {
      "id" : "LKP_Rebate_eligible",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Rebate_eligible",
        "slug" : "LKP_Rebate_eligible",
        "x" : 20,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Rebate_eligible__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Rebate_eligible"
      }
    },
    "LKP_CLIN_INDCN" : {
      "id" : "LKP_CLIN_INDCN",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN",
        "slug" : "LKP_CLIN_INDCN",
        "x" : 20,
        "y" : 1420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_CLIN_INDCN__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_CLIN_INDCN"
      }
    },
    "LKP_Rule_Products_lookup" : {
      "id" : "LKP_Rule_Products_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Rule_Products_lookup",
        "slug" : "LKP_Rule_Products_lookup",
        "x" : 220,
        "y" : 2620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Rule_Products_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "qualifier_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "operator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "compare_value",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "qualifier_cd", "operator", "compare_value" ],
        "valueColumns" : [ "qualifier_cd", "operator", "compare_value", "products" ],
        "processName" : "LKP_Rule_Products"
      }
    },
    "Expanded_UDL_lookup" : {
      "id" : "Expanded_UDL_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Expanded_UDL_lookup",
        "slug" : "Expanded_UDL_lookup",
        "x" : 220,
        "y" : 2020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Expanded_UDL_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "udl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "udl_nm" ],
        "valueColumns" : [ "udl_id", "udl_nm", "udl_desc", "products", "eff_dt", "term_dt", "contents", "newline" ],
        "processName" : "Expanded_UDL"
      }
    },
    "Gpi_rank_ratio_lookup" : {
      "id" : "Gpi_rank_ratio_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Gpi_rank_ratio_lookup",
        "slug" : "Gpi_rank_ratio_lookup",
        "x" : 220,
        "y" : 2820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Gpi_rank_ratio_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ratio",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "gpi14" ],
        "valueColumns" : [ "gpi14", "rank", "ratio", "run_eff_dt" ],
        "processName" : "Gpi_rank_ratio"
      }
    },
    "LKP_Rule_Products" : {
      "id" : "LKP_Rule_Products",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Rule_Products",
        "slug" : "LKP_Rule_Products",
        "x" : 20,
        "y" : 2620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Rule_Products__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Rule_Products"
      }
    },
    "LKP_Prod" : {
      "id" : "LKP_Prod",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Prod",
        "slug" : "LKP_Prod",
        "x" : 20,
        "y" : 2420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Prod__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Prod"
      }
    },
    "LKP_ST_GRP_NUM_lookup" : {
      "id" : "LKP_ST_GRP_NUM_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM_lookup",
        "slug" : "LKP_ST_GRP_NUM_lookup",
        "x" : 480,
        "y" : 20,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_ST_GRP_NUM_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "__id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "__id" ],
        "valueColumns" : [ "tac_id", "tac_name", "priority", "_target_st_grp_num", "_alt_st_grp_nums" ],
        "processName" : "LKP_ST_GRP_NUM"
      }
    },
    "IFIL_CAG_TAL_Container" : {
      "id" : "IFIL_CAG_TAL_Container",
      "component" : "Source",
      "metadata" : {
        "label" : "IFIL_CAG_TAL_Container",
        "slug" : "IFIL_CAG_TAL_Container",
        "x" : 20,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "IFIL_CAG_TAL_Container__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/IFIL_CAG_TAL_Container"
      }
    },
    "LKP_Form_CAG_dataset" : {
      "id" : "LKP_Form_CAG_dataset",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Form_CAG_dataset",
        "slug" : "LKP_Form_CAG_dataset",
        "x" : 20,
        "y" : 1620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Form_CAG_dataset__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Form_CAG_dataset"
      }
    },
    "TAD_Xwalk" : {
      "id" : "TAD_Xwalk",
      "component" : "Source",
      "metadata" : {
        "label" : "TAD_Xwalk",
        "slug" : "TAD_Xwalk",
        "x" : 20,
        "y" : 1220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAD_Xwalk__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAD_Xwalk"
      }
    },
    "LKP_Alias_Prod" : {
      "id" : "LKP_Alias_Prod",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Alias_Prod",
        "slug" : "LKP_Alias_Prod",
        "x" : 20,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Alias_Prod__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Alias_Prod"
      }
    },
    "LKP_Alias_Prod_lookup" : {
      "id" : "LKP_Alias_Prod_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Alias_Prod_lookup",
        "slug" : "LKP_Alias_Prod_lookup",
        "x" : 220,
        "y" : 620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Alias_Prod_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alias_set_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alias_label_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11" ],
        "valueColumns" : [ "alias_set_name", "ndc11", "alias_label_nm", "newline" ],
        "processName" : "LKP_Alias_Prod"
      }
    },
    "LKP_Rebate_eligible_lookup" : {
      "id" : "LKP_Rebate_eligible_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Rebate_eligible_lookup",
        "slug" : "LKP_Rebate_eligible_lookup",
        "x" : 220,
        "y" : 820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Rebate_eligible_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "dl_bit",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rebate_elig_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "dl_bit" ],
        "valueColumns" : [ "dl_bit", "rebate_elig_cd" ],
        "processName" : "LKP_Rebate_eligible"
      }
    },
    "Expanded_UDL" : {
      "id" : "Expanded_UDL",
      "component" : "Source",
      "metadata" : {
        "label" : "Expanded_UDL",
        "slug" : "Expanded_UDL",
        "x" : 20,
        "y" : 2020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Expanded_UDL__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Expanded_UDL"
      }
    },
    "LKP_ST_GRP_NUM" : {
      "id" : "LKP_ST_GRP_NUM",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM",
        "slug" : "LKP_ST_GRP_NUM",
        "x" : 20,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_ST_GRP_NUM__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_ST_GRP_NUM"
      }
    },
    "LKP_CLIN_INDCN_lookup" : {
      "id" : "LKP_CLIN_INDCN_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN_lookup",
        "slug" : "LKP_CLIN_INDCN_lookup",
        "x" : 220,
        "y" : 1420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_CLIN_INDCN_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_assoc_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tal_assoc_name" ],
        "valueColumns" : [ "tal_assoc_id", "tal_assoc_name", "clinical_indn_id", "clinical_indn_name", "clinical_indn_desc", "rank" ],
        "processName" : "LKP_CLIN_INDCN"
      }
    },
    "LKP_Step_Grp_NM_lookup" : {
      "id" : "LKP_Step_Grp_NM_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Step_Grp_NM_lookup",
        "slug" : "LKP_Step_Grp_NM_lookup",
        "x" : 220,
        "y" : 1820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Step_Grp_NM_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_names",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11", "step_therapy_step_number" ],
        "valueColumns" : [ "ndc11", "step_therapy_step_number", "step_therapy_group_names" ],
        "processName" : "LKP_Step_Grp_NM"
      }
    },
    "LKP_Prod_lookup" : {
      "id" : "LKP_Prod_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Prod_lookup",
        "slug" : "LKP_Prod_lookup",
        "x" : 220,
        "y" : 2420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Prod_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "dl_bit",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inactive_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "msc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rx_otc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "desi",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_strength",
              "type" : "decimal(14,5)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "repack_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "dl_bit" ],
        "valueColumns" : [ "dl_bit", "ndc11", "gpi14", "status_cd", "inactive_dt", "msc", "drug_name", "rx_otc", "desi", "roa_cd", "dosage_form_cd", "prod_strength", "repack_cd", "prod_short_desc", "gpi14_desc", "gpi8_desc", "newline" ],
        "processName" : "LKP_Prod"
      }
    },
    "Association_Processing" : {
      "id" : "Association_Processing",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "Association_Processing",
        "slug" : "Association_Processing",
        "x" : 220,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "altexp_tal_container_xwalk__Association_Processing__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out3",
          "slug" : "out3"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out2",
          "slug" : "out2"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out1",
          "slug" : "out1"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "e44",
        "source" : "RPL",
        "sourcePort" : "Association_Processing__RPL__out",
        "target" : "Tranform_Proxy_DTL_Layout",
        "targetPort" : "Association_Processing__Tranform_Proxy_DTL_Layout__in"
      }, {
        "id" : "e51",
        "source" : "Alternative_Rollup_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out",
        "target" : "RPL",
        "targetPort" : "Association_Processing__RPL__in3"
      }, {
        "id" : "e52",
        "source" : "Alternative_Rollup_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1",
        "target" : "RPL",
        "targetPort" : "Association_Processing__RPL__in2"
      }, {
        "id" : "e39",
        "source" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__out",
        "target" : "Get_Unique_Target_Products",
        "targetPort" : "Association_Processing__Get_Unique_Target_Products__left"
      }, {
        "id" : "e38",
        "source" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
        "sourcePort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__out",
        "target" : "Get_Unique_Target_Products",
        "targetPort" : "Association_Processing__Get_Unique_Target_Products__right"
      }, {
        "id" : "e18",
        "source" : "Rank_AltsReformat_0",
        "sourcePort" : "Association_Processing__Rank_AltsReformat_0__out",
        "target" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
        "targetPort" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__in"
      }, {
        "id" : "e22",
        "source" : "Normalize_TAL_Target_Drugs",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
        "target" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
        "targetPort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__in"
      }, {
        "id" : "e16",
        "source" : "Rank_AltsReformat_1",
        "sourcePort" : "Association_Processing__Rank_AltsReformat_1__out",
        "target" : "Normalize_TAL_Target_Drugs",
        "targetPort" : "Association_Processing__Normalize_TAL_Target_Drugs__in"
      }, {
        "id" : "e21",
        "source" : "Normalize_TAL_Target_Drugs",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
        "target" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
        "targetPort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__in"
      }, {
        "id" : "e20",
        "source" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
        "sourcePort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__out",
        "target" : "Normalize_TAL_Alts_assign_attributes",
        "targetPort" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__in"
      }, {
        "id" : "e19",
        "source" : "Rank_Alts_RowDistributor",
        "sourcePort" : "Association_Processing__Rank_Alts_RowDistributor__out0",
        "target" : "Rank_AltsReformat_0",
        "targetPort" : "Association_Processing__Rank_AltsReformat_0__in"
      }, {
        "id" : "e15",
        "source" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
        "sourcePort" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__out",
        "target" : "Rank_Alts_RowDistributor",
        "targetPort" : "Association_Processing__Rank_Alts_RowDistributor__in"
      }, {
        "id" : "e17",
        "source" : "Rank_Alts_RowDistributor",
        "sourcePort" : "Association_Processing__Rank_Alts_RowDistributor__out1",
        "target" : "Rank_AltsReformat_1",
        "targetPort" : "Association_Processing__Rank_AltsReformat_1__in"
      }, {
        "id" : "e9",
        "source" : "Get_Unique_Target_Products",
        "sourcePort" : "Association_Processing__Get_Unique_Target_Products__out",
        "target" : "Normalize_Clinical_Indication",
        "targetPort" : "Association_Processing__Normalize_Clinical_Indication__in"
      }, {
        "id" : "e53",
        "source" : "Normalize_TAL_Alts_assign_attributes",
        "sourcePort" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__out",
        "target" : "Alternative_Rollup_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in"
      }, {
        "id" : "WFaQo0HRjca8jm_Z9HDo7",
        "source" : "Normalize_Clinical_Indication",
        "sourcePort" : "Association_Processing__Normalize_Clinical_Indication__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out3"
      }, {
        "id" : "fEW2DUfqbvxct1Lbrx7b6",
        "source" : "Tranform_Proxy_DTL_Layout",
        "sourcePort" : "Association_Processing__Tranform_Proxy_DTL_Layout__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out2"
      }, {
        "id" : "NiagWL--e5Gchv8aybavP",
        "source" : "RPL",
        "sourcePort" : "Association_Processing__RPL__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out"
      }, {
        "id" : "wwQ48jTtKt4qh7csHgz78",
        "source" : "Association_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__in",
        "target" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
        "targetPort" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__in"
      }, {
        "id" : "vMBQgp16srL9VDsNOm9Jt",
        "source" : "Get_Unique_Target_Products",
        "sourcePort" : "Association_Processing__Get_Unique_Target_Products__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out1"
      } ],
      "processes" : {
        "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat" : {
          "id" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
            "slug" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
            "x" : 160,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : "binary",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_constituent_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prdcts",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "import io.prophecy.abinitio.ScalaFunctions._\nimport java.math.BigDecimal\nimport scala.util.control.Breaks\n\ndef process_udf(in: Row): Row = {\n  var tac_dtls                  = Row()\n  var target_prdcts             = Array[Array[Byte]]()\n  var alt_prdcts                = Array[Array[Byte]]()\n  var indx                      = -1\n  var tar_prdcts                = Row()\n  var target_tar_prdcts_mapping = Array[Row]()\n  var alt_tar_prdcts_mapping    = Array[Row]()\n  var target_prdct_dtl          = Array[Row]()\n  var unsorted_target_prdct_dtl = Array[Row]()\n  var alt_bucket_vec            = Array[Row]()\n  var alt_bucket_vec_step       = Array[Row]()\n  var target_dl_bits            = Array[Int]()\n  var alt_dl_bits               = Array[Int]()\n  var tac_target_dl_bits        = Array[Int]()\n  var lv_tac_target_dl_bits     = Array[Int]()\n  var alt_rank_vec              = Array[Row]()\n  var contents                  = Array[Row]()\n  var lv_tac_contents =\n    Row(Array[Byte](), Array[Byte](), Row(Array[Byte](), Array[Byte](), \"0\", \"0\"), \"0\")\n  var lv_target_prdcts                = _bv_all_zeros()\n  var lv_alt_prdcts                   = _bv_all_zeros()\n  var _target_prdcts                  = _bv_all_zeros()\n  var _alt_prdcts                     = _bv_all_zeros()\n  var _tac_target_prdcts              = _bv_all_zeros()\n  var _tac_alt_prdcts                 = _bv_all_zeros()\n  var pos                             = 0\n  var tar_idx_vec                     = Array[Int]()\n  var _all_tac_target_prdcts          = _bv_all_zeros()\n  var _all_tac_alt_prdcts             = _bv_all_zeros()\n  var store_bucket_idx_t              = Array[Row]()\n  var index_vec                       = Array[Int]()\n  var alt_prdcts_rank_vec             = Array[Row]()\n  var target_wo_alt_prdct_dtl         = Array[Row]()\n  var alt_constituent_prdcts_vec      = Array[Row]()\n  var step_alt_prdcts                 = Array[Byte]()\n  var length_of_contents              = 0\n  var length_of_alt_contents          = 0\n  var tar_roa_df_alt                  = Array[Row]()\n  var steptal_prdcts                  = Array[Row]()\n  var steptal_inp                     = Array[Row]()\n  var tar_st_target                   = _bv_all_zeros()\n  var tar_prds                        = _bv_all_zeros()\n  var step_alt_prds                   = _bv_all_zeros()\n  var in_tar                          = _bv_all_zeros()\n  var in_alt_step                     = _bv_all_zeros()\n  var step_tar                        = _bv_all_zeros()\n  var step_tar1                       = _bv_all_zeros()\n  var final_sorted_prdcts1            = Array[Array[Byte]]()\n  var final_sorted_prdcts2            = Array[Array[Byte]]()\n  var final_sorted_prdcts_step        = Array[Array[Byte]]()\n  var final_sorted_prdcts_step1       = Array[Array[Byte]]()\n  var final_sorted_prdcts_overlapping = Array[Array[Byte]]()\n  var number_of_alt_bucket            = 0;\n  var st_len                          = 0;\n  var length_overlapping              = 0;\n  var step_join_alternate             = _bv_all_zeros()\n  var step_alt_prdcts_tala            = Array[Array[Byte]]()\n\n  tar_prdcts = in.getAs[Row](\"lkp_tar_exp_override_tar_name\") //TODO\n  tar_roa_df_alt = tar_prdcts.getAs[Seq[Row]](\"contents\").head.getAs[Seq[Row]](\"alt_contents\").toArray\n\n  if (in.getAs[String](\"tal_id\").toInt == 0) {\n    step_alt_prdcts = in.getAs[Seq[Row]](\"alt_constituent_prdcts\").head.getAs[Array[Byte]](\"alt_prdcts\")\n    length_of_contents = tar_prdcts.getAs[Seq[Row]](\"contents\").length\n    var contents = tar_prdcts.getAs[Seq[Row]](\"contents\").toArray\n    for (c ← 0 until length_of_contents) {\n      var alt_contents = contents(c).getAs[Seq[Row]](\"alt_contents\").toArray\n      length_of_alt_contents = alt_contents.length\n      for (a ← 0 until length_of_alt_contents) {\n        alt_contents(a) = updateIndexInRow(alt_contents(a),\n                                           0,\n                                           Array.concat(\n                                             alt_contents(a).getSeq[Array[Byte]](0).toArray,\n                                             Array.fill(1)(step_alt_prdcts)\n                                           )\n        )\n        alt_contents(a) =\n          updateIndexInRow(alt_contents(a), 2, _bv_or(alt_contents(a).getAs[Array[Byte]](2), step_alt_prdcts))\n      }\n      contents(c) = updateIndexInRow(contents(c), 1, alt_contents)\n    }\n    tar_prdcts = updateIndexInRow(tar_prdcts, 4, contents)\n    /*\n    type tar_xwalk_t =\n    record\n  0    decimal(\"\\x01\",0, maximum_length=10) tar_id /*NUMBER(9) NOT NULL*/;\n  1    decimal(\"\\x01\",0, maximum_length=10) tar_dtl_id /*NUMBER(9) NOT NULL*/;\n  2    string(\"\\x01\", maximum_length=20) tar_name /*VARCHAR2(20) NOT NULL*/;\n  3    decimal(\"\\x01\",0, maximum_length=39) tar_dtl_type_cd /*NUMBER(38) NOT NULL*/;\n      record\n       0 bit_vector_t[int] target_prdcts;\n        record\n        0   bit_vector_t[int] alt_prdcts;\n        1  bit_vector_t[int][int] alt_prdcts_all_prio;\n        2  bit_vector_t common_prdcts;\n       1 end[int] alt_contents;\n  4    end[int] contents;\n  5    bit_vector_t common_alt_prdcts;\n  6    bit_vector_t common_target_prdcts;\n  7    decimal(1) keep_all_targets = 0;\n  8    string(1) newline = '\\n';\n    end;\n\n    type tac_xwalk_t =\n    record\n    0  decimal(\"\\x01\",0, maximum_length=10) tac_id /*NUMBER(9) NOT NULL*/;\n    1 string(\"\\x01\", maximum_length=20) tac_name /*VARCHAR2(20) NOT NULL*/;\n    2  tac_contents_t[int] tac_contents;\n    3  date(\"YYYYMMDD\")(\"\\x01\") eff_dt /*DATE NOT NULL*/;\n    4  date(\"YYYYMMDD\")(\"\\x01\") term_dt /*DATE NOT NULL*/;\n    5  string(1) newline = '\\n';\n    end;\n    type tac_contents_t =\n    record\n 0    bit_vector_t target_prdcts;\n 1    bit_vector_t alt_prdcts;\n 2    contents_t[int] contents;\n 3    decimal(1) xtra_proc_flg = 0;\n    end;\n\n    type contents_t =\n    record\n  0    bit_vector_t target_prdcts;\n  1    bit_vector_t alt_prdcts;\n  2    decimal(1) ST_flag =0; //US1602056\n  3    decimal(1) priority; //US3680892\n    end;\n     */\n  }\n\n  if (in.getAs[String](\"tal_assoc_type_cd\").toInt == 1) {\n    tac_dtls = in.getAs[Row](\"lkp_tac_exp_override_tar_name\") //TODO\n\n    var tac_contents = tac_dtls.getAs[Seq[Row]](\"tac_contents\").toArray\n    for (i ← 0 until tac_contents.length) {\n      lv_target_prdcts =\n        if (tar_prdcts.getAs[String](7).toInt > 0) tac_contents(i).getAs[Array[Byte]](\"target_prdcts\")\n        else _bv_and(tac_contents(i).getAs[Array[Byte]](\"target_prdcts\"), tar_prdcts.getAs[Array[Byte]](6));\n\n      lv_alt_prdcts = _bv_and(tac_contents(i).getAs[Array[Byte]](\"alt_prdcts\"), tar_prdcts.getAs[Array[Byte]](5));\n\n      if (_bv_count_one_bits(lv_target_prdcts) > 0 && _bv_count_one_bits(lv_alt_prdcts) > 0) {\n        if (tac_contents(i).getAs[String](3).toInt > 0) {\n          tac_contents(i).getAs[Seq[Row]](\"contents\").foreach { rec ⇒\n            _target_prdcts = _bv_and(lv_target_prdcts, rec.getAs[Array[Byte]](\"target_prdcts\"))\n            _alt_prdcts = _bv_and(lv_alt_prdcts,       rec.getAs[Array[Byte]](\"alt_prdcts\"))\n            if (_bv_count_one_bits(_target_prdcts) > 0 && _bv_count_one_bits(_alt_prdcts) > 0) {\n              contents = Array.concat(\n                contents,\n                Array.fill(1)(\n                  Row(_target_prdcts, _alt_prdcts, rec.getAs[String](\"ST_flag\"), rec.getAs[String](\"priority\"))\n                )\n              )\n              _tac_target_prdcts = _bv_or(_tac_target_prdcts, _target_prdcts)\n              _tac_alt_prdcts = _bv_or(_tac_alt_prdcts,       _alt_prdcts)\n            }\n          }\n\n          if (_bv_count_one_bits(_tac_target_prdcts) > 0 && _bv_count_one_bits(_tac_alt_prdcts) > 0) {\n            _all_tac_target_prdcts = _bv_or(_all_tac_target_prdcts, _tac_target_prdcts)\n            _all_tac_alt_prdcts = _bv_or(_all_tac_alt_prdcts,       _tac_alt_prdcts)\n            _tac_target_prdcts = _bv_all_zeros()\n            _tac_alt_prdcts = _bv_all_zeros()\n          }\n        } else {\n          contents = Array.concat(\n            contents,\n            Array.fill(1)(\n              Row(lv_target_prdcts,\n                  lv_alt_prdcts,\n                  tac_contents(i).getAs[Seq[Row]](2).head.getAs[String](2),\n                  tac_contents(i).getAs[Seq[Row]](2).head.getAs[String](3)\n              )\n            )\n          )\n          _all_tac_target_prdcts = _bv_or(_all_tac_target_prdcts, lv_target_prdcts)\n          _all_tac_alt_prdcts = _bv_or(_all_tac_alt_prdcts,       lv_alt_prdcts)\n        }\n      }\n    }\n    if (_bv_count_one_bits(_all_tac_target_prdcts) > 0) {\n      lv_tac_contents = updateIndexInRow(lv_tac_contents, 0, _all_tac_target_prdcts)\n      lv_tac_contents = updateIndexInRow(lv_tac_contents, 1, _all_tac_alt_prdcts)\n      lv_tac_contents = updateIndexInRow(lv_tac_contents, 2, contents)\n      lv_tac_contents = updateIndexInRow(lv_tac_contents, 3, (length_of(contents) > 1).toString)\n    } else {\n      _force_error(\"Applied TAR on TAC - No Products Left For Processing\")\n    }\n    in.getSeq[Array[Byte]](7).foreach { target_prds ⇒\n      target_prdcts = Array.concat(target_prdcts, _bv_and(target_prds, _all_tac_target_prdcts))\n    }\n    if (_bv_count_one_bits(_bv_vector_or(target_prdcts)) > 0)\n      _force_error(\"TAC Applied - No Target Products Left For Processing\")\n\n    if (in.getAs[Seq[Row]](\"alt_constituent_prdcts\").length > 0) {\n      in.getAs[Seq[Row]](\"alt_constituent_prdcts\").foreach { alt_consti_prdcts ⇒\n        alt_constituent_prdcts_vec = Array.concat(\n          alt_constituent_prdcts_vec,\n          Array.fill(1)(\n            Row(\n              _bv_and(alt_consti_prdcts.getAs[Array[Byte]](\"alt_prdcts\"), _all_tac_alt_prdcts),\n              alt_consti_prdcts.getAs[String](\"constituent_group\"),\n              alt_consti_prdcts.getAs[String](\"constituent_reqd\"),\n              alt_consti_prdcts.getAs[String](\"udl_nm\")\n            )\n          )\n        )\n      }\n\n      target_tar_prdcts_mapping =\n        apply_tar(target_prdcts, alt_constituent_prdcts_vec, tar_prdcts, 0, target_tar_prdcts_mapping, \"\", 0)\n      alt_tar_prdcts_mapping = apply_tar(Array(),\n                                         alt_constituent_prdcts_vec,\n                                         tar_prdcts,\n                                         1,\n                                         target_tar_prdcts_mapping,\n                                         in.getAs[String](\"shared_qual\"),\n                                         0\n      )\n\n      if (in.getAs[String](\"shared_qual\") != \"N/A\") {\n\n        target_tar_prdcts_mapping.foreach { target_prd ⇒\n          var bucket_index = 0\n          target_prd.getAs[Seq[Row]](0).foreach { bucket ⇒\n            bucket_index = bucket_index + 1\n            number_of_alt_bucket = 0\n            length_overlapping = 0\n            step_join_alternate = _bv_all_zeros()\n            final_sorted_prdcts_step = Array[Array[Byte]]()\n            alt_tar_prdcts_mapping.foreach { alt_prd ⇒\n              alt_bucket_vec = Array.concat(\n                alt_bucket_vec,\n                alt_prd.getAs[Seq[Row]](0).filter(r ⇒ r.getAs[String](0) == bucket.getAs[String](0)).toArray\n              )\n            }\n\n            bucket.getSeq[Array[Byte]](6).foreach { prds ⇒\n              target_dl_bits = Array.concat(target_dl_bits, _bv_indices(prds))\n            }\n            if (alt_bucket_vec.length > 0) {\n              alt_bucket_vec = alt_bucket_vec\n                .sortBy(r ⇒ (r.getAs[String](0).toInt, r.getAs[String](1).toInt, r.getAs[String](2).toInt))\n              unsorted_target_prdct_dtl = apply_gpi14_sorting(\n                target_dl_bits,\n                bucket_index,\n                bucket.getAs[String](2).toInt,\n                bucket.getAs[Array[Byte]](3),\n                alt_bucket_vec,\n                lv_tac_contents,\n                tar_roa_df_alt,\n                steptal_inp,\n                in.getAs[String](\"tar_udl_nm\"),\n                final_sorted_prdcts_step\n              );\n\n              target_dl_bits.foreach { p ⇒\n                val elem = unsorted_target_prdct_dtl.find(r ⇒ r.getAs[Int](0) == p).get\n                if (elem.getAs[String](6) == \"Y\") {\n                  target_prdct_dtl = Array.concat(target_prdct_dtl, Array.fill(1)(elem))\n                } else {\n                  target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl, Array.fill(1)(elem))\n                }\n              }\n              alt_bucket_vec = Array[Row]()\n            } else {\n              target_dl_bits.foreach { p ⇒\n                target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl,\n                                                       Array.fill(1)(\n                                                         Row(\n                                                           p,\n                                                           \"0\",\n                                                           \"0\",\n                                                           \"0\",\n                                                           Array[Row](),\n                                                           \"N\",\n                                                           \"0\"\n                                                         )\n                                                       )\n                )\n              }\n            }\n            target_dl_bits = Array[Int]()\n          }\n        }\n      } else {\n        for (y ← 0 until alt_tar_prdcts_mapping.length) {\n          tar_idx_vec = alt_tar_prdcts_mapping(y).getSeq[Int](1).toArray.sorted.distinct\n          store_bucket_idx_t = Array.concat(store_bucket_idx_t, Array.fill(1)(Row(y, Array[String]())))\n          index_vec = Array.concat(index_vec,                   Array.fill(1)(y))\n          for (z ← 0 until tar_idx_vec.length) {\n            pos = target_tar_prdcts_mapping(y).getSeq[Int](1).indexOf(tar_idx_vec(z))\n            target_dl_bits = Array[Int]()\n            alt_bucket_vec = alt_tar_prdcts_mapping(y)\n              .getAs[Seq[Row]](0)\n              .filter(r ⇒ r.getAs[String](0).toInt == tar_idx_vec(z) && r.getAs[String](2).toInt == y)\n              .toArray\n\n            val buckets = target_tar_prdcts_mapping(y).getAs[Seq[Row]](0).toArray\n            buckets(pos).getSeq[Array[Byte]](6).foreach { prds ⇒\n              target_dl_bits = Array.concat(target_dl_bits, _bv_indices(prds))\n              store_bucket_idx_t(y) = updateIndexInRow(\n                store_bucket_idx_t(y),\n                0,\n                Array.concat(store_bucket_idx_t(y).getSeq[String](1).toArray, Array.fill(1)(pos.toString))\n              )\n            }\n            if (in.getAs[String](\"shared_qual\") != \"GPI14\") {\n              val bucket = target_tar_prdcts_mapping(y).getAs[Seq[Row]](0).toArray\n              unsorted_target_prdct_dtl = apply_gpi14_sorting(\n                target_dl_bits,\n                pos + 1,\n                bucket(pos).getAs[String](2).toInt,\n                bucket(pos).getAs[Array[Byte]](3),\n                alt_bucket_vec,\n                lv_tac_contents,\n                tar_roa_df_alt,\n                steptal_inp,\n                in.getAs[String](\"tar_udl_nm\"),\n                final_sorted_prdcts_step\n              )\n              target_dl_bits.foreach { p ⇒\n                val elem = unsorted_target_prdct_dtl.find(r ⇒ r.getAs[Int](0) == p).get\n                if (elem.getAs[String](6) == \"Y\") {\n                  target_prdct_dtl = Array.concat(target_prdct_dtl, Array.fill(1)(elem))\n                } else {\n                  target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl, Array.fill(1)(elem))\n                }\n              }\n              alt_bucket_vec = Array[Row]()\n            } else {\n              var alt_rank           = 1\n              var tac_index          = 0\n              var unmatching_udl_prd = Array[Byte]()\n              tac_target_dl_bits = target_dl_bits\n              val loop = new Breaks\n              loop.breakable {\n                lv_tac_contents.getAs[Seq[Row]](2).foreach { rec ⇒\n                  if (lv_tac_target_dl_bits.length > 0) {\n                    lv_tac_target_dl_bits =\n                      _bv_indices(_bv_and(buckets(pos).getAs[Array[Byte]](3), rec.getAs[Array[Byte]](\"target_prdcts\")));\n                    if (lv_tac_target_dl_bits.length > 0) {\n                      alt_bucket_vec.foreach { bucket1 ⇒\n                        if (_bv_count_one_bits(bucket1.getAs[Array[Byte]](4)) > 0) {\n                          bucket1.getSeq[Array[Byte]](6).foreach { alt_prds ⇒\n                            val alt_prdcts_all_prio =\n                              tar_roa_df_alt(bucket1.getAs[String](0).toInt).getSeq[Array[Array[Byte]]](2).toArray\n                            var tar_roa_df_alt_cntnt = alt_prdcts_all_prio(bucket1.getAs[String](1).toInt)\n                            unmatching_udl_prd = _bv_and(alt_prds,           rec.getAs[Array[Byte]](\"alt_prdcts\"))\n                            alt_dl_bits = apply_udl_sort(unmatching_udl_prd, bucket1.getAs[String](11))\n                            if (alt_dl_bits.length > 0) {\n                              alt_rank_vec =\n                                Array.concat(alt_rank_vec,\n                                             Array.fill(1)(Row(alt_rank, alt_dl_bits, bucket1.getAs[String](11)))\n                                )\n\n                              alt_rank = alt_rank + bucket1.getSeq[Array[Byte]](6).length\n                            }\n                          }\n                        }\n                      }\n                      if (alt_rank_vec.length > 0) {\n                        tac_index = tac_index + 1\n                        val buckets = target_tar_prdcts_mapping(y).getAs[Seq[Row]](0).toArray\n                        lv_tac_target_dl_bits.foreach { p ⇒\n                          unsorted_target_prdct_dtl = Array.concat(unsorted_target_prdct_dtl,\n                                                                   Array.fill(1)(\n                                                                     Row(\n                                                                       p,\n                                                                       (pos + 1).toString,\n                                                                       buckets(pos).getAs[String](2),\n                                                                       tac_index.toString,\n                                                                       alt_rank_vec,\n                                                                       Array(),\n                                                                       \"Y\",\n                                                                       \"0\"\n                                                                     )\n                                                                   )\n                          )\n                        }\n                        alt_rank_vec = Array[Row]()\n                        tac_target_dl_bits = tac_target_dl_bits.diff(lv_tac_target_dl_bits)\n                        alt_rank = 1\n                      }\n                    }\n                  } else\n                    loop.break()\n                }\n              }\n              target_dl_bits.foreach { p ⇒\n                target_prdct_dtl =\n                  Array.concat(target_prdct_dtl, unsorted_target_prdct_dtl.filter(r ⇒ r.getAs[Int](0) == p))\n              }\n              alt_bucket_vec = Array[Row]()\n            }\n          }\n        }\n        for (i ← 0 until target_tar_prdcts_mapping.length) {\n          val buckets = target_tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray\n          if (index_vec.contains(i)) {\n            for (j ← 0 until buckets.length) {\n              if (!store_bucket_idx_t(i).getSeq[String](1).contains(j.toString)) {\n                buckets(j).getSeq[Array[Byte]](6).foreach { prod_grp ⇒\n                  target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl,\n                                                         _bv_indices(prod_grp).map(p ⇒\n                                                           Row(\n                                                             p,\n                                                             \"0\",\n                                                             \"0\",\n                                                             Array[Row](),\n                                                             \"N\",\n                                                             \"0\"\n                                                           )\n                                                         )\n                  )\n                }\n              }\n            }\n          } else {\n            for (j ← 0 until buckets.length) {\n              target_wo_alt_prdct_dtl = Array\n                .concat(target_wo_alt_prdct_dtl, _bv_indices(_bv_vector_or(buckets(j).getSeq[Array[Byte]](6).toArray)))\n                .map(p ⇒\n                  Row(\n                    p,\n                    \"0\",\n                    \"0\",\n                    Array[Row](),\n                    \"N\",\n                    \"0\"\n                  )\n                )\n            }\n          }\n        }\n      }\n    } else {\n      target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl,\n                                             _bv_indices(_bv_vector_or(target_prdcts)).map(p ⇒\n                                               Row(\n                                                 p,\n                                                 \"0\",\n                                                 \"0\",\n                                                 Array[Row](),\n                                                 \"N\",\n                                                 \"0\"\n                                               )\n                                             )\n      )\n    }\n  } else {\n    var alt_rank = 1\n    target_tar_prdcts_mapping = apply_tar(in.getSeq[Array[Byte]](7).toArray,\n                                          in.getAs[Seq[Row]](\"alt_constituent_prdcts\").toArray,\n                                          tar_prdcts,\n                                          0,\n                                          target_tar_prdcts_mapping,\n                                          \"\",\n                                          0\n    )\n\n    alt_tar_prdcts_mapping = apply_tar(Array(),\n                                       in.getAs[Seq[Row]](\"alt_constituent_prdcts\").toArray,\n                                       tar_prdcts,\n                                       1,\n                                       target_tar_prdcts_mapping,\n                                       in.getAs[String](\"shared_qual\"),\n                                       1\n    )\n\n    if (in.getAs[String](\"shared_qual\") != \"N/A\") {\n      for (a ← 0 to alt_tar_prdcts_mapping.length) {\n        alt_tar_prdcts_mapping(a).getAs[Seq[Row]](0).foreach { bucket ⇒\n          val alt_prdcts_all_prio  = tar_roa_df_alt(bucket.getAs[String](0).toInt).getSeq[Array[Byte]](2).toArray\n          var tar_roa_df_alt_cntnt = alt_prdcts_all_prio(bucket.getAs[String](1).toInt)\n\n          bucket.getSeq[Array[Byte]](6).foreach { prds ⇒\n            alt_prdcts_rank_vec =\n              Array.concat(alt_prdcts_rank_vec,\n                           Array.fill(1)(Row(alt_rank, apply_udl_sort(prds, bucket.getAs[String](\"11\")), \"\", \"\"))\n              )\n            alt_rank = alt_rank + _bv_count_one_bits(prds)\n          }\n          val target_prdcts = in.getSeq[Array[Byte]](7).toArray\n          target_prdct_dtl = Array.concat(target_prdct_dtl,\n                                          _bv_indices(target_prdcts(a)).map { prd ⇒\n                                            Row(prd, \"0\", (a + 1).toString, alt_prdcts_rank_vec, \"Y\", \"0\")\n                                          }\n          )\n          alt_prdcts_rank_vec = Array[Row]()\n          alt_rank = 1\n        }\n      }\n\n      var b             = alt_tar_prdcts_mapping.length\n      val target_prdcts = in.getSeq[Array[Byte]](7).toArray\n      while (b < target_prdcts.length) {\n        target_prdct_dtl = Array.concat(target_prdct_dtl,\n                                        _bv_indices(target_prdcts(b)).map { prd ⇒\n                                          Row(prd, \"0\", \"0\", Array(), \"N\", \"0\")\n                                        }\n        )\n        b = b + 1\n      }\n    } else {\n      alt_tar_prdcts_mapping.foreach { alt_prd ⇒\n        alt_prd.getAs[Seq[Row]](0).foreach { bucket ⇒\n          val alt_prdcts_all_prio  = tar_roa_df_alt(bucket.getAs[String](0).toInt).getSeq[Array[Byte]](2).toArray\n          var tar_roa_df_alt_cntnt = alt_prdcts_all_prio(bucket.getAs[String](1).toInt)\n          bucket.getSeq[Array[Byte]](6).foreach { prds ⇒\n            alt_prdcts_rank_vec = Array.concat(alt_prdcts_rank_vec,\n                                               Array.fill(1)(\n                                                 Row(alt_rank,\n                                                     apply_udl_sort(prds, bucket.getAs[String](\"11\")),\n                                                     bucket.getAs[String](9),\n                                                     bucket.getAs[String](10)\n                                                 )\n                                               )\n            )\n            alt_rank = alt_rank + _bv_count_one_bits(prds)\n          }\n        }\n      }\n      val target_prdcts = in.getSeq[Array[Byte]](7).toArray\n      if (alt_prdcts_rank_vec.length > 0) {\n        var udl_index = 0\n        target_prdcts.foreach { target_prd ⇒\n          udl_index = udl_index + 1\n          target_prdct_dtl = Array.concat(target_prdct_dtl,\n                                          _bv_indices(target_prd).map { prd ⇒\n                                            Row(prd, \"0\", udl_index.toString, alt_prdcts_rank_vec, \"Y\", \"0\")\n                                          }\n          )\n        }\n      } else {\n        target_prdcts.foreach { target_prd ⇒\n          target_wo_alt_prdct_dtl = Array.concat(target_wo_alt_prdct_dtl,\n                                                 _bv_indices(target_prd).map { prd ⇒\n                                                   Row(prd, \"0\", \"0\", Array(), \"N\", \"0\")\n                                                 }\n          )\n        }\n      }\n    }\n  }\n\n  Row(\n    in.getAs[String](\"tal_id\"),\n    in.getAs[String](\"tal_name\"),\n    in.getAs[String](\"shared_qual\"),\n    in.getAs[String](\"tal_assoc_name\"),\n    in.getAs[String](\"tar_udl_nm\"),\n    in.getAs[String](\"priority\"),\n    in.getAs[String](\"tal_assoc_type_cd\"),\n    target_prdct_dtl,\n    target_wo_alt_prdct_dtl,\n    in.getAs[Seq[String]](\"constituent_grp_vec\").toArray,\n    in.getAs[String](\"newline\")\n  )\n}\n\ndef apply_tar(\n  udl_prdcts:                Array[Array[Byte]],\n  alt_udl_prdcts:            Array[Row],\n  tar_prdcts:                Row,\n  is_alt:                    Int,\n  target_tar_prdcts_mapping: Array[Row],\n  shared_qualifier:          String,\n  is_override_incl:          Int\n) = {\n  var tar_prdcts_mapping = Array[Row]()\n  var _prdcts            = Array[Byte]()\n  var lv_prdcts          = Array[Byte]()\n  var left_over_prdcts   = Array[Byte]()\n  var contents           = Array[Row]()\n  var len                = 0;\n  var udl_len            = 0;\n  if (is_alt > 0) {\n    val tar_prdcts_contents = tar_prdcts.getAs[Seq[Row]](4).toArray\n    len = tar_prdcts_contents(0).getAs[Seq[Row]](1).length\n    udl_len = alt_udl_prdcts.length\n    tar_prdcts_contents.foreach { c ⇒\n      contents = Array.concat(contents, Array.fill(1)(Row(c.getAs[Seq[Row]](1).head.getSeq[Array[Byte]](0))))\n    }\n  } else {\n    val tar_prdcts_contents = tar_prdcts.getAs[Seq[Row]](4).toArray\n    len = tar_prdcts_contents(0).getSeq[Array[Byte]](0).length\n    udl_len = alt_udl_prdcts.length\n    contents = tar_prdcts_contents.slice(1, tar_prdcts_contents.length)\n  }\n\n  for (i ← 0 until udl_len) {\n    _prdcts = _bv_all_zeros()\n    tar_prdcts_mapping = Array.concat(tar_prdcts_mapping, Array.fill(1)(Row(Array())))\n    if (is_alt > 0) {\n      if (shared_qualifier == \"N/A\") {\n        var udl_prdts = alt_udl_prdcts(i).getAs[Array[Byte]](0)\n        for (p ← target_tar_prdcts_mapping.indices) {\n          val tar_prdcts_contents = tar_prdcts.getAs[Seq[Row]](4).toArray\n          val alt_contents        = tar_prdcts_contents(0).getAs[Seq[Row]](1).toArray\n          target_tar_prdcts_mapping(p).getAs[Seq[Int]](1).foreach { idx ⇒\n            if (is_override_incl > 0) {\n              _prdcts = _bv_and(udl_prdts,          alt_contents(idx).getAs[Array[Byte]](2));\n              udl_prdts = _bv_difference(udl_prdts, _prdcts)\n            } else {\n              _prdcts = _bv_and(alt_udl_prdcts(i).getAs[Array[Byte]](0), alt_contents(idx).getAs[Array[Byte]](2))\n            }\n\n            if (_bv_count_one_bits(_prdcts) > 0) {\n              var alt_prds = alt_contents(idx).getSeq[Array[Byte]](0).toArray\n              var alt_len  = alt_prds.length\n              val loop     = new Breaks\n              loop.breakable {\n                for (n ← 0 until alt_len) {\n                  lv_prdcts = _bv_and(_prdcts, alt_prds(n))\n                  if (_bv_count_one_bits(lv_prdcts) > 0) {\n                    tar_prdcts_mapping(i) = updateIndexInRow(\n                      tar_prdcts_mapping(i),\n                      1,\n                      Array.concat(tar_prdcts_mapping(i).getAs[Seq[Int]](1).toArray, Array.fill(1)(idx))\n                    )\n                    tar_prdcts_mapping(i) = updateIndexInRow(\n                      tar_prdcts_mapping(i),\n                      0,\n                      Array.concat(\n                        tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n                        Array.fill(1)(\n                          Row(\n                            idx,\n                            n,\n                            i,\n                            lv_prdcts,\n                            _bv_all_zeros(),\n                            _bv_all_zeros(),\n                            Array[Array[Byte]](),\n                            Row(_bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]]()\n                            ),\n                            Row(_bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]](),\n                                _bv_all_zeros(),\n                                Array[Array[Byte]]()\n                            ),\n                            alt_udl_prdcts(i).getAs[String](1),\n                            alt_udl_prdcts(i).getAs[String](2),\n                            alt_udl_prdcts(i).getAs[String](3)\n                          )\n                        )\n                      )\n                    )\n\n                    _prdcts = _bv_difference(_prdcts, lv_prdcts)\n                    if (_bv_count_one_bits(_prdcts) == 0) {\n                      loop.break()\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n        if (is_override_incl > 0 && _bv_count_one_bits(udl_prdts) > 0) {\n          tar_prdcts_mapping(i) = updateIndexInRow(\n            tar_prdcts_mapping(i),\n            0,\n            Array.concat(\n              tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n              Array.fill(1)(\n                Row(\n                  tar_prdcts_mapping(i).getAs[Seq[Row]](1).length,\n                  0,\n                  i,\n                  lv_prdcts,\n                  _bv_all_zeros(),\n                  _bv_all_zeros(),\n                  Array[Array[Byte]](),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  alt_udl_prdcts(i).getAs[String](1),\n                  alt_udl_prdcts(i).getAs[String](2),\n                  alt_udl_prdcts(i).getAs[String](3)\n                )\n              )\n            )\n          )\n        }\n      } else {\n        var udl_prdts = alt_udl_prdcts(i).getAs[Array[Byte]](0)\n        target_tar_prdcts_mapping(i).getAs[Seq[Int]](1).foreach { idx ⇒\n          val tar_prdcts_contents = tar_prdcts.getAs[Seq[Row]](4).toArray\n          val alt_contents        = tar_prdcts_contents(0).getAs[Seq[Row]](1).toArray\n          if (is_override_incl > 0) {\n            _prdcts = _bv_and(udl_prdts,          alt_contents(idx).getAs[Array[Byte]](2));\n            udl_prdts = _bv_difference(udl_prdts, _prdcts)\n          } else {\n            _prdcts = _bv_and(alt_udl_prdcts(i).getAs[Array[Byte]](0), alt_contents(idx).getAs[Array[Byte]](2))\n          }\n\n          if (_bv_count_one_bits(_prdcts) > 0) {\n            var alt_prds = alt_contents(idx).getSeq[Array[Byte]](0).toArray\n            var alt_len  = alt_prds.length\n            val loop     = new Breaks\n            loop.breakable {\n              for (n ← 0 until alt_len) {\n                lv_prdcts = _bv_and(_prdcts, alt_prds(n))\n                if (_bv_count_one_bits(lv_prdcts) > 0) {\n                  tar_prdcts_mapping(i) =\n                    updateIndexInRow(tar_prdcts_mapping(i),\n                                     1,\n                                     Array.concat(tar_prdcts_mapping(i).getAs[Seq[Int]](1).toArray, Array.fill(1)(idx))\n                    )\n                  tar_prdcts_mapping(i) = updateIndexInRow(\n                    tar_prdcts_mapping(i),\n                    0,\n                    Array.concat(\n                      tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n                      Array.fill(1)(\n                        Row(\n                          idx,\n                          n,\n                          i,\n                          lv_prdcts,\n                          _bv_all_zeros(),\n                          _bv_all_zeros(),\n                          Array[Array[Byte]](),\n                          Row(_bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]]()\n                          ),\n                          Row(_bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]](),\n                              _bv_all_zeros(),\n                              Array[Array[Byte]]()\n                          ),\n                          alt_udl_prdcts(i).getAs[String](1),\n                          alt_udl_prdcts(i).getAs[String](2),\n                          alt_udl_prdcts(i).getAs[String](3)\n                        )\n                      )\n                    )\n                  )\n\n                  _prdcts = _bv_difference(_prdcts, lv_prdcts)\n                  if (_bv_count_one_bits(_prdcts) == 0) {\n                    loop.break()\n                  }\n                }\n              }\n            }\n          }\n        }\n        if (is_override_incl > 0 && _bv_count_one_bits(udl_prdts) > 0) {\n          tar_prdcts_mapping(i) = updateIndexInRow(\n            tar_prdcts_mapping(i),\n            0,\n            Array.concat(\n              tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n              Array.fill(1)(\n                Row(\n                  tar_prdcts_mapping(i).getAs[Seq[Row]](1).length,\n                  0,\n                  i,\n                  lv_prdcts,\n                  _bv_all_zeros(),\n                  _bv_all_zeros(),\n                  Array[Array[Byte]](),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  alt_udl_prdcts(i).getAs[String](1),\n                  alt_udl_prdcts(i).getAs[String](2),\n                  alt_udl_prdcts(i).getAs[String](3)\n                )\n              )\n            )\n          )\n        }\n      }\n    } else {\n      _prdcts = udl_prdcts(i)\n      val loop = new Breaks\n      loop.breakable {\n        for (m ← 0 until len) {\n          val tar_prdcts_contents = tar_prdcts.getAs[Seq[Row]](4).toArray\n          val target_prdcts       = tar_prdcts_contents(0).getSeq[Array[Byte]](0).toArray\n          lv_prdcts = _bv_and(_prdcts, target_prdcts(m))\n          if (_bv_count_one_bits(lv_prdcts) > 0) {\n            tar_prdcts_mapping(i) =\n              updateIndexInRow(tar_prdcts_mapping(i),\n                               1,\n                               Array.concat(tar_prdcts_mapping(i).getAs[Seq[Int]](1).toArray, Array.fill(1)(m))\n              )\n            tar_prdcts_mapping(i) = updateIndexInRow(\n              tar_prdcts_mapping(i),\n              0,\n              Array.concat(\n                tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n                Array.fill(1)(\n                  Row(\n                    m,\n                    0,\n                    i,\n                    lv_prdcts,\n                    _bv_all_zeros(),\n                    _bv_all_zeros(),\n                    Array[Array[Byte]](),\n                    Row(_bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]]()\n                    ),\n                    Row(_bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]](),\n                        _bv_all_zeros(),\n                        Array[Array[Byte]]()\n                    ),\n                    \"\",\n                    \"\",\n                    \"\"\n                  )\n                )\n              )\n            )\n\n            _prdcts = _bv_difference(_prdcts, lv_prdcts)\n            if (_bv_count_one_bits(_prdcts) == 0) {\n              loop.break()\n            }\n          }\n        }\n        if (_bv_count_one_bits(_prdcts) > 0)\n          left_over_prdcts = _prdcts\n        _prdcts =\n          if (_bv_count_one_bits(contents(0).getSeq[Array[Byte]](0).head) > 0)\n            _bv_and(left_over_prdcts, contents(0).getSeq[Array[Byte]](0).head)\n          else left_over_prdcts;\n\n        if (_bv_count_one_bits(left_over_prdcts) > 0) {\n          tar_prdcts_mapping(i) = updateIndexInRow(\n            tar_prdcts_mapping(i),\n            0,\n            Array.concat(\n              tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray,\n              Array.fill(1)(\n                Row(\n                  len,\n                  0,\n                  i,\n                  lv_prdcts,\n                  _bv_all_zeros(),\n                  _bv_all_zeros(),\n                  Array[Array[Byte]](),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  Row(_bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]](),\n                      _bv_all_zeros(),\n                      Array[Array[Byte]]()\n                  ),\n                  \"\",\n                  \"\",\n                  \"\"\n                )\n              )\n            )\n          )\n        }\n      }\n    }\n    val buckets = tar_prdcts_mapping(i).getAs[Seq[Row]](0).toArray\n    for (k ← 0 until tar_prdcts_mapping(i).getAs[Seq[Row]](0).length) {\n      for (j ← 0 until contents.length) {\n        val target_prdcts = contents(j).getSeq[Array[Byte]](0).head\n        if (_bv_count_one_bits(target_prdcts) > 0) {\n          if (\n            _bv_count_one_bits(buckets(k).getAs[Array[Byte]](4)) == 0 || _bv_count_one_bits(\n              buckets(k).getAs[Array[Byte]](5)\n            ) > 0\n          ) {\n            buckets(k) = updateIndexInRow(buckets(k), 4, _bv_and(buckets(k).getAs[Array[Byte]](3), target_prdcts))\n            buckets(k) = updateIndexInRow(\n              buckets(k),\n              5,\n              _bv_difference(buckets(k).getAs[Array[Byte]](3), buckets(k).getAs[Array[Byte]](4))\n            )\n          } else if (\n            !(_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](0)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](4)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](0)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](4)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](2)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](6)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](2)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](6)) > 0)\n          ) {\n            if (\n              _bv_count_one_bits(buckets(k).getAs[Array[Byte]](4)) > 0 && !(_bv_count_one_bits(\n                buckets(k).getAs[Row](7).getAs[Array[Byte]](2)\n              ) > 0\n                && _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](6)) > 0) &&\n              !(buckets(k).getAs[Row](7).getSeq[Array[Byte]](1).nonEmpty || buckets(k)\n                .getAs[Row](7)\n                .getSeq[Array[Byte]](3)\n                .nonEmpty || buckets(k).getAs[Row](7).getSeq[Array[Byte]](5).nonEmpty || buckets(k)\n                .getAs[Row](7)\n                .getSeq[Array[Byte]](7)\n                .nonEmpty)\n            ) {\n              var sorted_prdcts = buckets(k).getAs[Row](7)\n              sorted_prdcts =\n                updateIndexInRow(sorted_prdcts, 2, _bv_and(buckets(k).getAs[Array[Byte]](4), target_prdcts))\n              sorted_prdcts = updateIndexInRow(\n                sorted_prdcts,\n                6,\n                _bv_difference(buckets(k).getAs[Array[Byte]](4), sorted_prdcts.getAs[Array[Byte]](2))\n              )\n              buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n            }\n\n            if (\n              _bv_count_one_bits(buckets(k).getAs[Array[Byte]](5)) > 0 && !(_bv_count_one_bits(\n                buckets(k).getAs[Row](8).getAs[Array[Byte]](2)\n              ) > 0\n                && _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](6)) > 0) &&\n              !(buckets(k).getAs[Row](8).getSeq[Array[Byte]](1).nonEmpty || buckets(k)\n                .getAs[Row](8)\n                .getSeq[Array[Byte]](3)\n                .nonEmpty || buckets(k).getAs[Row](8).getSeq[Array[Byte]](5).nonEmpty || buckets(k)\n                .getAs[Row](8)\n                .getSeq[Array[Byte]](7)\n                .nonEmpty)\n            ) {\n              var unsorted_prdcts = buckets(k).getAs[Row](8)\n              unsorted_prdcts =\n                updateIndexInRow(unsorted_prdcts, 2, _bv_and(buckets(k).getAs[Array[Byte]](5), target_prdcts))\n              unsorted_prdcts = updateIndexInRow(\n                unsorted_prdcts,\n                6,\n                _bv_difference(buckets(k).getAs[Array[Byte]](5), unsorted_prdcts.getAs[Array[Byte]](2))\n              )\n              buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n            }\n          } else if (\n            !(_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](0)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](4)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](0)) > 0\n              || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](4)) > 0)\n          ) {\n\n            if (\n              (_bv_count_one_bits(\n                buckets(k).getAs[Row](7).getAs[Array[Byte]](2)\n              ) > 0\n                || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](6)) > 0) && !(_bv_count_one_bits(\n                buckets(k).getAs[Row](7).getAs[Array[Byte]](0)\n              ) > 0\n                || _bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](4)) > 0)\n            ) {\n              var sorted_prdcts = buckets(k).getAs[Row](7)\n              sorted_prdcts =\n                updateIndexInRow(sorted_prdcts, 0, _bv_and(buckets(k).getAs[Array[Byte]](2), target_prdcts))\n              sorted_prdcts = updateIndexInRow(\n                sorted_prdcts,\n                2,\n                _bv_difference(buckets(k).getAs[Array[Byte]](2), sorted_prdcts.getAs[Array[Byte]](0))\n              )\n              sorted_prdcts =\n                updateIndexInRow(sorted_prdcts, 4, _bv_and(buckets(k).getAs[Array[Byte]](6), target_prdcts))\n              sorted_prdcts = updateIndexInRow(\n                sorted_prdcts,\n                6,\n                _bv_difference(buckets(k).getAs[Array[Byte]](6), sorted_prdcts.getAs[Array[Byte]](4))\n              )\n              buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n            }\n\n            if (\n              (_bv_count_one_bits(\n                buckets(k).getAs[Row](8).getAs[Array[Byte]](2)\n              ) > 0\n                || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](6)) > 0) && !(_bv_count_one_bits(\n                buckets(k).getAs[Row](8).getAs[Array[Byte]](0)\n              ) > 0\n                || _bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](4)) > 0)\n            ) {\n              var unsorted_prdcts = buckets(k).getAs[Row](8)\n              unsorted_prdcts =\n                updateIndexInRow(unsorted_prdcts, 0, _bv_and(buckets(k).getAs[Array[Byte]](2), target_prdcts))\n              unsorted_prdcts = updateIndexInRow(\n                unsorted_prdcts,\n                2,\n                _bv_difference(buckets(k).getAs[Array[Byte]](2), unsorted_prdcts.getAs[Array[Byte]](0))\n              )\n              unsorted_prdcts =\n                updateIndexInRow(unsorted_prdcts, 4, _bv_and(buckets(k).getAs[Array[Byte]](6), target_prdcts))\n              unsorted_prdcts = updateIndexInRow(\n                unsorted_prdcts,\n                6,\n                _bv_difference(buckets(k).getAs[Array[Byte]](6), unsorted_prdcts.getAs[Array[Byte]](4))\n              )\n              buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n            }\n\n          } else {\n            if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](0)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](7).getAs[Array[Byte]](0), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var sorted_prdcts = buckets(k).getAs[Row](7)\n                sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                                 1,\n                                                 Array.concat(sorted_prdcts.getSeq[Array[Byte]](1).toArray, _prdcts)\n                )\n                sorted_prdcts =\n                  updateIndexInRow(sorted_prdcts,         0, _bv_difference(sorted_prdcts.getAs[Seq[Byte]](0).toArray, _prdcts))\n                buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](2)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](7).getAs[Array[Byte]](2), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var sorted_prdcts = buckets(k).getAs[Row](7)\n                sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                                 3,\n                                                 Array.concat(sorted_prdcts.getSeq[Array[Byte]](3).toArray, _prdcts)\n                )\n                sorted_prdcts =\n                  updateIndexInRow(sorted_prdcts,         2, _bv_difference(sorted_prdcts.getAs[Seq[Byte]](2).toArray, _prdcts))\n                buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](4)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](7).getAs[Array[Byte]](4), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var sorted_prdcts = buckets(k).getAs[Row](7)\n                sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                                 5,\n                                                 Array.concat(sorted_prdcts.getSeq[Array[Byte]](5).toArray, _prdcts)\n                )\n                sorted_prdcts =\n                  updateIndexInRow(sorted_prdcts,         4, _bv_difference(sorted_prdcts.getAs[Seq[Byte]](4).toArray, _prdcts))\n                buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](6)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](7).getAs[Array[Byte]](6), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var sorted_prdcts = buckets(k).getAs[Row](7)\n                sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                                 7,\n                                                 Array.concat(sorted_prdcts.getSeq[Array[Byte]](7).toArray, _prdcts)\n                )\n                sorted_prdcts =\n                  updateIndexInRow(sorted_prdcts,         6, _bv_difference(sorted_prdcts.getAs[Seq[Byte]](6).toArray, _prdcts))\n                buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            ///\n            if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](0)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](8).getAs[Array[Byte]](0), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var unsorted_prdcts = buckets(k).getAs[Row](8)\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   1,\n                                                   Array.concat(unsorted_prdcts.getSeq[Array[Byte]](1).toArray, _prdcts)\n                )\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   0,\n                                                   _bv_difference(unsorted_prdcts.getAs[Seq[Byte]](0).toArray, _prdcts)\n                )\n                buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](2)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](8).getAs[Array[Byte]](2), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var unsorted_prdcts = buckets(k).getAs[Row](8)\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   3,\n                                                   Array.concat(unsorted_prdcts.getSeq[Array[Byte]](3).toArray, _prdcts)\n                )\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   2,\n                                                   _bv_difference(unsorted_prdcts.getAs[Seq[Byte]](2).toArray, _prdcts)\n                )\n                buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](4)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](8).getAs[Array[Byte]](4), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var unsorted_prdcts = buckets(k).getAs[Row](8)\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   5,\n                                                   Array.concat(unsorted_prdcts.getSeq[Array[Byte]](5).toArray, _prdcts)\n                )\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   4,\n                                                   _bv_difference(unsorted_prdcts.getAs[Seq[Byte]](4).toArray, _prdcts)\n                )\n                buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n\n            if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](6)) > 0) {\n              _prdcts = _bv_and(buckets(k).getAs[Row](8).getAs[Array[Byte]](6), target_prdcts)\n              if (_bv_count_one_bits(_prdcts) > 0) {\n                var unsorted_prdcts = buckets(k).getAs[Row](8)\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   7,\n                                                   Array.concat(unsorted_prdcts.getSeq[Array[Byte]](7).toArray, _prdcts)\n                )\n                unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                                   6,\n                                                   _bv_difference(unsorted_prdcts.getAs[Seq[Byte]](6).toArray, _prdcts)\n                )\n                buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n                _prdcts = _bv_all_zeros()\n              }\n            }\n          }\n        }\n      }\n      if (_bv_count_one_bits(buckets(k).getAs[Array[Byte]](4)) > 0) {\n        var sorted_prdcts = buckets(k).getAs[Row](7)\n        if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](0)) > 0) {\n          sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                           1,\n                                           Array.concat(sorted_prdcts.getAs[Seq[Byte]](1).toArray,\n                                                        Array.fill(1)(buckets(k).getAs[Row](7).getAs[Array[Byte]](0))\n                                           )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](2)) > 0) {\n          sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                           3,\n                                           Array.concat(sorted_prdcts.getAs[Seq[Byte]](3).toArray,\n                                                        Array.fill(1)(buckets(k).getAs[Row](7).getAs[Array[Byte]](2))\n                                           )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](4)) > 0) {\n          sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                           5,\n                                           Array.concat(sorted_prdcts.getAs[Seq[Byte]](5).toArray,\n                                                        Array.fill(1)(buckets(k).getAs[Row](7).getAs[Array[Byte]](4))\n                                           )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](7).getAs[Array[Byte]](6)) > 0) {\n          sorted_prdcts = updateIndexInRow(sorted_prdcts,\n                                           7,\n                                           Array.concat(sorted_prdcts.getAs[Seq[Byte]](7).toArray,\n                                                        Array.fill(1)(buckets(k).getAs[Row](7).getAs[Array[Byte]](6))\n                                           )\n          )\n        }\n        buckets(k) = updateIndexInRow(buckets(k), 7, sorted_prdcts)\n        buckets(k) = updateIndexInRow(\n          buckets(k),\n          6,\n          Array.concat(\n            sorted_prdcts.getSeq[Array[Byte]](6).toArray,\n            sorted_prdcts.getAs[Seq[Byte]](1).toArray,\n            sorted_prdcts.getAs[Seq[Byte]](3).toArray,\n            sorted_prdcts.getAs[Seq[Byte]](5).toArray,\n            sorted_prdcts.getAs[Seq[Byte]](7).toArray\n          )\n        )\n\n        if (\n          sorted_prdcts.getAs[Seq[Byte]](1).isEmpty && sorted_prdcts.getAs[Seq[Byte]](3).isEmpty && sorted_prdcts\n            .getAs[Seq[Byte]](5)\n            .isEmpty && sorted_prdcts.getAs[Seq[Byte]](7).isEmpty\n        ) {\n          buckets(k) = updateIndexInRow(\n            buckets(k),\n            6,\n            Array.concat(sorted_prdcts.getSeq[Array[Byte]](6).toArray, Array.fill(1)(buckets(k).getAs[Array[Byte]](4)))\n          )\n        }\n      }\n\n      if (_bv_count_one_bits(buckets(k).getAs[Array[Byte]](5)) > 0) {\n        var unsorted_prdcts = buckets(k).getAs[Row](8)\n        if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](0)) > 0) {\n          unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                             1,\n                                             Array.concat(unsorted_prdcts.getAs[Seq[Byte]](1).toArray,\n                                                          Array.fill(1)(buckets(k).getAs[Row](8).getAs[Array[Byte]](0))\n                                             )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](2)) > 0) {\n          unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                             3,\n                                             Array.concat(unsorted_prdcts.getAs[Seq[Byte]](3).toArray,\n                                                          Array.fill(1)(buckets(k).getAs[Row](8).getAs[Array[Byte]](2))\n                                             )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](4)) > 0) {\n          unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                             5,\n                                             Array.concat(unsorted_prdcts.getAs[Seq[Byte]](5).toArray,\n                                                          Array.fill(1)(buckets(k).getAs[Row](8).getAs[Array[Byte]](4))\n                                             )\n          )\n        }\n        if (_bv_count_one_bits(buckets(k).getAs[Row](8).getAs[Array[Byte]](6)) > 0) {\n          unsorted_prdcts = updateIndexInRow(unsorted_prdcts,\n                                             7,\n                                             Array.concat(unsorted_prdcts.getAs[Seq[Byte]](7).toArray,\n                                                          Array.fill(1)(buckets(k).getAs[Row](8).getAs[Array[Byte]](6))\n                                             )\n          )\n        }\n        buckets(k) = updateIndexInRow(buckets(k), 8, unsorted_prdcts)\n        buckets(k) = updateIndexInRow(\n          buckets(k),\n          6,\n          Array.concat(\n            unsorted_prdcts.getSeq[Array[Byte]](6).toArray,\n            unsorted_prdcts.getAs[Seq[Byte]](1).toArray,\n            unsorted_prdcts.getAs[Seq[Byte]](3).toArray,\n            unsorted_prdcts.getAs[Seq[Byte]](5).toArray,\n            unsorted_prdcts.getAs[Seq[Byte]](7).toArray\n          )\n        )\n\n        if (\n          unsorted_prdcts.getAs[Seq[Byte]](1).isEmpty && unsorted_prdcts.getAs[Seq[Byte]](3).isEmpty && unsorted_prdcts\n            .getAs[Seq[Byte]](5)\n            .isEmpty && unsorted_prdcts.getAs[Seq[Byte]](7).isEmpty\n        ) {\n          buckets(k) = updateIndexInRow(buckets(k),\n                                        6,\n                                        Array.concat(unsorted_prdcts.getSeq[Array[Byte]](6).toArray,\n                                                     Array.fill(1)(buckets(k).getAs[Array[Byte]](5))\n                                        )\n          )\n        }\n      }\n\n      if (\n        _bv_count_one_bits(buckets(k).getAs[Array[Byte]](4)) == 0 && _bv_count_one_bits(\n          buckets(k).getAs[Array[Byte]](5)\n        ) == 0\n      ) {\n        buckets(k) = updateIndexInRow(buckets(k), 6, buckets(k).getAs[Array[Byte]](3))\n      }\n\n    }\n    tar_prdcts_mapping(i) = updateIndexInRow(tar_prdcts_mapping(i), 0, buckets)\n  }\n  tar_prdcts_mapping\n}\n\ndef gpi14_sorting(\n  dl_bits:              Array[Int],\n  gpi14_container:      Array[Int],\n  alt_rank:             Int,\n  in_constituent_group: String,\n  in_constituent_reqd:  String,\n  udl_nm:               String\n) = {\n  var gpi14_matching_dl_bits     = Array[Int]()\n  var gpi14_non_matching_dl_bits = Array[Int]()\n  var lv_dl_bit                  = 0\n  var alt_rank_vec               = Array[Row]()\n  var len                        = 0\n  var lv_alt_rank                = alt_rank\n\n  gpi14_matching_dl_bits = dl_bits.intersect(gpi14_container)\n  dl_bits.foreach { _dlbit ⇒\n    if (!gpi14_matching_dl_bits.contains(_dlbit)) {\n      gpi14_non_matching_dl_bits = Array.concat(gpi14_non_matching_dl_bits, Array.fill(1)(_dlbit))\n    }\n  }\n  len = gpi14_matching_dl_bits.length\n  if (len > 0) {\n    alt_rank_vec = Array.concat(\n      alt_rank_vec,\n      Array.fill(1)(Row(lv_alt_rank, gpi14_matching_dl_bits, in_constituent_group, in_constituent_reqd, udl_nm))\n    )\n    lv_alt_rank = lv_alt_rank + len\n  }\n  len = gpi14_non_matching_dl_bits.length\n  if (len > 0) {\n    alt_rank_vec = Array.concat(\n      alt_rank_vec,\n      Array.fill(1)(Row(lv_alt_rank, gpi14_non_matching_dl_bits, in_constituent_group, in_constituent_reqd, udl_nm))\n    )\n    lv_alt_rank = lv_alt_rank + len\n  }\n  alt_rank_vec\n}\n\ndef apply_gpi14_sorting(\n  target_dl_bits:            Array[Int],\n  bucket_index:              Int,\n  udl_index:                 Int,\n  products:                  Array[Byte],\n  alt_bucket_vec:            Array[Row],\n  tac_contents:              Row,\n  tar_roa_df_alt:            Array[Row],\n  steptal_inp:               Array[Row],\n  tar_udl_nm:                String,\n  final_sorted_prdcts_step1: Array[Array[Byte]]\n) = {\n  var unsorted_target_prdct_dtl = Array[Row]()\n  var alt_rank_vec              = Array[Row]()\n  var lv_alt_rank_vec           = Array[Row]()\n  var alt_dl_bits               = Array[Int]()\n  var lv_target_dl_bits         = Array[Int]()\n  var lv_gpi14_dl_bits          = Array[Int]()\n  var lv_target_dl_bits1        = Array[Int]()\n  var lv_target_prdcts          = _bv_all_zeros()\n  var lv_target_prdcts_sec      = _bv_all_zeros()\n  var tac_target_dl_bits        = Array[Int]()\n  var lv_tac_target_dl_bits     = Array[Int]()\n\n  var tar_idx               = 0\n  var alt_idx               = 0;\n  var tar_roa_df_alt_cntnt  = Array[Array[Byte]]()\n  var tar_roa_df_alt_cntnt1 = Array[Array[Byte]]()\n  var tar_roa_df_alt_cntnt2 = Array[Array[Byte]]()\n  var lv_udl_index          = BigDecimal(0);\n  var udl_prdct_count       = BigDecimal(0);\n  var _gpi14                = \"\";\n  var unmatching_udl_prd    = _bv_all_zeros()\n  var tac_index             = 0;\n  var target_tac_index      = Array[Int]()\n  var in_tar_vec            = Array[Array[Byte]]()\n  var tar_bits              = Array[Int]()\n  var final_sorted_prdcts1  = Array[Array[Byte]]()\n  var final_sorted_prdcts2  = Array[Array[Byte]]()\n  var st_len                = 0;\n  var len_now               = 0;\n  var len_alt               = 0;\n  var length_overlapping    = 0;\n  var alt_idx1              = 0;\n  var alt_idx2              = Array[Int]()\n\n  target_dl_bits.foreach { dl_bit ⇒\n    var wc = 0\n    if (!lv_target_dl_bits.contains(dl_bit)) {\n      var alt_rank           = 1\n      var tac_idx            = -1\n      var idx                = -1\n      var idx_ord            = -1;\n      var first_hit_priority = 0\n      target_tac_index = Array[Int]()\n      lv_target_prdcts_sec = _bv_all_zeros()\n      final_sorted_prdcts1 = Array[Array[Byte]]()\n      final_sorted_prdcts2 = Array[Array[Byte]]()\n      len_now = alt_bucket_vec.length\n      st_len = steptal_inp.length\n      length_overlapping = final_sorted_prdcts_step1.length\n      tar_bits = Array[Int]()\n      _gpi14 = prod_dtl(dl_bit).getAs[String](2)\n      lv_target_prdcts = _bv_and(rule_prod_dtl(\"GPI14\", \"eq\", _gpi14).getAs[Array[Byte]](3), products)\n      val loop = new Breaks\n      loop.breakable {\n        tac_contents.getAs[Seq[Row]](2).foreach { rec ⇒\n          var lv_target_prdcts1 = _bv_and(lv_target_prdcts, rec.getAs[Array[Byte]](0))\n          target_tac_index = Array[Int]()\n          lv_target_prdcts_sec = _bv_all_zeros()\n          lv_tac_target_dl_bits = _bv_indices(lv_target_prdcts1)\n          tac_idx = tac_idx + 1\n          if (lv_tac_target_dl_bits.length > 0) {\n            target_tac_index = Array.concat(target_tac_index, Array.fill(1)(tac_idx))\n            first_hit_priority = rec.getAs[String](2).toInt\n\n            var i        = tac_idx + 1\n            val contents = tac_contents.getAs[Seq[Row]](2).toArray\n            while (i < contents.length && first_hit_priority == contents(i).getAs[String](2).toInt) {\n              lv_target_prdcts_sec = _bv_and(lv_target_prdcts1, contents(i).getAs[Array[Byte]](0))\n              if (_bv_count_one_bits(lv_target_prdcts_sec) > 0)\n                target_tac_index = Array.concat(target_tac_index, Array.fill(1)(i))\n              i = i + 1\n            }\n\n            alt_bucket_vec.foreach { bucket1 ⇒\n              tar_idx = bucket1.getAs[String](0).toInt\n              alt_idx = bucket1.getAs[String](1).toInt\n              val alt_prdcts_all_prio = tar_roa_df_alt(tar_idx).getAs[Seq[Seq[Array[Byte]]]](1).toArray.map(_.toArray)\n              tar_roa_df_alt_cntnt = alt_prdcts_all_prio(alt_idx)\n\n              unmatching_udl_prd = _bv_all_zeros()\n              if (\n                _bv_count_one_bits(bucket1.getAs[Array[Byte]](4)) > 0 ||\n                _bv_count_one_bits(bucket1.getAs[Array[Byte]](5)) > 0 ||\n                _bv_count_one_bits(bucket1.getAs[Array[Byte]](3)) > 0\n              ) {\n                bucket1.getSeq[Array[Byte]](6).foreach { alt_prds ⇒\n                  unmatching_udl_prd = _bv_all_zeros()\n                  target_tac_index.foreach { alt_tac_idx ⇒\n                    val contents = tac_contents.getAs[Seq[Row]](2).toArray\n                    unmatching_udl_prd =\n                      _bv_or(unmatching_udl_prd, _bv_and(alt_prds, contents(alt_tac_idx).getAs[Array[Byte]](1)))\n                  }\n\n                  alt_dl_bits = apply_udl_sort(unmatching_udl_prd, bucket1.getAs[String](11))\n\n                  if (alt_dl_bits.nonEmpty) {\n                    lv_alt_rank_vec =\n                      if (alt_dl_bits.length > 1)\n                        gpi14_sorting(alt_dl_bits,\n                                      lv_gpi14_dl_bits,\n                                      alt_rank,\n                                      bucket1.getAs[String](9),\n                                      bucket1.getAs[String](10),\n                                      bucket1.getAs[String](11)\n                        )\n                      else\n                        Array.fill(1)(\n                          Row(alt_rank,\n                              alt_dl_bits,\n                              bucket1.getAs[String](9),\n                              bucket1.getAs[String](10),\n                              bucket1.getAs[String](11)\n                          )\n                        )\n\n                    alt_rank_vec = Array.concat(alt_rank_vec, lv_alt_rank_vec)\n                    udl_prdct_count = udl_prdct_count + alt_dl_bits.length\n                    alt_rank =\n                      if (lv_udl_index != BigDecimal(bucket1.getAs[String](3))) udl_prdct_count.toInt + 1\n                      else alt_rank + alt_dl_bits.length\n                    lv_udl_index = BigDecimal(bucket1.getAs[String](3))\n                  }\n                }\n              }\n              len_now = len_alt - 1\n            }\n            udl_prdct_count = 0\n            if (alt_rank_vec.nonEmpty) {\n              tac_index = tac_index + 1\n              lv_tac_target_dl_bits.foreach { p ⇒\n                unsorted_target_prdct_dtl = Array.concat(\n                  unsorted_target_prdct_dtl,\n                  Array.fill(1)(\n                    Row(p,\n                        BigDecimal(bucket_index),\n                        BigDecimal(udl_index),\n                        BigDecimal(tac_index),\n                        alt_rank_vec,\n                        \"Y\",\n                        rec.getAs[String](3)\n                    )\n                  )\n                )\n              }\n              alt_rank_vec = Array[Row]()\n              lv_target_dl_bits = Array.concat(lv_target_dl_bits, lv_tac_target_dl_bits)\n              lv_target_prdcts = _bv_difference(lv_target_prdcts, lv_target_prdcts1)\n              if (_bv_count_one_bits(lv_target_prdcts) == 0) {\n                loop.break()\n              }\n            }\n          }\n        }\n      }\n      lv_target_dl_bits1 = _bv_indices(lv_target_prdcts)\n      lv_target_dl_bits1.foreach { p ⇒\n        unsorted_target_prdct_dtl = Array.concat(\n          unsorted_target_prdct_dtl,\n          Array.fill(1)(Row(p, BigDecimal(0), BigDecimal(0), BigDecimal(0), Array[Row](), \"N\", BigDecimal(0)))\n        )\n      }\n      lv_target_dl_bits = Array.concat(lv_target_dl_bits, lv_target_dl_bits1)\n      lv_target_dl_bits1 = Array[Int]()\n    }\n  }\n  unsorted_target_prdct_dtl\n}\n\ndef apply_udl_sort(unmatching_udl_prd: Array[Byte], udl_nm: String) = {\n\n  var matching_udl_prd      = Array[Byte]()\n  var lv_unmatching_udl_prd = Array[Byte]()\n  var _roa_df_match         = Array[Byte]()\n  var lv_alt_dl_bits        = Array[Int]()\n  var alt_udl_content_lkp   = Array[Array[Byte]]()\n  var roa_df_alt_dtl        = Array[Array[Byte]]()\n  var udl_rule_prd          = Array[Row]()\n\n  var lv_udl_nm = _ltrim(udl_nm)\n\n  if ((lv_udl_nm == \"N/A\")) {\n    _roa_df_match = unmatching_udl_prd;\n    val loop = new Breaks\n    loop.breakable {\n      roa_df_alt_dtl.foreach { k ⇒\n        udl_rule_prd = Array[Row]()\n        lv_unmatching_udl_prd = _bv_and(_roa_df_match, k)\n        _roa_df_match = _bv_difference(_roa_df_match,  lv_unmatching_udl_prd)\n        if (_bv_count_one_bits(lv_unmatching_udl_prd) > 0) {\n          _bv_indices(lv_unmatching_udl_prd).foreach { p ⇒\n            udl_rule_prd = Array.concat(udl_rule_prd, Array.fill(1)(Row(p, prod_dtl(p).getAs[String](2))))\n          }\n          udl_rule_prd = udl_rule_prd.sortBy(_.getAs[String](1))\n          lv_alt_dl_bits = Array.concat(lv_alt_dl_bits, udl_rule_prd.map(_.getAs[Int](0)))\n        }\n        if (_bv_count_one_bits(_roa_df_match) == 0) {\n          loop.break()\n        }\n      }\n    }\n  } else {\n    alt_udl_content_lkp =\n      Expanded_UDL_wt_rl_priority.get(lv_udl_nm).map(_.getSeq[Array[Byte]](6).toArray).getOrElse(Array[Array[Byte]]())\n    _roa_df_match = unmatching_udl_prd\n    val loop = new Breaks\n    loop.breakable {\n      roa_df_alt_dtl.foreach { k ⇒\n        lv_unmatching_udl_prd = _bv_and(_roa_df_match, k)\n        _roa_df_match = _bv_difference(_roa_df_match,  lv_unmatching_udl_prd)\n\n        val innerLoop = new Breaks\n        innerLoop.breakable {\n          alt_udl_content_lkp.foreach { c ⇒\n            udl_rule_prd = Array[Row]()\n            matching_udl_prd = _bv_and(lv_unmatching_udl_prd,             c)\n            lv_unmatching_udl_prd = _bv_difference(lv_unmatching_udl_prd, matching_udl_prd)\n            if (_bv_count_one_bits(matching_udl_prd) > 0) {\n              _bv_indices(matching_udl_prd).foreach { p ⇒\n                udl_rule_prd = Array.concat(udl_rule_prd, Array.fill(1)(Row(p, prod_dtl(p).getAs[String](2))))\n              }\n              udl_rule_prd = udl_rule_prd.sortBy(_.getAs[String](1))\n              lv_alt_dl_bits = Array.concat(lv_alt_dl_bits, udl_rule_prd.map(_.getAs[Int](0)))\n            }\n            if (_bv_count_one_bits(lv_unmatching_udl_prd) == 0) {\n              innerLoop.break()\n            }\n          }\n        }\n\n        if (_bv_count_one_bits(_roa_df_match) == 0) {\n          loop.break()\n        }\n      }\n    }\n  }\n  lv_alt_dl_bits\n}\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_AltsReformat_0" : {
          "id" : "Rank_AltsReformat_0",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Rank_AltsReformat_0",
            "slug" : "Rank_AltsReformat_0",
            "x" : 620,
            "y" : 60,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_0__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_0__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "Association_Processing__Rank_AltsReformat_0__in##tal_id", "Association_Processing__Rank_AltsReformat_0__in##tal_name", "Association_Processing__Rank_AltsReformat_0__in##tal_assoc_name", "Association_Processing__Rank_AltsReformat_0__in##tar_udl_nm", "Association_Processing__Rank_AltsReformat_0__in##shared_qual", "Association_Processing__Rank_AltsReformat_0__in##ta_prdct_dtls_wo_alt", "Association_Processing__Rank_AltsReformat_0__in##newline" ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl_nm",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl_nm\")"
              },
              "description" : ""
            }, {
              "target" : "shared_qual",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"shared_qual\")"
              },
              "description" : ""
            }, {
              "target" : "ta_prdct_dtls_wo_alt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"ta_prdct_dtls_wo_alt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Normalize_TAL_Target_Drugs_Without_Alternatives" : {
          "id" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives",
            "slug" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
            "x" : 820,
            "y" : 60,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"ta_prdct_dtls_wo_alt\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          col(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n          col(\"tar_udl_nm\").as(\"tar_udl\"),\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\")\n            .as(\"target_ndc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_tier\")\n          ).otherwise(lit(null)).as(\"target_formulary_tier\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_status\")\n          ).otherwise(lit(null)).as(\"target_formulary_status\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"pa_reqd_ind\")\n          ).otherwise(lit(null)).as(\"target_pa_reqd_ind\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_ind\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_ind\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"specialty_ind\")\n          ).otherwise(lit(null)).as(\"target_specialty_ind\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"msc\")\n            .as(\"target_multi_src_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"roa_cd\")\n            .as(\"target_roa_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"dosage_form_cd\")\n            .as(\"target_dosage_form_cd\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\",\n                        element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                 ).getField(\"gpi14\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              ).getField(\"gpi14\")\n            )\n            .as(\"target_gpi14\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\",\n                        element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                 ).getField(\"drug_name\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              ).getField(\"drug_name\")\n            )\n            .as(\"target_prod_name_ext\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"prod_short_desc\")\n            .as(\"target_prod_short_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi14_desc\")\n            .as(\"target_gpi14_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi8_desc\")\n            .as(\"target_gpi8_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_tier_desc\")\n          ).otherwise(lit(null)).as(\"target_formulary_tier_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_status_desc\")\n          ).otherwise(lit(null)).as(\"target_formulary_status_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"pa_type_cd\")\n          ).otherwise(lit(null)).as(\"target_pa_type_cd\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_type_cd\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_type_cd\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_group_name\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_group_name\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_step_number\")\n          ).otherwise(lit(null)).cast(StringType).as(\"target_step_therapy_step_num\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_cd\")\n          ).otherwise(lit(\"\")).as(\"formulary_cd\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"last_exp_dt\")\n          ).otherwise(lit(null)).as(\"last_exp_dt\")\n        )\n      ).as(\"alt_run_target_dtl_load\"),\n      (when(\n        !isnull(\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n        ),\n        when(\n          isnull(\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            )\n          ),\n          lit(0)\n        ).otherwise(lit(1))\n      ).otherwise(lit(0)).cast(DecimalType(1, 0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select((col(\"alt_run_target_dtl_load\")).as(\"alt_run_target_dtl_load\"),\n                                              (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Normalize_TAL_Target_Drugs" : {
          "id" : "Normalize_TAL_Target_Drugs",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Target_Drugs",
            "slug" : "Normalize_TAL_Target_Drugs",
            "x" : 820,
            "y" : 320,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(10,0)",
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_prd",
                              "type" : "integer",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "rebate_elig_cd",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tad_eli_code",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "qty_adjust_factor",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tal_assoc_name",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tala",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "priority",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : false
                        },
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : false
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"ta_prdct_dtls\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\")\n            .as(\"target_ndc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_tier\").as(\"target_formulary_tier\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_status\").as(\"target_formulary_status\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"pa_reqd_ind\").as(\"target_pa_reqd_ind\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"step_therapy_ind\").as(\"target_step_therapy_ind\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"specialty_ind\").as(\"target_specialty_ind\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"msc\")\n            .as(\"target_multi_src_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"roa_cd\")\n            .as(\"target_roa_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"dosage_form_cd\")\n            .as(\"target_dosage_form_cd\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"gpi14\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                .getField(\"gpi14\")\n            )\n            .as(\"target_gpi14\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"drug_name\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                .getField(\"drug_name\")\n            )\n            .as(\"target_prod_name_ext\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"prod_short_desc\")\n            .as(\"target_prod_short_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi14_desc\")\n            .as(\"target_gpi14_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi8_desc\")\n            .as(\"target_gpi8_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_tier_desc\").as(\"target_formulary_tier_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_status_desc\").as(\"target_formulary_status_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"pa_type_cd\").as(\"target_pa_type_cd\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"step_therapy_type_cd\").as(\"target_step_therapy_type_cd\"),\n          when(\n            element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n            array_join(\n              lookup(\n                \"LKP_Step_Grp_NM\",\n                lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                  .getField(\"ndc11\"),\n                lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n              ).getField(\"step_therapy_group_names\"),\n              \"|\"\n            )\n          ).otherwise(lit(\"\")).as(\"target_step_therapy_group_name\"),\n          when(\n            element_at(col(\"ta_prdct_dtls\"),  col(\"index\") + lit(1)).getField(\"ST_flag\"),\n            lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n          ).otherwise(lit(0.0)).cast(StringType).as(\"target_step_therapy_step_num\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_cd\").as(\"formulary_cd\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"last_exp_dt\").as(\"last_exp_dt\")\n        )\n      ).as(\"target_dtl\"),\n      (when(\n        is_blank(\n          when(\n            element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n            array_join(\n              lookup(\n                \"LKP_Step_Grp_NM\",\n                lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                  .getField(\"ndc11\"),\n                lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n              ).getField(\"step_therapy_group_names\"),\n              \"|\"\n            )\n          ).otherwise(lit(\"\"))\n        ),\n        lit(\" \")\n      ).when(\n          size(\n            element_at(element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\"), lit(1))\n              .getField(\"tala\")\n          ) > lit(20),\n          element_at(element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\"), lit(1))\n            .getField(\"tala\")\n        )\n        .otherwise(col(\"tal_assoc_name\")))\n        .as(\"tala\"),\n      (element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1))\n        .getField(\"ST_flag\")\n        .cast(DecimalType(1, 0)))\n        .as(\"ST_flag\"),\n      (when(\n        element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n        lookup(\n          \"LKP_Step_Grp_NM\",\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\"),\n          lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n        ).getField(\"step_therapy_group_names\")\n      ).otherwise(array())).as(\"tar_group_names\"),\n      (element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\")).as(\"alt_products_def\"),\n      (when(\n        !isnull(lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))),\n        when(\n          isnull(\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                     .getField(\"ndc11\")\n            )\n          ),\n          lit(0)\n        ).otherwise(lit(1))\n      ).otherwise(lit(0)).cast(DecimalType(1, 0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select(\n    (col(\"tal_id\").cast(DecimalType(10, 0))).as(\"tal_id\"),\n    (col(\"tal_name\")).as(\"tal_name\"),\n    (col(\"target_dtl\")).as(\"target_dtl\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"tala\")).as(\"tala\"),\n    (col(\"tar_udl_nm\")).as(\"tar_udl\"),\n    (col(\"ST_flag\")).as(\"ST_flag\"),\n    (col(\"tar_group_names\")).as(\"tar_group_names\"),\n    (col(\"alt_products_def\")).as(\"alt_products_def\"),\n    (col(\"constituent_grp_vec\")).as(\"constituent_grp_vec\"),\n    (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_AltsReformat_1" : {
          "id" : "Rank_AltsReformat_1",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Rank_AltsReformat_1",
            "slug" : "Rank_AltsReformat_1",
            "x" : 620,
            "y" : 320,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_1__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_1__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "Association_Processing__Rank_AltsReformat_1__in##tal_id", "Association_Processing__Rank_AltsReformat_1__in##tal_name", "Association_Processing__Rank_AltsReformat_1__in##tal_assoc_name", "Association_Processing__Rank_AltsReformat_1__in##tar_udl_nm", "Association_Processing__Rank_AltsReformat_1__in##ta_prdct_dtls", "Association_Processing__Rank_AltsReformat_1__in##constituent_grp_vec", "Association_Processing__Rank_AltsReformat_1__in##newline" ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl_nm",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl_nm\")"
              },
              "description" : ""
            }, {
              "target" : "ta_prdct_dtls",
              "expression" : {
                "format" : "scala",
                "expression" : "transform(\n    col(\"ta_prdct_dtls\"),\n    y =>\n      struct(\n        y.getField(\"target_dl_bit\").as(\"target_dl_bit\"),\n        coalesce(y.getField(\"ST_flag\"), lit(0)).as(\"ST_flag\"),\n        array(\n          struct(\n            lit(0).as(\"alt_prd\"),\n            lit(0).as(\"alt_rank\"),\n            lit(\"\").as(\"rebate_elig_cd\"),\n            lit(\"\").as(\"tad_eli_code\"),\n            lit(\"\").as(\"qty_adjust_factor\"),\n            lit(\"\").as(\"tal_assoc_name\"),\n            lit(\"\").as(\"tala\"),\n            lit(\"\").as(\"udl_nm\"),\n            lit(\"\").as(\"priority\"),\n            lit(\"\").as(\"constituent_group\"),\n            lit(\"\").as(\"constituent_reqd\")\n          )\n        ).as(\"alt_prdcts\")\n      )\n  )"
              },
              "description" : ""
            }, {
              "target" : "constituent_grp_vec",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"constituent_grp_vec\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Tranform_Proxy_DTL_Layout" : {
          "id" : "Tranform_Proxy_DTL_Layout",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Tranform_Proxy_DTL_Layout",
            "slug" : "Tranform_Proxy_DTL_Layout",
            "x" : 1820,
            "y" : 340,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Tranform_Proxy_DTL_Layout__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Tranform_Proxy_DTL_Layout__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_alt_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_alt_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"formulary_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "alt_proxy_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"alt_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "rank",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rank\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rec_crt_ts\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rec_crt_user_id\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Normalize_Clinical_Indication" : {
          "id" : "Normalize_Clinical_Indication",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_Clinical_Indication",
            "slug" : "Normalize_Clinical_Indication",
            "x" : 1420,
            "y" : 20,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_Clinical_Indication__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_step_num",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_exp_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_Clinical_Indication__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = None,\n    finishedExpression = None,\n    finishedCondition = lit(false),\n    alias = \"index\",\n    colsToSelect = List(\n      coalesce(\n        (element_at(\n          lookup_row(\"LKP_CLIN_INDCN\", col(\"tal_assoc_name\")),\n          col(\"index\") + lit(1)\n        ).getField(\"rank\").cast(StringType)),\n        lit(\"\")\n      ).as(\"rank\"),\n      coalesce(\n        (element_at(\n          lookup_row(\"LKP_CLIN_INDCN\", col(\"tal_assoc_name\")),\n          col(\"index\") + lit(1)\n        )\n          .getField(\"clinical_indn_desc\")),\n        lit(0)\n      )\n        .as(\"clinical_indn_desc\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"formulary_name\")).as(\"formulary_name\"),\n    (col(\"target_ndc\")).as(\"target_ndc\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"rank\")).as(\"rank\"),\n    (lit(Config.RUN_TS)).as(\"rec_crt_ts\"),\n    (lit(Config.USER_ID)).as(\"rec_crt_user_id\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\")\n  )\n\n  val out = simpleSelect_in_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_Alts_RowDistributor" : {
          "id" : "Rank_Alts_RowDistributor",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "Association_Processing__Rank_Alts_RowDistributor",
            "slug" : "Rank_Alts_RowDistributor",
            "x" : 420,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out0",
              "slug" : "out0"
            }, {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out1",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out0",
              "model" : {
                "format" : "scala",
                "expression" : "size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType)"
              }
            }, {
              "path" : "out1",
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out1",
              "model" : {
                "format" : "scala",
                "expression" : "size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType).or(!size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType))"
              }
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Alternative_Rollup_Processing" : {
          "id" : "Alternative_Rollup_Processing",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "Alternative_Rollup_Processing",
            "slug" : "Alternative_Rollup_Processing",
            "x" : 1420,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1",
              "slug" : "out1"
            }, {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "e54",
            "source" : "Alternative_Rollup_Processing",
            "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in",
            "target" : "FBE_Target_Product_with_without_Constituent_Data",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__in"
          }, {
            "id" : "56",
            "source" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__out",
            "target" : "Alternative_Rollup_Processing",
            "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1"
          }, {
            "id" : "57",
            "source" : "Normalize_Alt_Proxy_Products",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__out",
            "target" : "Alternative_Rollup_Processing",
            "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out"
          }, {
            "id" : "e12",
            "source" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__out",
            "target" : "Normalize_Alt_Proxy_Products",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__in"
          }, {
            "id" : "WHw6yY_u7xIR4Y3cBN3s1",
            "source" : "FBE_Target_Product_with_without_Constituent_Data",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
            "target" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
            "targetPort" : "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES"
          }, {
            "id" : "WDS04qMTXZjEBLi9CpJjP$$rYjnUIlwZ2R5Mq7FG1eNv",
            "source" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
            "sourcePort" : "H5fZmwWlbI4umLZnBqBj_$$aJBcwOodL-Lp93Oi9YHH8",
            "target" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
            "targetPort" : "-K4vXWdYTmRcsk7i8R_GZ$$eqRkJ1k5yt5kV3JV1IqWW"
          }, {
            "id" : "e8SCAw1hJT4ikO7bdsqyS",
            "source" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
            "sourcePort" : "aiJGUXi45T1q-KLb8hEjB$$JlMH1ty8uZNyq0HDfkScd",
            "target" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__in"
          }, {
            "id" : "9NiGmYMzn419XoLzPFDcT",
            "source" : "FBE_Target_Product_with_without_Constituent_Data",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
            "target" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
            "targetPort" : "kf3CU5JisDRkY3bTX8P7v$$RqsEpMaGtPqWl8_kLetUK"
          }, {
            "id" : "Vm-1ErkFqDDmk9hBZ7t_G$$rvwx4TgyZQ07zFbc3fayK",
            "source" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
            "sourcePort" : "8nYrYzvuQyh9-uBpgfSaS$$CPzzTJMIISIiriEB4L47q",
            "target" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__in"
          } ],
          "processes" : {
            "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl" : {
              "id" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
              "component" : "Script",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents",
                "slug" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents",
                "x" : 220,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "kf3CU5JisDRkY3bTX8P7v$$RqsEpMaGtPqWl8_kLetUK",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "8nYrYzvuQyh9-uBpgfSaS$$CPzzTJMIISIiriEB4L47q",
                  "slug" : "out0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "val process_udf = udf(\n  { (inputRows: Seq[Row]) =>\n    {\n\n      var alt_run_alt_dtl_load_vec = Array[Row]()\n      var alt_prod_short_desc_grp_vec = Array[String]()\n      var lv_constituent_grp_vec = Array[String]()\n      var _constituent_Y_alt_dtl_vec = Array[Row]()\n      var _constituent_N_alt_dtl_vec = Array[Row]()\n\n      inputRows.zipWithIndex.foreach {\n        case (in, jdx) => {\n          var idx = -1\n          if (\n            !alt_prod_short_desc_grp_vec.contains(\n              in.getAs[Row](\"alt_run_alt_dtl_load\")\n                .getAs[String](\"alt_prod_short_desc_grp\")\n            )\n          ) {\n            alt_prod_short_desc_grp_vec = Array.concat(\n              alt_prod_short_desc_grp_vec,\n              Array.fill(1)(\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"alt_prod_short_desc_grp\")\n              )\n            )\n\n            if (\n              !_isnull(\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"constituent_reqd\")\n              )\n            ) {\n\n              if (\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"constituent_reqd\") == \"Y\"\n              ) {\n                _constituent_Y_alt_dtl_vec = Array.concat(\n                  _constituent_Y_alt_dtl_vec,\n                  Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n                )\n              } else {\n                _constituent_N_alt_dtl_vec = Array.concat(\n                  _constituent_N_alt_dtl_vec,\n                  Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n                )\n              }\n            } else {\n              alt_run_alt_dtl_load_vec = Array.concat(\n                alt_run_alt_dtl_load_vec,\n                Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n              )\n            }\n          }\n        }\n      }\n      if (\n        in.getAs[Seq[String]](\"constituent_grp_vec\")\n          .diff(lv_constituent_grp_vec)\n          .isEmpty\n      ) {\n        alt_run_alt_dtl_load_vec =\n          Array.concat(alt_run_alt_dtl_load_vec, _constituent_Y_alt_dtl_vec)\n        alt_run_alt_dtl_load_vec =\n          Array.concat(alt_run_alt_dtl_load_vec, _constituent_N_alt_dtl_vec)\n      }\n    }\n    Row(alt_run_alt_dtl_load_vec)\n  },\n  StructType(\n              List(\n                StructField(\"alt_run_alt_dtl_id\",           DecimalType(16, 0)),\n                StructField(\"alt_run_id\",                   DecimalType(16, 0)),\n                StructField(\"alt_run_target_dtl_id\",        DecimalType(16, 0)),\n                StructField(\"formulary_name\",               StringType),\n                StructField(\"target_ndc\",                   StringType),\n                StructField(\"alt_ndc\",                      StringType),\n                StructField(\"alt_formulary_tier\",           StringType),\n                StructField(\"alt_multi_src_cd\",             StringType),\n                StructField(\"alt_roa_cd\",                   StringType),\n                StructField(\"alt_dosage_form_cd\",           StringType),\n                StructField(\"rank\",                         StringType),\n                StructField(\"alt_step_therapy_ind\",         StringType),\n                StructField(\"alt_pa_reqd_ind\",              StringType),\n                StructField(\"alt_formulary_status\",         StringType),\n                StructField(\"alt_specialty_ind\",            StringType),\n                StructField(\"alt_gpi14\",                    StringType),\n                StructField(\"alt_prod_name_ext\",            StringType),\n                StructField(\"alt_prod_short_desc\",          StringType),\n                StructField(\"alt_prod_short_desc_grp\",      StringType),\n                StructField(\"alt_gpi14_desc\",               StringType),\n                StructField(\"alt_gpi8_desc\",                StringType),\n                StructField(\"alt_formulary_tier_desc\",      StringType),\n                StructField(\"alt_formulary_status_desc\",    StringType),\n                StructField(\"alt_pa_type_cd\",               StringType),\n                StructField(\"alt_step_therapy_type_cd\",     StringType),\n                StructField(\"alt_step_therapy_group_name\",  StringType),\n                StructField(\"alt_step_therapy_step_number\", StringType),\n                StructField(\"rec_crt_ts\",                   StringType),\n                StructField(\"rec_crt_user_id\",              StringType),\n                StructField(\"rebate_elig_cd\",               StringType),\n                StructField(\"tad_eligible_cd\",              StringType),\n                StructField(\"alt_qty_adj\",                  DecimalType(6, 3)),\n                StructField(\"tal_assoc_name\",               StringType),\n                StructField(\"tala\",                         StringType),\n                StructField(\"alt_udl\",                      StringType),\n                StructField(\"tal_assoc_rank\",               DecimalType(38, 6)),\n                StructField(\"constituent_group\",            StringType),\n                StructField(\"constituent_reqd\",             StringType),\n                StructField(\"newline\",                      StringType)\n              )\n            )\n)\n\nval out0 = in0\n  .groupBy(\n    \"alt_run_alt_dtl_load.tal_assoc_name\",\n    \"alt_run_alt_dtl_load.target_ndc\"\n  )\n  .agg(collect_list(col(\"tmp\")).as(\"input\"))\n  .select(process_udf(col(\"input\")).as(\"output\"))\n  .select(col(\"output.*\"))\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out0\n}"
              }
            },
            "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG" : {
              "id" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
              "component" : "Script",
              "metadata" : {
                "label" : "flatten",
                "slug" : "flatten",
                "x" : 420,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "-K4vXWdYTmRcsk7i8R_GZ$$eqRkJ1k5yt5kV3JV1IqWW",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "out",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "aiJGUXi45T1q-KLb8hEjB$$JlMH1ty8uZNyq0HDfkScd",
                  "slug" : "out0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "val out = in0.select(\"out.*\")",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out0\n}"
              }
            },
            "Identify_Alt_Proxy_Targets_w_Constituents_Reformat" : {
              "id" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
              "component" : "Reformat",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
                "slug" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
                "x" : 420,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "expressions" : [ {
                  "target" : "alt_run_alt_dtl_load_vec",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "transform(\n    col(\"alt_run_alt_dtl_load_vec\"),\n    x =>\n      struct(\n        coalesce(x.getField(\"alt_run_alt_dtl_id\"),    lit(-1)).as(\"alt_run_alt_dtl_id\"),\n        coalesce(x.getField(\"alt_run_id\"),            lit(-1)).as(\"alt_run_id\"),\n        coalesce(x.getField(\"alt_run_target_dtl_id\"), lit(-1)).as(\"alt_run_target_dtl_id\"),\n        x.getField(\"formulary_name\").as(\"formulary_name\"),\n        x.getField(\"target_ndc\").as(\"target_ndc\"),\n        x.getField(\"alt_ndc\").as(\"alt_ndc\"),\n        x.getField(\"alt_formulary_tier\").as(\"alt_formulary_tier\"),\n        x.getField(\"alt_multi_src_cd\").as(\"alt_multi_src_cd\"),\n        x.getField(\"alt_roa_cd\").as(\"alt_roa_cd\"),\n        x.getField(\"alt_dosage_form_cd\").as(\"alt_dosage_form_cd\"),\n        x.getField(\"rank\").as(\"rank\"),\n        x.getField(\"alt_step_therapy_ind\").as(\"alt_step_therapy_ind\"),\n        x.getField(\"alt_pa_reqd_ind\").as(\"alt_pa_reqd_ind\"),\n        x.getField(\"alt_formulary_status\").as(\"alt_formulary_status\"),\n        x.getField(\"alt_specialty_ind\").as(\"alt_specialty_ind\"),\n        x.getField(\"alt_gpi14\").as(\"alt_gpi14\"),\n        x.getField(\"alt_prod_name_ext\").as(\"alt_prod_name_ext\"),\n        x.getField(\"alt_prod_short_desc\").as(\"alt_prod_short_desc\"),\n        x.getField(\"alt_prod_short_desc_grp\").as(\"alt_prod_short_desc_grp\"),\n        x.getField(\"alt_gpi14_desc\").as(\"alt_gpi14_desc\"),\n        x.getField(\"alt_gpi8_desc\").as(\"alt_gpi8_desc\"),\n        x.getField(\"alt_formulary_tier_desc\").as(\"alt_formulary_tier_desc\"),\n        x.getField(\"alt_formulary_status_desc\").as(\"alt_formulary_status_desc\"),\n        x.getField(\"alt_pa_type_cd\").as(\"alt_pa_type_cd\"),\n        x.getField(\"alt_step_therapy_type_cd\").as(\"alt_step_therapy_type_cd\"),\n        x.getField(\"alt_step_therapy_group_name\").as(\"alt_step_therapy_group_name\"),\n        x.getField(\"alt_step_therapy_step_number\").as(\"alt_step_therapy_step_number\"),\n        x.getField(\"rec_crt_ts\").as(\"rec_crt_ts\"),\n        x.getField(\"rec_crt_user_id\").as(\"rec_crt_user_id\"),\n        x.getField(\"rebate_elig_cd\").as(\"rebate_elig_cd\"),\n        x.getField(\"tad_eligible_cd\").as(\"tad_eligible_cd\"),\n        x.getField(\"alt_qty_adj\").as(\"alt_qty_adj\"),\n        x.getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n        x.getField(\"tala\").as(\"tala\"),\n        x.getField(\"alt_udl\").as(\"alt_udl\"),\n        x.getField(\"tal_assoc_rank\").as(\"tal_assoc_rank\"),\n        x.getField(\"constituent_group\").as(\"constituent_group\"),\n        x.getField(\"constituent_reqd\").as(\"constituent_reqd\"),\n        coalesce(x.getField(\"newline\"),                        lit(\"\\n\")).as(\"newline\")\n      )\n  )"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat" : {
              "id" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
              "component" : "Reformat",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
                "slug" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
                "x" : 620,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "expressions" : [ {
                  "target" : "alt_run_alt_dtl_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_alt_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_run_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_run_target_dtl_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "formulary_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"formulary_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "target_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"target_ndc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_ndc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_tier",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_tier\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_multi_src_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_multi_src_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_roa_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_roa_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_dosage_form_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_dosage_form_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rank\").cast(StringType)"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_pa_reqd_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_pa_reqd_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_status",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_status\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_specialty_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_specialty_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi14",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi14\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_name_ext",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_name_ext\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_short_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_short_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_short_desc_grp",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_short_desc_grp\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi14_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi14_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi8_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi8_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_tier_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_tier_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_status_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_status_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_pa_type_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_pa_type_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_type_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_type_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_group_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_group_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_step_number",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_step_number\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rec_crt_ts",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rec_crt_ts\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rec_crt_user_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rec_crt_user_id\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rebate_elig_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rebate_elig_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tad_eligible_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tad_eligible_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_qty_adj",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_qty_adj\").cast(DecimalType(6, 3))"
                  },
                  "description" : ""
                }, {
                  "target" : "tal_assoc_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_assoc_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tala",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tala\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_udl",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_udl\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tal_assoc_rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_assoc_rank\").cast(DecimalType(38, 6))"
                  },
                  "description" : ""
                }, {
                  "target" : "constituent_group",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"constituent_group\")"
                  },
                  "description" : ""
                }, {
                  "target" : "constituent_reqd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"constituent_reqd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "newline",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Normalize_Alt_Proxy_Products" : {
              "id" : "Normalize_Alt_Proxy_Products",
              "component" : "Script",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products",
                "slug" : "Normalize_Alt_Proxy_Products",
                "x" : 620,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : false
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_run_alt_dtl_load_vec\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_run_alt_dtl_id\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_alt_dtl_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_run_id\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"*\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_target_dtl_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"formulary_name\")).as(\"formulary_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"target_ndc\")).as(\"target_ndc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_ndc\")).as(\"alt_ndc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_tier\")).as(\"alt_formulary_tier\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_multi_src_cd\")).as(\"alt_multi_src_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_roa_cd\")).as(\"alt_roa_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_dosage_form_cd\")).as(\"alt_dosage_form_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rank\").cast(StringType)).as(\"rank\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_step_therapy_ind\")).as(\"alt_step_therapy_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_pa_reqd_ind\")).as(\"alt_pa_reqd_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_status\")).as(\"alt_formulary_status\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_specialty_ind\")).as(\"alt_specialty_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi14\")).as(\"alt_gpi14\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_name_ext\")).as(\"alt_prod_name_ext\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_short_desc\")).as(\"alt_prod_short_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_short_desc_grp\")).as(\"alt_prod_short_desc_grp\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi14_desc\")).as(\"alt_gpi14_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi8_desc\")).as(\"alt_gpi8_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_tier_desc\")).as(\"alt_formulary_tier_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_formulary_status_desc\"))\n        .as(\"alt_formulary_status_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_pa_type_cd\")).as(\"alt_pa_type_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_step_therapy_type_cd\")).as(\"alt_step_therapy_type_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_step_therapy_group_name\"))\n        .as(\"alt_step_therapy_group_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_step_therapy_step_number\"))\n        .as(\"alt_step_therapy_step_number\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rec_crt_ts\")).as(\"rec_crt_ts\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rec_crt_user_id\")).as(\"rec_crt_user_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rebate_elig_cd\")).as(\"rebate_elig_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tad_eligible_cd\")).as(\"tad_eligible_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"*\")\n        .cast(DecimalType(6, 3)))\n        .as(\"alt_qty_adj\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tala\")).as(\"tala\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_udl\")).as(\"alt_udl\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"tal_assoc_rank\")\n        .cast(DecimalType(38, 6)))\n        .as(\"tal_assoc_rank\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"constituent_group\")).as(\"constituent_group\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"constituent_reqd\")).as(\"constituent_reqd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"newline\").cast(StringType)).as(\"newline\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"alt_run_alt_dtl_id\")).as(\"alt_run_alt_dtl_id\"),\n    (col(\"alt_run_id\")).as(\"alt_run_id\"),\n    (col(\"alt_run_target_dtl_id\")).as(\"alt_run_target_dtl_id\"),\n    (col(\"formulary_name\")).as(\"formulary_name\"),\n    (col(\"target_ndc\")).as(\"target_ndc\"),\n    (col(\"alt_ndc\")).as(\"alt_ndc\"),\n    (col(\"alt_formulary_tier\")).as(\"alt_formulary_tier\"),\n    (col(\"alt_multi_src_cd\")).as(\"alt_multi_src_cd\"),\n    (col(\"alt_roa_cd\")).as(\"alt_roa_cd\"),\n    (col(\"alt_dosage_form_cd\")).as(\"alt_dosage_form_cd\"),\n    (col(\"rank\")).as(\"rank\"),\n    (col(\"alt_step_therapy_ind\")).as(\"alt_step_therapy_ind\"),\n    (col(\"alt_pa_reqd_ind\")).as(\"alt_pa_reqd_ind\"),\n    (col(\"alt_formulary_status\")).as(\"alt_formulary_status\"),\n    (col(\"alt_specialty_ind\")).as(\"alt_specialty_ind\"),\n    (col(\"alt_gpi14\")).as(\"alt_gpi14\"),\n    (col(\"alt_prod_name_ext\")).as(\"alt_prod_name_ext\"),\n    (col(\"alt_prod_short_desc\")).as(\"alt_prod_short_desc\"),\n    (col(\"alt_prod_short_desc_grp\")).as(\"alt_prod_short_desc_grp\"),\n    (col(\"alt_gpi14_desc\")).as(\"alt_gpi14_desc\"),\n    (col(\"alt_gpi8_desc\")).as(\"alt_gpi8_desc\"),\n    (col(\"alt_formulary_tier_desc\")).as(\"alt_formulary_tier_desc\"),\n    (col(\"alt_formulary_status_desc\")).as(\"alt_formulary_status_desc\"),\n    (col(\"alt_pa_type_cd\")).as(\"alt_pa_type_cd\"),\n    (col(\"alt_step_therapy_type_cd\")).as(\"alt_step_therapy_type_cd\"),\n    (col(\"alt_step_therapy_group_name\")).as(\"alt_step_therapy_group_name\"),\n    (col(\"alt_step_therapy_step_number\")).as(\"alt_step_therapy_step_number\"),\n    (col(\"rec_crt_ts\")).as(\"rec_crt_ts\"),\n    (col(\"rec_crt_user_id\")).as(\"rec_crt_user_id\"),\n    (col(\"rebate_elig_cd\")).as(\"rebate_elig_cd\"),\n    (col(\"tad_eligible_cd\")).as(\"tad_eligible_cd\"),\n    (col(\"alt_qty_adj\")).as(\"alt_qty_adj\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"tala\")).as(\"tala\"),\n    (col(\"alt_udl\")).as(\"alt_udl\"),\n    (col(\"tal_assoc_rank\")).as(\"tal_assoc_rank\"),\n    (col(\"constituent_group\")).as(\"constituent_group\"),\n    (col(\"constituent_reqd\")).as(\"constituent_reqd\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out\n}"
              }
            },
            "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe" : {
              "id" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_1",
                "slug" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_1",
                "x" : 220,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "H5fZmwWlbI4umLZnBqBj_$$aJBcwOodL-Lp93Oi9YHH8",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "_row_id" : "c_36",
                  "target" : "out",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "    element_at(reverse(filter(\n    collect_list(\n      col(\"alt_run_alt_dtl_load\")\n    ),\n     xx => xx.getField(\"rank\") === min(col(\"alt_run_alt_dtl_load.rank\"))\n    )), 1)"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_52",
                  "target" : "rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "min(col(\"alt_run_alt_dtl_load.rank\").cast(StringType)).cast(StringType)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.tal_assoc_name", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.target_ndc", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.alt_prod_short_desc_grp", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.rank" ],
                "groupBy" : [ {
                  "_row_id" : "c_15",
                  "target" : "tal_assoc_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.tal_assoc_name\")"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_18",
                  "target" : "target_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.target_ndc\")"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_21",
                  "target" : "alt_prod_short_desc_grp",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.alt_prod_short_desc_grp\")"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "FBE_Target_Product_with_without_Constituent_Data" : {
              "id" : "FBE_Target_Product_with_without_Constituent_Data",
              "component" : "RowDistributor",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data",
                "slug" : "FBE_Target_Product_with_without_Constituent_Data",
                "x" : 20,
                "y" : 120,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
                  "slug" : "out0"
                }, {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
                  "slug" : "out1"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "outports" : [ {
                  "path" : "out0",
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
                  "model" : {
                    "format" : "scala",
                    "expression" : "!size(col(\"constituent_grp_vec\")).cast(BooleanType)"
                  }
                }, {
                  "path" : "out1",
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
                  "model" : {
                    "format" : "scala",
                    "expression" : "size(col(\"constituent_grp_vec\")).cast(BooleanType)"
                  }
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
                "projectName" : "ProphecySparkBasicsScala"
              }
            }
          }
        },
        "Normalize_TAL_Alts_assign_attributes" : {
          "id" : "Normalize_TAL_Alts_assign_attributes",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Alts_assign_attributes",
            "slug" : "Normalize_TAL_Alts_assign_attributes",
            "x" : 1220,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : false
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "def temp202006_UDF(alt_prod_attrs: org.apache.spark.sql.Column) = {\n  val _alt_group_names_list = flatten(\n    transform(\n      lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_alt_st_grp_nums\"),\n      xx =>\n        array_intersect(\n          coalesce(\n            lookup(\"LKP_Step_Grp_NM\", alt_prod_attrs.getField(\"ndc11\"), xx)\n              .getField(\"step_therapy_group_names\"),\n            array()\n          ),\n          col(\"tar_group_names\")\n        )\n    )\n  )\n\n  val _alt_group_num = filter(\n    transform(\n      lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_alt_st_grp_nums\"),\n      xx =>\n        when(\n          size(\n            array_intersect(\n              coalesce(\n                lookup(\"LKP_Step_Grp_NM\", alt_prod_attrs.getField(\"ndc11\"), xx)\n                  .getField(\"step_therapy_group_names\"),\n                array()\n              ),\n              col(\"tar_group_names\")\n            )\n          ) > lit(0),\n          xx\n        ),\n      xx => !isnull(xx)\n    )\n  )\n\n  struct(\n    _alt_group_names_list.as(\"_alt_group_names_list\"),\n    _alt_group_num(\"_alt_group_num\")\n  )\n}\n\n\n  \n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_products_def\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_alt_dtl_id\"),\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_id\"),\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_target_dtl_id\"),\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          col(\"target_dtl.target_ndc\").as(\"target_ndc\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"ndc11\").as(\"alt_ndc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_tier\")\n          ).otherwise(lit(null)).as(\"alt_formulary_tier\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"msc\").as(\"alt_multi_src_cd\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"roa_cd\").as(\"alt_roa_cd\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"dosage_form_cd\").as(\"alt_dosage_form_cd\"),\n          (col(\"index\") + lit(1)).cast(StringType).as(\"rank\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"step_therapy_ind\")\n          ).otherwise(lit(null)).as(\"alt_step_therapy_ind\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"pa_reqd_ind\")\n          ).otherwise(lit(null)).as(\"alt_pa_reqd_ind\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_status\")\n          ).otherwise(lit(null)).as(\"alt_formulary_status\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"specialty_ind\")\n          ).otherwise(lit(null)).as(\"alt_specialty_ind\"),\n          when(\n            is_blank(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"gpi14\")\n            ),\n            lit(\" \")\n          ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"gpi14\")\n            )\n            .as(\"alt_gpi14\"),\n          when(\n            is_blank(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"drug_name\")\n            ),\n            lit(\" \")\n          ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"drug_name\")\n            )\n            .as(\"alt_prod_name_ext\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"prod_short_desc\").as(\"alt_prod_short_desc\"),\n          string_substring(\n            when(\n              when(file_information(lit(Config.ALIAS_PRODUCT_FILE)).getField(\"size\").cast(BooleanType),\n                   lit(1).cast(BooleanType)\n              ).otherwise(lit(0).cast(BooleanType)),\n              lookup(\n                \"LKP_Alias_Prod\",\n                coalesce(\n                  lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                  struct(\n                    lit(null).as(\"alt_run_alt_dtl_id\"),\n                    lit(null).as(\"alt_run_id\"),\n                    lit(null).as(\"alt_run_target_dtl_id\"),\n                    lit(null).as(\"formulary_name\"),\n                    lit(null).as(\"target_ndc\"),\n                    lit(null).as(\"alt_ndc\"),\n                    lit(null).as(\"alt_formulary_tier\"),\n                    lit(null).as(\"alt_multi_src_cd\"),\n                    lit(null).as(\"alt_roa_cd\"),\n                    lit(null).as(\"alt_dosage_form_cd\"),\n                    lit(null).as(\"rank\"),\n                    lit(null).as(\"alt_step_therapy_ind\"),\n                    lit(null).as(\"alt_pa_reqd_ind\"),\n                    lit(null).as(\"alt_formulary_status\"),\n                    lit(null).as(\"alt_specialty_ind\"),\n                    lit(null).as(\"alt_gpi14\"),\n                    lit(null).as(\"alt_prod_name_ext\"),\n                    lit(null).as(\"alt_prod_short_desc\"),\n                    lit(null).as(\"alt_prod_short_desc_grp\"),\n                    lit(null).as(\"alt_gpi14_desc\"),\n                    lit(null).as(\"alt_gpi8_desc\"),\n                    lit(null).as(\"alt_formulary_tier_desc\"),\n                    lit(null).as(\"alt_formulary_status_desc\"),\n                    lit(null).as(\"alt_pa_type_cd\"),\n                    lit(null).as(\"alt_step_therapy_type_cd\"),\n                    lit(null).as(\"alt_step_therapy_group_name\"),\n                    lit(null).as(\"alt_step_therapy_step_number\"),\n                    lit(null).as(\"rec_crt_ts\"),\n                    lit(null).as(\"rec_crt_user_id\"),\n                    lit(null).as(\"rebate_elig_cd\"),\n                    lit(null).as(\"tad_eligible_cd\"),\n                    lit(null).as(\"alt_qty_adj\"),\n                    lit(null).as(\"tal_assoc_name\"),\n                    lit(null).as(\"tala\"),\n                    lit(null).as(\"alt_udl\"),\n                    lit(null).as(\"tal_assoc_rank\"),\n                    lit(null).as(\"constituent_group\"),\n                    lit(null).as(\"constituent_reqd\"),\n                    lit(null).as(\"newline\")\n                  )\n                ).getField(\"ndc11\")\n              ).getField(\"alias_label_nm\")\n            ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"prod_short_desc\")\n            ),\n            lit(1),\n            lit(12)\n          ).as(\"alt_prod_short_desc_grp\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"gpi14_desc\").as(\"alt_gpi14_desc\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"gpi8_desc\").as(\"alt_gpi8_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_tier_desc\")\n          ).otherwise(lit(null)).as(\"alt_formulary_tier_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_status_desc\")\n          ).otherwise(lit(null)).as(\"alt_formulary_status_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"pa_type_cd\")\n          ).otherwise(lit(null)).as(\"alt_pa_type_cd\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"step_therapy_type_cd\")\n          ).otherwise(lit(null)).as(\"alt_step_therapy_type_cd\"),\n          when(\n            size(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            array_join(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array()),\n              \"|\"\n            )\n          ).otherwise(lit(\"\")).as(\"alt_step_therapy_group_name\"),\n          when(\n            size(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            array_join(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_num\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array()),\n              \"|\"\n            )\n          ).otherwise(lit(0.0)).as(\"alt_step_therapy_step_number\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"rebate_elig_cd\").as(\"rebate_elig_cd\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tad_eli_code\").as(\"tad_eligible_cd\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"qty_adjust_factor\")\n            .cast(DecimalType(6, 3))\n            .as(\"alt_qty_adj\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tala\").as(\"tala\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"udl_nm\").as(\"alt_udl\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"priority\")\n            .cast(DecimalType(38, 6))\n            .as(\"tal_assoc_rank\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"constituent_group\")\n            .as(\"constituent_group\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"constituent_reqd\")\n            .as(\"constituent_reqd\"),\n          lit(\"\\n\").cast(StringType).as(\"newline\")\n        )\n      ).as(\"alt_run_alt_dtl_load\"),\n      (when(\n        !isnull(\n          lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n            .getField(\"ndc11\")\n        ),\n        when(\n          col(\"ST_flag\").cast(BooleanType),\n          when(\n            !size(\n              when(\n                !isnull(\n                  lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n                    .getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            lit(0)\n          ).when(\n              isnull(\n                lookup(\"LKP_Form_CAG_dataset\",\n                       lookup(\"LKP_Prod\",\n                              element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                       ).getField(\"ndc11\")\n                )\n              ),\n              lit(0)\n            )\n            .otherwise(lit(1))\n        ).when(\n            isnull(\n              lookup(\"LKP_Form_CAG_dataset\",\n                     lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n                       .getField(\"ndc11\")\n              )\n            ),\n            lit(0)\n          )\n          .otherwise(lit(1))\n      ).otherwise(lit(0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select(\n    (col(\"alt_run_alt_dtl_load\")).as(\"alt_run_alt_dtl_load\"),\n    (col(\"constituent_grp_vec\")).as(\"constituent_grp_vec\"),\n    (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0" : {
          "id" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
            "slug" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
            "x" : 1020,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"target_dtl.alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"target_dtl.alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tala\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl\")"
              },
              "description" : ""
            }, {
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.formulary_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_tier",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_tier\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_status",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_status\")"
              },
              "description" : ""
            }, {
              "target" : "target_pa_reqd_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_pa_reqd_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_specialty_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_specialty_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_multi_src_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_multi_src_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_roa_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_roa_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_dosage_form_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_dosage_form_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi14",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi14\")"
              },
              "description" : ""
            }, {
              "target" : "target_prod_name_ext",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_prod_name_ext\")"
              },
              "description" : ""
            }, {
              "target" : "target_prod_short_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_prod_short_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi14_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi14_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi8_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi8_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_tier_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_tier_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_status_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_status_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_pa_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_pa_type_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_type_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_group_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_group_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_step_num",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_step_num\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "formulary_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.formulary_cd\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.rec_crt_ts\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.rec_crt_user_id\")"
              },
              "description" : ""
            }, {
              "target" : "last_exp_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.last_exp_dt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(rpad(col(\"target_dtl.newline\"), 1, \" \"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1" : {
          "id" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
            "slug" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
            "x" : 1020,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_dtl",
              "expression" : {
                "format" : "scala",
                "expression" : "struct(\n    coalesce(col(\"target_dtl\").getField(\"alt_run_target_dtl_id\"), lit(-1)).as(\"alt_run_target_dtl_id\"),\n    coalesce(col(\"target_dtl\").getField(\"alt_run_id\"),            lit(-1)).as(\"alt_run_id\"),\n    col(\"target_dtl\").getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n    col(\"target_dtl\").getField(\"tala\").as(\"tala\"),\n    col(\"target_dtl\").getField(\"tar_udl\").as(\"tar_udl\"),\n    col(\"target_dtl\").getField(\"formulary_name\").as(\"formulary_name\"),\n    col(\"target_dtl\").getField(\"target_ndc\").as(\"target_ndc\"),\n    col(\"target_dtl\").getField(\"target_formulary_tier\").as(\"target_formulary_tier\"),\n    col(\"target_dtl\").getField(\"target_formulary_status\").as(\"target_formulary_status\"),\n    col(\"target_dtl\").getField(\"target_pa_reqd_ind\").as(\"target_pa_reqd_ind\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_ind\").as(\"target_step_therapy_ind\"),\n    col(\"target_dtl\").getField(\"target_specialty_ind\").as(\"target_specialty_ind\"),\n    col(\"target_dtl\").getField(\"target_multi_src_cd\").as(\"target_multi_src_cd\"),\n    col(\"target_dtl\").getField(\"target_roa_cd\").as(\"target_roa_cd\"),\n    col(\"target_dtl\").getField(\"target_dosage_form_cd\").as(\"target_dosage_form_cd\"),\n    col(\"target_dtl\").getField(\"target_gpi14\").as(\"target_gpi14\"),\n    col(\"target_dtl\").getField(\"target_prod_name_ext\").as(\"target_prod_name_ext\"),\n    col(\"target_dtl\").getField(\"target_prod_short_desc\").as(\"target_prod_short_desc\"),\n    col(\"target_dtl\").getField(\"target_gpi14_desc\").as(\"target_gpi14_desc\"),\n    col(\"target_dtl\").getField(\"target_gpi8_desc\").as(\"target_gpi8_desc\"),\n    col(\"target_dtl\").getField(\"target_formulary_tier_desc\").as(\"target_formulary_tier_desc\"),\n    col(\"target_dtl\").getField(\"target_formulary_status_desc\").as(\"target_formulary_status_desc\"),\n    col(\"target_dtl\").getField(\"target_pa_type_cd\").as(\"target_pa_type_cd\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_type_cd\").as(\"target_step_therapy_type_cd\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_group_name\").as(\"target_step_therapy_group_name\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_step_num\").as(\"target_step_therapy_step_num\"),\n    col(\"target_dtl\").getField(\"formulary_cd\").as(\"formulary_cd\"),\n    col(\"target_dtl\").getField(\"rec_crt_ts\").as(\"rec_crt_ts\"),\n    col(\"target_dtl\").getField(\"rec_crt_user_id\").as(\"rec_crt_user_id\"),\n    col(\"target_dtl\").getField(\"last_exp_dt\").as(\"last_exp_dt\"),\n    coalesce(col(\"target_dtl\").getField(\"newline\"),              lit(\"\\n\")).as(\"newline\")\n  )"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tala\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl\")"
              },
              "description" : ""
            }, {
              "target" : "ST_flag",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"ST_flag\"), lit(0))"
              },
              "description" : ""
            }, {
              "target" : "tar_group_names",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_group_names\")"
              },
              "description" : ""
            }, {
              "target" : "alt_products_def",
              "expression" : {
                "format" : "scala",
                "expression" : "transform(\n    col(\"alt_products_def\"),\n    x =>\n      struct(\n        x.getField(\"alt_prd\").as(\"alt_prd\"),\n        x.getField(\"alt_rank\").as(\"alt_rank\"),\n        coalesce(x.getField(\"rebate_elig_cd\"), lit(\"\")).as(\"rebate_elig_cd\"),\n        x.getField(\"tad_eli_code\").as(\"tad_eli_code\"),\n        x.getField(\"qty_adjust_factor\").as(\"qty_adjust_factor\"),\n        x.getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n        x.getField(\"tala\").as(\"tala\"),\n        x.getField(\"udl_nm\").as(\"udl_nm\"),\n        x.getField(\"priority\").as(\"priority\"),\n        x.getField(\"constituent_group\").as(\"constituent_group\"),\n        x.getField(\"constituent_reqd\").as(\"constituent_reqd\")\n      )\n  )"
              },
              "description" : ""
            }, {
              "target" : "constituent_grp_vec",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"constituent_grp_vec\")"
              },
              "description" : ""
            }, {
              "target" : "is_valid_rec",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"is_valid_rec\"), lit(1))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Get_Unique_Target_Products" : {
          "id" : "Get_Unique_Target_Products",
          "component" : "Join",
          "metadata" : {
            "label" : "Association_Processing__Get_Unique_Target_Products",
            "slug" : "Get_Unique_Target_Products",
            "x" : 1220,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Get_Unique_Target_Products__left",
              "slug" : "left",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Association_Processing__Get_Unique_Target_Products__right",
              "slug" : "right",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_step_num",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_exp_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Get_Unique_Target_Products__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "right",
              "expression" : {
                "format" : "scala",
                "expression" : "(col(\"left.alt_run_target_dtl_load.tal_assoc_name\") === col(\"right.tal_assoc_name\")) && (col(\n    \"left.alt_run_target_dtl_load.target_ndc\"\n  ) === col(\"right.target_ndc\"))"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "_row_id" : null,
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.alt_run_target_dtl_id\"), col(\"left.alt_run_target_dtl_load.alt_run_target_dtl_id\")), lit(-1))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.alt_run_id\"), col(\"left.alt_run_target_dtl_load.alt_run_id\")), lit(-1))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tal_assoc_name\"), col(\"left.alt_run_target_dtl_load.tal_assoc_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tala\"), col(\"left.alt_run_target_dtl_load.tala\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tar_udl\"), col(\"left.alt_run_target_dtl_load.tar_udl\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.formulary_name\"), col(\"left.alt_run_target_dtl_load.formulary_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_ndc\"), col(\"left.alt_run_target_dtl_load.target_ndc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_tier",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_tier\"), col(\"left.alt_run_target_dtl_load.target_formulary_tier\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_status",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_status\"), col(\"left.alt_run_target_dtl_load.target_formulary_status\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_pa_reqd_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_pa_reqd_ind\"), col(\"left.alt_run_target_dtl_load.target_pa_reqd_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_ind\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_specialty_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_specialty_ind\"), col(\"left.alt_run_target_dtl_load.target_specialty_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_multi_src_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_multi_src_cd\"), col(\"left.alt_run_target_dtl_load.target_multi_src_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_roa_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_roa_cd\"), col(\"left.alt_run_target_dtl_load.target_roa_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_dosage_form_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_dosage_form_cd\"), col(\"left.alt_run_target_dtl_load.target_dosage_form_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi14",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi14\"), col(\"left.alt_run_target_dtl_load.target_gpi14\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_prod_name_ext",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_prod_name_ext\"), col(\"left.alt_run_target_dtl_load.target_prod_name_ext\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_prod_short_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_prod_short_desc\"), col(\"left.alt_run_target_dtl_load.target_prod_short_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi14_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi14_desc\"), col(\"left.alt_run_target_dtl_load.target_gpi14_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi8_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi8_desc\"), col(\"left.alt_run_target_dtl_load.target_gpi8_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_tier_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_tier_desc\"), col(\"left.alt_run_target_dtl_load.target_formulary_tier_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_status_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_status_desc\"), col(\"left.alt_run_target_dtl_load.target_formulary_status_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_pa_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_pa_type_cd\"), col(\"left.alt_run_target_dtl_load.target_pa_type_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_type_cd\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_type_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_group_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_group_name\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_group_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_step_num",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_step_num\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_step_num\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "formulary_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.formulary_cd\"), col(\"left.alt_run_target_dtl_load.formulary_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.rec_crt_ts\"), col(\"left.alt_run_target_dtl_load.rec_crt_ts\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.rec_crt_user_id\"), col(\"left.alt_run_target_dtl_load.rec_crt_user_id\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "last_exp_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.last_exp_dt\"), col(\"left.alt_run_target_dtl_load.last_exp_dt\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.newline\"), col(\"left.alt_run_target_dtl_load.newline\")), lit(\"\\n\"))"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "in0",
              "alias" : "in0",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "in1",
              "alias" : "in1",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "activeTab" : "conditions",
            "columnsSelector" : [ ],
            "whereClause" : null,
            "headAlias" : "left"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Join",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "RPL" : {
          "id" : "RPL",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "Association_Processing__RPL",
            "slug" : "RPL",
            "x" : 1620,
            "y" : 440,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__RPL__in3",
              "slug" : "in3",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Association_Processing__RPL__in2",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__RPL__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsScala"
          }
        }
      }
    },
    "LKP_TAR_Exp" : {
      "id" : "LKP_TAR_Exp",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_TAR_Exp",
        "slug" : "LKP_TAR_Exp",
        "x" : 20,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_TAR_Exp__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_TAR_Exp"
      }
    },
    "Expanded_UDL_wt_rl_priority_lookup" : {
      "id" : "Expanded_UDL_wt_rl_priority_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Expanded_UDL_wt_rl_priority_lookup",
        "slug" : "Expanded_UDL_wt_rl_priority_lookup",
        "x" : 220,
        "y" : 3020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Expanded_UDL_wt_rl_priority_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "udl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "udl_nm" ],
        "valueColumns" : [ "udl_id", "udl_nm", "udl_desc", "products", "eff_dt", "term_dt", "contents", "newline" ],
        "processName" : "Expanded_UDL_wt_rl_priority"
      }
    },
    "LKP_TAC_Exp" : {
      "id" : "LKP_TAC_Exp",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_TAC_Exp",
        "slug" : "LKP_TAC_Exp",
        "x" : 20,
        "y" : 2220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_TAC_Exp__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_TAC_Exp"
      }
    },
    "Target_Load_Ready" : {
      "id" : "Target_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Target_Load_Ready",
        "slug" : "Target_Load_Ready",
        "x" : 480,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Target_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tala",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_multi_src_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prod_name_ext",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_step_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Target_Load_Ready"
      }
    },
    "Clinical_indn_Load_Ready" : {
      "id" : "Clinical_indn_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Clinical_indn_Load_Ready",
        "slug" : "Clinical_indn_Load_Ready",
        "x" : 480,
        "y" : 220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Clinical_indn_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Clinical_indn_Load_Ready"
      }
    },
    "TAD_Xwalk_lookup" : {
      "id" : "TAD_Xwalk_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "TAD_Xwalk_lookup",
        "slug" : "TAD_Xwalk_lookup",
        "x" : 220,
        "y" : 1220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TAD_Xwalk_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "target_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_selection_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_selection_ids",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tad_alt_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "rank",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "qty_adjust_factor",
                    "type" : "decimal(6,3)",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "target_gpi14" ],
        "valueColumns" : [ "target_gpi14", "alt_selection_cd", "alt_selection_ids", "tad_alt_dtls", "newline" ],
        "processName" : "TAD_Xwalk"
      }
    },
    "LKP_Step_Grp_NM" : {
      "id" : "LKP_Step_Grp_NM",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Step_Grp_NM",
        "slug" : "LKP_Step_Grp_NM",
        "x" : 20,
        "y" : 1820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Step_Grp_NM__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Step_Grp_NM"
      }
    },
    "Alt_Load_Ready" : {
      "id" : "Alt_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Alt_Load_Ready",
        "slug" : "Alt_Load_Ready",
        "x" : 480,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Alt_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_alt_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_multi_src_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_name_ext",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_short_desc_grp",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rebate_elig_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tad_eligible_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_qty_adj",
              "type" : "decimal(6,3)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tala",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_udl",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_rank",
              "type" : "decimal(38,6)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_reqd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Alt_Load_Ready"
      }
    },
    "Gpi_rank_ratio" : {
      "id" : "Gpi_rank_ratio",
      "component" : "Source",
      "metadata" : {
        "label" : "Gpi_rank_ratio",
        "slug" : "Gpi_rank_ratio",
        "x" : 20,
        "y" : 2820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Gpi_rank_ratio__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Gpi_rank_ratio"
      }
    },
    "Alt_Proxy_Load_Ready" : {
      "id" : "Alt_Proxy_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Alt_Proxy_Load_Ready",
        "slug" : "Alt_Proxy_Load_Ready",
        "x" : 480,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Alt_Proxy_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_alt_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_proxy_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Alt_Proxy_Load_Ready"
      }
    },
    "LKP_Form_CAG_dataset_lookup" : {
      "id" : "LKP_Form_CAG_dataset_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Form_CAG_dataset_lookup",
        "slug" : "LKP_Form_CAG_dataset_lookup",
        "x" : 220,
        "y" : 1620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Form_CAG_dataset_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11" ],
        "valueColumns" : [ "formulary_name", "formulary_cd", "carrier", "account", "group", "last_exp_dt", "ndc11", "formulary_tier", "formulary_status", "pa_reqd_ind", "specialty_ind", "step_therapy_ind", "formulary_tier_desc", "formulary_status_desc", "pa_type_cd", "step_therapy_type_cd", "step_therapy_group_name", "step_therapy_step_number", "newline" ],
        "processName" : "LKP_Form_CAG_dataset"
      }
    },
    "LKP_ST_GRP_NUM_with_sequence" : {
      "id" : "LKP_ST_GRP_NUM_with_sequence",
      "component" : "Script",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM_with_sequence",
        "slug" : "LKP_ST_GRP_NUM_with_sequence",
        "x" : 220,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_ST_GRP_NUM_with_sequence__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "LKP_ST_GRP_NUM_with_sequence__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "__id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n  lazy val out = in.zipWithIndex(0, 1, \"__id\", spark)\n\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
        "scriptMethodFooter" : "out"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}