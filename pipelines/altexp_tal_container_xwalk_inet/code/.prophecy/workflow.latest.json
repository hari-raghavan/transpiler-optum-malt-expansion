{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "7.1.83"
      }
    },
    "id" : "altexp_tal_container_xwalk",
    "uri" : "pipelines/altexp_tal_container_xwalk_inet",
    "language" : "scala",
    "fabricId" : "1593",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "hariprophecyioteam.transpilermaltexpansion.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions" ],
      "initialCode" : "",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "TARGET_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_CLINC_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "CAG_TAL_CONTAINER_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_PRXY_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "ALT_LOAD_READY_FILE",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "Association_Processing",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "PRODUCTS_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_ALT_REJECT_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "USER_ID",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "RUN_TS",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "ALIAS_PRODUCT_FILE",
              "kind" : {
                "type" : "int",
                "value" : 0
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "REBATE_ELIGIBLE_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "CLIN_INDCN",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "constituent_group",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "STEP_GRP_NM_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORMULARY_NM",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "GPI_RANK_RATIO",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAD_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "RULE_PRODUCTS_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "STEP_GRP_NUM_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_CAG_OVRRD_DATA_PATH",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "FORM_TARGET_REJECT_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Alternative_Rollup_Processing",
              "kind" : {
                "type" : "record",
                "fields" : [ ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "e45",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out",
    "target" : "Alt_Load_Ready",
    "targetPort" : "Alt_Load_Ready__in"
  }, {
    "id" : "e46",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out1",
    "target" : "Target_Load_Ready",
    "targetPort" : "Target_Load_Ready__in"
  }, {
    "id" : "e47",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out2",
    "target" : "Alt_Proxy_Load_Ready",
    "targetPort" : "Alt_Proxy_Load_Ready__in"
  }, {
    "id" : "e48",
    "source" : "Association_Processing",
    "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__out3",
    "target" : "Clinical_indn_Load_Ready",
    "targetPort" : "Clinical_indn_Load_Ready__in"
  }, {
    "id" : "e23",
    "source" : "Expanded_UDL",
    "sourcePort" : "Expanded_UDL__out",
    "target" : "Expanded_UDL_lookup",
    "targetPort" : "Expanded_UDL_lookup__in"
  }, {
    "id" : "e24",
    "source" : "Expanded_UDL_wt_rl_priority",
    "sourcePort" : "Expanded_UDL_wt_rl_priority__out",
    "target" : "Expanded_UDL_wt_rl_priority_lookup",
    "targetPort" : "Expanded_UDL_wt_rl_priority_lookup__in"
  }, {
    "id" : "e25",
    "source" : "Gpi_rank_ratio",
    "sourcePort" : "Gpi_rank_ratio__out",
    "target" : "Gpi_rank_ratio_lookup",
    "targetPort" : "Gpi_rank_ratio_lookup__in"
  }, {
    "id" : "e26",
    "source" : "LKP_Alias_Prod",
    "sourcePort" : "LKP_Alias_Prod__out",
    "target" : "LKP_Alias_Prod_lookup",
    "targetPort" : "LKP_Alias_Prod_lookup__in"
  }, {
    "id" : "e27",
    "source" : "LKP_CLIN_INDCN",
    "sourcePort" : "LKP_CLIN_INDCN__out",
    "target" : "LKP_CLIN_INDCN_lookup",
    "targetPort" : "LKP_CLIN_INDCN_lookup__in"
  }, {
    "id" : "e28",
    "source" : "LKP_Form_CAG_dataset",
    "sourcePort" : "LKP_Form_CAG_dataset__out",
    "target" : "LKP_Form_CAG_dataset_lookup",
    "targetPort" : "LKP_Form_CAG_dataset_lookup__in"
  }, {
    "id" : "e29",
    "source" : "LKP_Prod",
    "sourcePort" : "LKP_Prod__out",
    "target" : "LKP_Prod_lookup",
    "targetPort" : "LKP_Prod_lookup__in"
  }, {
    "id" : "e30",
    "source" : "LKP_Rebate_eligible",
    "sourcePort" : "LKP_Rebate_eligible__out",
    "target" : "LKP_Rebate_eligible_lookup",
    "targetPort" : "LKP_Rebate_eligible_lookup__in"
  }, {
    "id" : "e31",
    "source" : "LKP_Rule_Products",
    "sourcePort" : "LKP_Rule_Products__out",
    "target" : "LKP_Rule_Products_lookup",
    "targetPort" : "LKP_Rule_Products_lookup__in"
  }, {
    "id" : "e32",
    "source" : "LKP_ST_GRP_NUM",
    "sourcePort" : "LKP_ST_GRP_NUM__out",
    "target" : "LKP_ST_GRP_NUM_with_sequence",
    "targetPort" : "LKP_ST_GRP_NUM_with_sequence__in"
  }, {
    "id" : "e33",
    "source" : "LKP_ST_GRP_NUM_with_sequence",
    "sourcePort" : "LKP_ST_GRP_NUM_with_sequence__out",
    "target" : "LKP_ST_GRP_NUM_lookup",
    "targetPort" : "LKP_ST_GRP_NUM_lookup__in"
  }, {
    "id" : "e34",
    "source" : "LKP_Step_Grp_NM",
    "sourcePort" : "LKP_Step_Grp_NM__out",
    "target" : "LKP_Step_Grp_NM_lookup",
    "targetPort" : "LKP_Step_Grp_NM_lookup__in"
  }, {
    "id" : "e35",
    "source" : "LKP_TAC_Exp",
    "sourcePort" : "LKP_TAC_Exp__out",
    "target" : "LKP_TAC_Exp_lookup",
    "targetPort" : "LKP_TAC_Exp_lookup__in"
  }, {
    "id" : "e36",
    "source" : "LKP_TAR_Exp",
    "sourcePort" : "LKP_TAR_Exp__out",
    "target" : "LKP_TAR_Exp_lookup",
    "targetPort" : "LKP_TAR_Exp_lookup__in"
  }, {
    "id" : "e37",
    "source" : "TAD_Xwalk",
    "sourcePort" : "TAD_Xwalk__out",
    "target" : "TAD_Xwalk_lookup",
    "targetPort" : "TAD_Xwalk_lookup__in"
  }, {
    "id" : "e49",
    "source" : "IFIL_CAG_TAL_Container",
    "sourcePort" : "IFIL_CAG_TAL_Container__out",
    "target" : "Association_Processing",
    "targetPort" : "altexp_tal_container_xwalk__Association_Processing__in"
  } ],
  "processes" : {
    "LKP_TAR_Exp_lookup" : {
      "id" : "LKP_TAR_Exp_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_TAR_Exp_lookup",
        "slug" : "LKP_TAR_Exp_lookup",
        "x" : 220,
        "y" : 1020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_TAR_Exp_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tar_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_dtl_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "target_prdcts",
                    "type" : {
                      "type" : "array",
                      "elementType" : "binary",
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alt_contents",
                    "type" : {
                      "type" : "array",
                      "elementType" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_prdcts",
                          "type" : {
                            "type" : "array",
                            "elementType" : "binary",
                            "containsNull" : true
                          },
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prdcts_all_prio",
                          "type" : {
                            "type" : "array",
                            "elementType" : {
                              "type" : "array",
                              "elementType" : "binary",
                              "containsNull" : true
                            },
                            "containsNull" : true
                          },
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "common_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "common_alt_prdcts",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "common_target_prdcts",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "keep_all_targets",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tar_name" ],
        "valueColumns" : [ "tar_id", "tar_dtl_id", "tar_name", "tar_dtl_type_cd", "contents", "common_alt_prdcts", "common_target_prdcts", "keep_all_targets", "newline" ],
        "processName" : "LKP_TAR_Exp"
      }
    },
    "Expanded_UDL_wt_rl_priority" : {
      "id" : "Expanded_UDL_wt_rl_priority",
      "component" : "Source",
      "metadata" : {
        "label" : "Expanded_UDL_wt_rl_priority",
        "slug" : "Expanded_UDL_wt_rl_priority",
        "x" : 20,
        "y" : 3020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Expanded_UDL_wt_rl_priority__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Expanded_UDL_wt_rl_priority"
      }
    },
    "LKP_TAC_Exp_lookup" : {
      "id" : "LKP_TAC_Exp_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_TAC_Exp_lookup",
        "slug" : "LKP_TAC_Exp_lookup",
        "x" : 220,
        "y" : 2220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_TAC_Exp_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_contents",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "target_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "contents",
                    "type" : {
                      "type" : "array",
                      "elementType" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "target_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prdcts",
                          "type" : "binary",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "ST_flag",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "priority",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "containsNull" : true
                    },
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "xtra_proc_flg",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tac_name" ],
        "valueColumns" : [ "tac_id", "tac_name", "tac_contents", "eff_dt", "term_dt", "newline" ],
        "processName" : "LKP_TAC_Exp"
      }
    },
    "LKP_Rebate_eligible" : {
      "id" : "LKP_Rebate_eligible",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Rebate_eligible",
        "slug" : "LKP_Rebate_eligible",
        "x" : 20,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Rebate_eligible__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Rebate_eligible"
      }
    },
    "LKP_CLIN_INDCN" : {
      "id" : "LKP_CLIN_INDCN",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN",
        "slug" : "LKP_CLIN_INDCN",
        "x" : 20,
        "y" : 1420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_CLIN_INDCN__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_CLIN_INDCN"
      }
    },
    "LKP_Rule_Products_lookup" : {
      "id" : "LKP_Rule_Products_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Rule_Products_lookup",
        "slug" : "LKP_Rule_Products_lookup",
        "x" : 220,
        "y" : 2620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Rule_Products_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "qualifier_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "operator",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "compare_value",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "qualifier_cd", "operator", "compare_value" ],
        "valueColumns" : [ "qualifier_cd", "operator", "compare_value", "products" ],
        "processName" : "LKP_Rule_Products"
      }
    },
    "Expanded_UDL_lookup" : {
      "id" : "Expanded_UDL_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Expanded_UDL_lookup",
        "slug" : "Expanded_UDL_lookup",
        "x" : 220,
        "y" : 2020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Expanded_UDL_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "udl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "udl_nm" ],
        "valueColumns" : [ "udl_id", "udl_nm", "udl_desc", "products", "eff_dt", "term_dt", "contents", "newline" ],
        "processName" : "Expanded_UDL"
      }
    },
    "Gpi_rank_ratio_lookup" : {
      "id" : "Gpi_rank_ratio_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Gpi_rank_ratio_lookup",
        "slug" : "Gpi_rank_ratio_lookup",
        "x" : 220,
        "y" : 2820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Gpi_rank_ratio_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ratio",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "run_eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "gpi14" ],
        "valueColumns" : [ "gpi14", "rank", "ratio", "run_eff_dt" ],
        "processName" : "Gpi_rank_ratio"
      }
    },
    "LKP_Rule_Products" : {
      "id" : "LKP_Rule_Products",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Rule_Products",
        "slug" : "LKP_Rule_Products",
        "x" : 20,
        "y" : 2620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Rule_Products__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Rule_Products"
      }
    },
    "LKP_Prod" : {
      "id" : "LKP_Prod",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Prod",
        "slug" : "LKP_Prod",
        "x" : 20,
        "y" : 2420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Prod__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Prod"
      }
    },
    "LKP_ST_GRP_NUM_lookup" : {
      "id" : "LKP_ST_GRP_NUM_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM_lookup",
        "slug" : "LKP_ST_GRP_NUM_lookup",
        "x" : 480,
        "y" : 20,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_ST_GRP_NUM_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "__id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "__id" ],
        "valueColumns" : [ "tac_id", "tac_name", "priority", "_target_st_grp_num", "_alt_st_grp_nums" ],
        "processName" : "LKP_ST_GRP_NUM"
      }
    },
    "IFIL_CAG_TAL_Container" : {
      "id" : "IFIL_CAG_TAL_Container",
      "component" : "Source",
      "metadata" : {
        "label" : "IFIL_CAG_TAL_Container",
        "slug" : "IFIL_CAG_TAL_Container",
        "x" : 20,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "IFIL_CAG_TAL_Container__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/IFIL_CAG_TAL_Container"
      }
    },
    "LKP_Form_CAG_dataset" : {
      "id" : "LKP_Form_CAG_dataset",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Form_CAG_dataset",
        "slug" : "LKP_Form_CAG_dataset",
        "x" : 20,
        "y" : 1620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Form_CAG_dataset__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Form_CAG_dataset"
      }
    },
    "TAD_Xwalk" : {
      "id" : "TAD_Xwalk",
      "component" : "Source",
      "metadata" : {
        "label" : "TAD_Xwalk",
        "slug" : "TAD_Xwalk",
        "x" : 20,
        "y" : 1220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "TAD_Xwalk__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/TAD_Xwalk"
      }
    },
    "LKP_Alias_Prod" : {
      "id" : "LKP_Alias_Prod",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Alias_Prod",
        "slug" : "LKP_Alias_Prod",
        "x" : 20,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Alias_Prod__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Alias_Prod"
      }
    },
    "LKP_Alias_Prod_lookup" : {
      "id" : "LKP_Alias_Prod_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Alias_Prod_lookup",
        "slug" : "LKP_Alias_Prod_lookup",
        "x" : 220,
        "y" : 620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Alias_Prod_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alias_set_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alias_label_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11" ],
        "valueColumns" : [ "alias_set_name", "ndc11", "alias_label_nm", "newline" ],
        "processName" : "LKP_Alias_Prod"
      }
    },
    "LKP_Rebate_eligible_lookup" : {
      "id" : "LKP_Rebate_eligible_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Rebate_eligible_lookup",
        "slug" : "LKP_Rebate_eligible_lookup",
        "x" : 220,
        "y" : 820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Rebate_eligible_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "dl_bit",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rebate_elig_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "dl_bit" ],
        "valueColumns" : [ "dl_bit", "rebate_elig_cd" ],
        "processName" : "LKP_Rebate_eligible"
      }
    },
    "Expanded_UDL" : {
      "id" : "Expanded_UDL",
      "component" : "Source",
      "metadata" : {
        "label" : "Expanded_UDL",
        "slug" : "Expanded_UDL",
        "x" : 20,
        "y" : 2020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Expanded_UDL__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Expanded_UDL"
      }
    },
    "LKP_ST_GRP_NUM" : {
      "id" : "LKP_ST_GRP_NUM",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM",
        "slug" : "LKP_ST_GRP_NUM",
        "x" : 20,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_ST_GRP_NUM__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_ST_GRP_NUM"
      }
    },
    "LKP_CLIN_INDCN_lookup" : {
      "id" : "LKP_CLIN_INDCN_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN_lookup",
        "slug" : "LKP_CLIN_INDCN_lookup",
        "x" : 220,
        "y" : 1420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_CLIN_INDCN_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_assoc_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tal_assoc_name" ],
        "valueColumns" : [ "tal_assoc_id", "tal_assoc_name", "clinical_indn_id", "clinical_indn_name", "clinical_indn_desc", "rank" ],
        "processName" : "LKP_CLIN_INDCN"
      }
    },
    "LKP_Step_Grp_NM_lookup" : {
      "id" : "LKP_Step_Grp_NM_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Step_Grp_NM_lookup",
        "slug" : "LKP_Step_Grp_NM_lookup",
        "x" : 220,
        "y" : 1820,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Step_Grp_NM_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_names",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11", "step_therapy_step_number" ],
        "valueColumns" : [ "ndc11", "step_therapy_step_number", "step_therapy_group_names" ],
        "processName" : "LKP_Step_Grp_NM"
      }
    },
    "LKP_Prod_lookup" : {
      "id" : "LKP_Prod_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Prod_lookup",
        "slug" : "LKP_Prod_lookup",
        "x" : 220,
        "y" : 2420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Prod_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "dl_bit",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "status_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "inactive_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "msc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "drug_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rx_otc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "desi",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_strength",
              "type" : "decimal(14,5)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "repack_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "dl_bit" ],
        "valueColumns" : [ "dl_bit", "ndc11", "gpi14", "status_cd", "inactive_dt", "msc", "drug_name", "rx_otc", "desi", "roa_cd", "dosage_form_cd", "prod_strength", "repack_cd", "prod_short_desc", "gpi14_desc", "gpi8_desc", "newline" ],
        "processName" : "LKP_Prod"
      }
    },
    "Association_Processing" : {
      "id" : "Association_Processing",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "Association_Processing",
        "slug" : "Association_Processing",
        "x" : 220,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "altexp_tal_container_xwalk__Association_Processing__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_constituent_prdcts",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "alt_prdcts",
                    "type" : "binary",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_group",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "constituent_reqd",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "udl_nm",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "shared_qual",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "override_tar_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_grp_vec",
              "type" : {
                "type" : "array",
                "elementType" : "string",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out3",
          "slug" : "out3"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out2",
          "slug" : "out2"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out1",
          "slug" : "out1"
        }, {
          "id" : "altexp_tal_container_xwalk__Association_Processing__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "e44",
        "source" : "RPL",
        "sourcePort" : "Association_Processing__RPL__out",
        "target" : "Tranform_Proxy_DTL_Layout",
        "targetPort" : "Association_Processing__Tranform_Proxy_DTL_Layout__in"
      }, {
        "id" : "e51",
        "source" : "Alternative_Rollup_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out",
        "target" : "RPL",
        "targetPort" : "Association_Processing__RPL__in3"
      }, {
        "id" : "e52",
        "source" : "Alternative_Rollup_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1",
        "target" : "RPL",
        "targetPort" : "Association_Processing__RPL__in2"
      }, {
        "id" : "e39",
        "source" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__out",
        "target" : "Get_Unique_Target_Products",
        "targetPort" : "Association_Processing__Get_Unique_Target_Products__left"
      }, {
        "id" : "e38",
        "source" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
        "sourcePort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__out",
        "target" : "Get_Unique_Target_Products",
        "targetPort" : "Association_Processing__Get_Unique_Target_Products__right"
      }, {
        "id" : "e18",
        "source" : "Rank_AltsReformat_0",
        "sourcePort" : "Association_Processing__Rank_AltsReformat_0__out",
        "target" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
        "targetPort" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__in"
      }, {
        "id" : "e22",
        "source" : "Normalize_TAL_Target_Drugs",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
        "target" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
        "targetPort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__in"
      }, {
        "id" : "e16",
        "source" : "Rank_AltsReformat_1",
        "sourcePort" : "Association_Processing__Rank_AltsReformat_1__out",
        "target" : "Normalize_TAL_Target_Drugs",
        "targetPort" : "Association_Processing__Normalize_TAL_Target_Drugs__in"
      }, {
        "id" : "e21",
        "source" : "Normalize_TAL_Target_Drugs",
        "sourcePort" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
        "target" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
        "targetPort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__in"
      }, {
        "id" : "e20",
        "source" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
        "sourcePort" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__out",
        "target" : "Normalize_TAL_Alts_assign_attributes",
        "targetPort" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__in"
      }, {
        "id" : "e19",
        "source" : "Rank_Alts_RowDistributor",
        "sourcePort" : "Association_Processing__Rank_Alts_RowDistributor__out0",
        "target" : "Rank_AltsReformat_0",
        "targetPort" : "Association_Processing__Rank_AltsReformat_0__in"
      }, {
        "id" : "e15",
        "source" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
        "sourcePort" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__out",
        "target" : "Rank_Alts_RowDistributor",
        "targetPort" : "Association_Processing__Rank_Alts_RowDistributor__in"
      }, {
        "id" : "e17",
        "source" : "Rank_Alts_RowDistributor",
        "sourcePort" : "Association_Processing__Rank_Alts_RowDistributor__out1",
        "target" : "Rank_AltsReformat_1",
        "targetPort" : "Association_Processing__Rank_AltsReformat_1__in"
      }, {
        "id" : "e9",
        "source" : "Get_Unique_Target_Products",
        "sourcePort" : "Association_Processing__Get_Unique_Target_Products__out",
        "target" : "Normalize_Clinical_Indication",
        "targetPort" : "Association_Processing__Normalize_Clinical_Indication__in"
      }, {
        "id" : "e53",
        "source" : "Normalize_TAL_Alts_assign_attributes",
        "sourcePort" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__out",
        "target" : "Alternative_Rollup_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in"
      }, {
        "id" : "WFaQo0HRjca8jm_Z9HDo7",
        "source" : "Normalize_Clinical_Indication",
        "sourcePort" : "Association_Processing__Normalize_Clinical_Indication__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out3"
      }, {
        "id" : "fEW2DUfqbvxct1Lbrx7b6",
        "source" : "Tranform_Proxy_DTL_Layout",
        "sourcePort" : "Association_Processing__Tranform_Proxy_DTL_Layout__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out2"
      }, {
        "id" : "NiagWL--e5Gchv8aybavP",
        "source" : "RPL",
        "sourcePort" : "Association_Processing__RPL__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out"
      }, {
        "id" : "wwQ48jTtKt4qh7csHgz78",
        "source" : "Association_Processing",
        "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__in",
        "target" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
        "targetPort" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__in"
      }, {
        "id" : "vMBQgp16srL9VDsNOm9Jt",
        "source" : "Get_Unique_Target_Products",
        "sourcePort" : "Association_Processing__Get_Unique_Target_Products__out",
        "target" : "Association_Processing",
        "targetPort" : "altexp_tal_container_xwalk__Association_Processing__out1"
      } ],
      "processes" : {
        "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat" : {
          "id" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
            "slug" : "Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat",
            "x" : 160,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : "binary",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_constituent_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prdcts",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Apply_TAC_TAR_on_STD_Assoc_and_create_target_alternatives_pair_Reformat__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "  //\n  // @TODO: Parse error: 'CustomParserError(1420:1,Parse Error: starting at\n  // out::reformat(in)=\n  // ^)'\n  //\n  // type qual_priority_t =\n  // record\n  //   string(int) qual;\n  //   decimal(\"\") priority;\n  // end;\n  // constant string(int)[int] OVERRIDE_QUALIFIERS = [vector 'DESI_CD', 'DOSAGE_FORM', 'MSC', 'ROA', 'RXOTC' ];\n  // constant qual_priority_t[int] QUAL_PRIORITY =[vector [record  qual \"NDC11\"        priority \"1\"],\n  //                                                       [record qual \"NDC9\"         priority \"2\"],\n  //                                                       [record qual \"NDC5\"         priority \"3\"],\n  //                                                       [record qual \"GPI14\"        priority \"4\"],\n  //                                                       [record qual \"GPI12\"        priority \"5\"],\n  //                                                       [record qual \"GPI10\"        priority \"6\"],\n  //                                                       [record qual \"DOSAGE_FORM\"  priority \"7\"],\n  //                                                       [record qual \"ROA\"          priority \"8\"],\n  //                                                       [record qual \"DRUG_NAME\"    priority \"9\"],\n  //                                                       [record qual \"GPI8\"         priority \"10\"],\n  //                                                       [record qual \"GPI6\"         priority \"11\"],\n  //                                                       [record qual \"GPI4\"         priority \"12\"],\n  //                                                       [record qual \"MSC\"          priority \"13\"],\n  //                                                       [record qual \"RXOTC\"        priority \"14\"],\n  //                                                       [record qual \"DAYS_UNTIL_DRUG_STATUS_INACTIVE\" priority \"15\"] ,\n  //                                                       [record qual \"STATUS_CD\"  priority   \"16\"],\n  //                                                       [record qual \"REPACKAGER\"   priority \"17\"],\n  //                                                       [record qual \"DESI_CD\"    priority   \"18\"]];\n  // type drug_data_set_dtl_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) rxclaim_env_name ;\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=10) drug_data_set_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) drug_data_set_id ;\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   string(\"\\x01\", maximum_length=14) gpi14 ;\n  //   string(\"\\x01\", maximum_length=1) status_cd ;\n  //   string(\"\\x01\", maximum_length=8) eff_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) term_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) msc ;\n  //   string(\"\\x01\", maximum_length=70) drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=3) rx_otc ;\n  //   string(\"\\x01\", maximum_length=1) rx_otc_cd ;\n  //   string(\"\\x01\", maximum_length=1) desi ;\n  //   string(\"\\x01\", maximum_length=2) roa_cd ;\n  //   string(\"\\x01\", maximum_length=4) dosage_form_cd ;\n  //   decimal(\"\\x01\".5, maximum_length=15) prod_strength ;\n  //   string(\"\\x01\", maximum_length=1) repack_cd ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi8_desc ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type user_defined_list_rule_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) user_defined_list_id ;\n  //   string(\"\\x01\", maximum_length=20) user_defined_list_name ;\n  //   string(\"\\x01\", maximum_length=60) user_defined_list_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=10) user_defined_list_rule_id ;\n  //   string(\"\\x01\", maximum_length=4000) rule = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) incl_cd ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type rule_xwalk_t=\n  // record\n  //   decimal(\"\\x01\") udl_id;\n  //   decimal(\"\\x01\") udl_rule_id;\n  //   string(\"\\x01\") udl_nm;\n  //   string(\"\\x01\") udl_desc;\n  //   decimal(\"\\x01\") rule_priority;\n  //   string(1) inclusion_cd;\n  //   string(int) qualifier_cd;\n  //   string(int) operator;\n  //   string(int) compare_value;\n  //   string(1) conjunction_cd;\n  //   decimal(\"\\x01\") rule_expression_id;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type udl_mstr_xwalk_t=\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) udl_id;\n  //   string(\"\\x01\", maximum_length=20) udl_nm;\n  //   string(\"\\x01\", maximum_length=60) user_defined_list_desc;\n  //   string(int)[int] qual_list;\n  //   decimal(1) override_flg;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type product_lkp_t =\n  // record\n  //   int dl_bit;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  desi ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   decimal(\"\\x01\".5, maximum_length=15) prod_strength ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi8_desc ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type nrmlz_dataset_qual_t =\n  // record\n  //   int dl_bit;\n  //   string(int) qualifier_cd;\n  //   string(int) compare_value = NULL;\n  // end;\n  // type rule_product_lkp_t =\n  // record\n  //   string(int) qualifier_cd;\n  //   string(int) operator;\n  //   string(int) compare_value;\n  //   bit_vector_t products;\n  // end;\n  // type cag_ovrrd_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20)  carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) eff_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) term_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  desi ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   decimal(\"\\x01\".5, maximum_length=15) prod_strength ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi8_desc ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type cag_ovrrd_ref_file_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20)  carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  group = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=1) is_future_snap = 0;\n  //   string(\"\\x01\") data_path;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type udl_exp_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) udl_id;\n  //   string(\"\\x01\", maximum_length=20) udl_nm;\n  //   string(\"\\x01\", maximum_length=60) udl_desc;\n  //   bit_vector_t products;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   bit_vector_t[int] contents;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=60) tal_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_dtl_type_cd ;\n  //   string(\"\\x01\", maximum_length=20) nested_tal_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name = NULL(\"\") ;\n  //   decimal(\"\\x01\", 6, maximum_length=39) priority ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_assoc_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=60) tal_assoc_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   string(\"\\x01\", maximum_length=20) target_udl_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) alt_udl_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_rank = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=2) constituent_group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) constituent_reqd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tac_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_id ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   string(\"\\x01\", maximum_length=4000) target_rule = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4000) alt_rule = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tac_rule_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_id ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   record\n  //    string(int) qualifier_cd;\n  //    string(int) operator;\n  //    string(int) compare_value;\n  //    string(1) conjunction_cd;\n  //   end[int] target_rule_def;\n  //   record\n  //    string(int) qualifier_cd;\n  //    string(int) operator;\n  //    string(int) compare_value;\n  //    string(1) conjunction_cd;\n  //   end[int] alt_rule_def;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type contents_alt_st =\n  // record\n  //  bit_vector_t target_prdcts;\n  //  bit_vector_t alternate_prdcts;\n  //  string(\"\\x01\", maximum_length=40) tal_assoc_name;\n  // end;\n  // type tac_st_contents =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id;\n  //   contents_alt_st[int] step_contents;\n  //   string(1) newline = '\\n';\n  // end;\n  // type contents_t =\n  // record\n  //   bit_vector_t target_prdcts;\n  //   bit_vector_t alt_prdcts;\n  //   decimal(1) ST_flag =0;\n  //   decimal(1) priority;\n  // end;\n  // type tac_contents_t =\n  // record\n  //  bit_vector_t target_prdcts;\n  //  bit_vector_t alt_prdcts;\n  //  contents_t[int] contents;\n  //  decimal(1) xtra_proc_flg = 0;\n  // end;\n  // type tac_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_id ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   tac_contents_t[int] tac_contents;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = '\\n';\n  // end;\n  // type tal_container_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   int target_dl_bit;\n  //   record\n  //    int alt_prd;\n  //    int alt_rank;\n  //   end[int] alt_prdcts;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type target_udl_products_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) target_udl_name = NULL(\"\") ;\n  //   bit_vector_t target_products;\n  // end;\n  // type alt_udl_products_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) alt_udl_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_rank = NULL(\"\") ;\n  //   bit_vector_t alt_products;\n  // end;\n  // type alt_exclusion_products_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   bit_vector_t target_product_dtl;\n  //   bit_vector_t alt_product_dtl;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_assoc_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=10) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=10) override_tar_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   target_udl_products_t[int] target_udl_products;\n  //   alt_udl_products_t[int] alt_udl_products;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type form_data_set_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) formulary_data_set_id ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=20) formulary_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=10) formulary_cd = \"\" ;\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) rxclaim_env_name ;\n  //   string(\"\\x01\", maximum_length=20) customer_name = NULL(\"\");\n  //   date(\"YYYYMMDD\")(\"\\x01\") last_exp_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=10) formulary_data_set_dtl_id ;\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   string(\"\\x01\", maximum_length=2) formulary_tier ;\n  //   string(\"\\x01\", maximum_length=2) formulary_status ;\n  //   string(\"\\x01\", maximum_length=1) pa_reqd_ind ;\n  //   string(\"\\x01\", maximum_length=1) specialty_ind ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_ind ;\n  //   string(\"\\x01\", maximum_length=50) formulary_tier_desc ;\n  //   string(\"\\x01\", maximum_length=50) formulary_status_desc ;\n  //   string(\"\\x01\", maximum_length=1) pa_type_cd ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_type_cd ;\n  //   string(\"\\x01\", maximum_length=100) step_therapy_group_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) step_therapy_step_number = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type form_ovrrd_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=10) formulary_cd = \"\" ;\n  //   string(\"\\x01\", maximum_length=20)  carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  group = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") last_exp_dt ;\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   string(\"\\x01\", maximum_length=2) formulary_tier ;\n  //   string(\"\\x01\", maximum_length=2) formulary_status ;\n  //   string(\"\\x01\", maximum_length=1) pa_reqd_ind ;\n  //   string(\"\\x01\", maximum_length=1) specialty_ind ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_ind ;\n  //   string(\"\\x01\", maximum_length=50) formulary_tier_desc ;\n  //   string(\"\\x01\", maximum_length=50) formulary_status_desc ;\n  //   string(\"\\x01\", maximum_length=1) pa_type_cd ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_type_cd ;\n  //   string(\"\\x01\", maximum_length=100) step_therapy_group_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) step_therapy_step_number = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type form_ovrrd_ref_file_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=20)  carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20)  group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) customer_name = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=1) is_future_snap = 0;\n  //   string(\"\\x01\") data_path;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type output_profile_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_id ;\n  //   string(\"\\x01\", maximum_length=20) rxclaim_env_name ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=20) formulary_id = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_form_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_job_dtl_id ;\n  //   string(\"\\x01\", maximum_length=20) output_profile_name ;\n  //   string(\"\\x01\", maximum_length=20) alias_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alias_priority = NULL ;\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   string(\"\\x01\", maximum_length=20) tar_name ;\n  //   string(\"\\x01\", maximum_length=20) tsd_name ;\n  //   decimal(\"\\x01\",0, maximum_length=10) job_id ;\n  //   string(\"\\x01\", maximum_length=20) job_name ;\n  //   string(\"\\x01\", maximum_length=20) customer_name = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=39) run_day = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) lob_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4) run_jan1_start_mmdd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4) run_jan1_end_mmdd = NULL(\"\") ;\n  //   decimal(\"\\x01\") future_flg = 0;\n  //   string(\"\\x01\", maximum_length=30) formulary_pseudonym = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=10) notes_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=60) output_profile_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39 ) formulary_option_cd ;\n  //   string(\"\\x01\", maximum_length=20) layout_name ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) st_tac_ind ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type form_product_t =\n  // record\n  //   string(\"\\x01\", maximum_length=10) formulary_cd = \"\" ;\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   string(\"\\x01\", maximum_length=2) formulary_tier ;\n  //   string(\"\\x01\", maximum_length=2) formulary_status ;\n  //   string(\"\\x01\", maximum_length=1) pa_reqd_ind ;\n  //   string(\"\\x01\", maximum_length=1) specialty_ind ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_ind ;\n  //   string(\"\\x01\", maximum_length=50) formulary_tier_desc ;\n  //   string(\"\\x01\", maximum_length=50) formulary_status_desc ;\n  //   string(\"\\x01\", maximum_length=1) pa_type_cd ;\n  //   string(\"\\x01\", maximum_length=1) step_therapy_type_cd ;\n  //   string(\"\\x01\", maximum_length=100) step_therapy_group_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) step_therapy_step_number = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") last_exp_dt ;\n  // end;\n  // type cag_product_t =\n  // record\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   string(\"\\x01\", maximum_length=14) gpi14 ;\n  //   string(\"\\x01\", maximum_length=1) status_cd ;\n  //   string(\"\\x01\", maximum_length=8) eff_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) term_dt = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(\"\\x01\", maximum_length=1) msc ;\n  //   string(\"\\x01\", maximum_length=70) drug_name ;\n  //   string(\"\\x01\", maximum_length=3) rx_otc ;\n  //   string(\"\\x01\", maximum_length=1) desi ;\n  //   string(\"\\x01\", maximum_length=2) roa_cd ;\n  //   string(\"\\x01\", maximum_length=4) dosage_form_cd ;\n  //   decimal(\"\\x01\".5, maximum_length=15) prod_strength ;\n  //   string(\"\\x01\", maximum_length=1) repack_cd ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi8_desc ;\n  // end;\n  // type cag_rlp_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //   decimal(1) cag_priority = 0;\n  //   cag_product_t[int] prdcts;\n  // end;\n  // type form_rlp_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) customer_name = NULL(\"\");\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //   decimal(1) cag_priority = 0;\n  //   form_product_t[int] prdcts;\n  // end;\n  // type tsd_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tsd_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tsd_id ;\n  //   string(\"\\x01\", maximum_length=20) tsd_name ;\n  //   string(\"\\x01\", maximum_length=30) tsd_cd ;\n  //   string(\"\\x01\", maximum_length=2) formulary_tier ;\n  //   string(\"\\x01\", maximum_length=2) formulary_status ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tsd_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tsd_id ;\n  //   string(\"\\x01\", maximum_length=30) tsd_cd ;\n  //   bit_vector_t products;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_constituent_prdct_t =\n  // record\n  //   bit_vector_t alt_prdcts;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   string(20) udl_nm = NULL(\"\");\n  // end;\n  // type tal_container_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) tar_udl_nm = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=60) tal_desc ;\n  //   decimal(\"\\x01\", 6, maximum_length=39) priority ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   bit_vector_t[int] target_prdcts;\n  //   alt_constituent_prdct_t[int] alt_constituent_prdcts;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(2)[int] constituent_grp_vec;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type master_cag_mapping_t =\n  // record\n  //   string(\"\\x01\") carrier = NULL(\"\") ;\n  //   string(\"\\x01\") account = NULL(\"\") ;\n  //   string(\"\\x01\") group = NULL(\"\") ;\n  //   string(\"\\x01\") future_flg = 'C';\n  //   string(\"\\x01\") cag_override_data_path= NULL(\"\");\n  //   decimal(\"\\x01\")[int] qual_output_profile_ids ;\n  //   record\n  //     string(\"\\x01\") qual_output_profile_name ;\n  //     string(\"\\x01\") rxclaim_env_name;\n  //     decimal(\"\\x01\") [int] job_ids;\n  //     string(\"\\x01\") [int] alias_names;\n  //     string(\"\\x01\") [int] job_names;\n  //     string(\"\\x01\") [int] formulary_names ;\n  //     string(\"\\x01\") [int] form_override_data_paths;\n  //     string(\"\\x01\", maximum_length=30)[int] formulary_pseudonyms;\n  //     string(\"\\x01\", maximum_length=20) tal_name ;\n  //     string(\"\\x01\") tac_name ;\n  //     string(\"\\x01\") tar_name ;\n  //     string(\"\\x01\") tsd_name ;\n  //     string(\"\\x01\", maximum_length=1) st_tac_ind ;\n  //   end[int] op_dtls;\n  //   record\n  //     decimal(\"\\x01\") non_qual_op_id;\n  //     string(\"\\x01\") rxclaim_env_name;\n  //     decimal(\"\\x01\") [int] job_ids;\n  //     string(\"\\x01\")[int] formulary_names;\n  //     string(\"\\x01\", maximum_length=30)[int] formulary_pseudonyms;\n  //     string(\"\\x01\") [int] alias_names;\n  //     string(\"\\x01\") [int] job_names;\n  //   end[int] non_qual_output_profile_ids ;\n  //   string(\"\\x01\") [int] err_msgs;\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_dt = NULL(\"\");\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tar_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_dtl_id ;\n  //   string(\"\\x01\", maximum_length=20) tar_name ;\n  //   string(\"\\x01\", maximum_length=1) sort_ind ;\n  //   string(\"\\x01\", maximum_length=1) filter_ind ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tar_dtl_type_cd ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_roa_df_set_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4000) target_rule = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4000) alt_rule = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=15) rebate_elig_cd = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tar_roa_df_set_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_roa_df_set_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_roa_df_set_id ;\n  //   string(\"\\x01\", maximum_length=2) target_roa_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4) target_dosage_form_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=2) alt_roa_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=4) alt_dosage_form_cd = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tar_rule_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_dtl_id ;\n  //   string(\"\\x01\", maximum_length=20) tar_name ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_roa_df_set_id = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=39) tar_dtl_type_cd ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   string(\"\\x01\", maximum_length=1) sort_ind ;\n  //   string(\"\\x01\", maximum_length=1) filter_ind ;\n  //   string(\"\\x01\", maximum_length=15) rebate_elig_cd = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   record\n  //    string(int) qualifier_cd;\n  //    string(int) operator;\n  //    string(int) compare_value;\n  //    string(1) conjunction_cd;\n  //   end[int] target_rule_def;\n  //   record\n  //     string(int) qualifier_cd;\n  //     string(int) operator;\n  //     string(int) compare_value;\n  //     string(1) conjunction_cd;\n  //   end[int] alt_rule_def;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_run_alt_dtl_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_alt_dtl_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_id = -1;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_target_dtl_id = -1 ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  //   string(\"\\x01\", maximum_length=11) alt_ndc ;\n  //   string(\"\\x01\", maximum_length=2) alt_formulary_tier ;\n  //   string(\"\\x01\", maximum_length=1) alt_multi_src_cd ;\n  //   string(\"\\x01\", maximum_length=2) alt_roa_cd ;\n  //   string(\"\\x01\", maximum_length=4) alt_dosage_form_cd ;\n  //   decimal(\"\\x01\",0, maximum_length=39 ) rank ;\n  //   string(\"\\x01\", maximum_length=1) alt_step_therapy_ind ;\n  //   string(\"\\x01\", maximum_length=1) alt_pa_reqd_ind ;\n  //   string(\"\\x01\", maximum_length=2) alt_formulary_status ;\n  //   string(\"\\x01\", maximum_length=1) alt_specialty_ind ;\n  //   string(\"\\x01\", maximum_length=14) alt_gpi14 ;\n  //   string(\"\\x01\", maximum_length=70) alt_prod_name_ext ;\n  //   string(\"\\x01\", maximum_length=30) alt_prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=30) alt_prod_short_desc_grp;\n  //   string(\"\\x01\", maximum_length=60) alt_gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) alt_gpi8_desc ;\n  //   string(\"\\x01\", maximum_length=50) alt_formulary_tier_desc ;\n  //   string(\"\\x01\", maximum_length=50) alt_formulary_status_desc ;\n  //   string(\"\\x01\", maximum_length=1) alt_pa_type_cd ;\n  //   string(\"\\x01\", maximum_length=1) alt_step_therapy_type_cd ;\n  //   string(\"\\x01\", maximum_length=1000) alt_step_therapy_group_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=100) alt_step_therapy_step_number = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   string(\"\\x01\", maximum_length=15) rebate_elig_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=15) tad_eligible_cd= NULL(\"\");\n  //   decimal(\"\\x01\".3, maximum_length=7) alt_qty_adj = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=40) tala = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) alt_udl = NULL(\"\") ;\n  //   decimal(\"\\x01\".6, maximum_length=39) tal_assoc_rank ;\n  //   string(\"\\x01\", maximum_length=2) constituent_group = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) constituent_reqd = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_run_target_dtl_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_target_dtl_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_id  = -1 ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=40) tala = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) tar_udl = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  //   string(\"\\x01\", maximum_length=2) target_formulary_tier ;\n  //   string(\"\\x01\", maximum_length=2) target_formulary_status ;\n  //   string(\"\\x01\", maximum_length=1) target_pa_reqd_ind ;\n  //   string(\"\\x01\", maximum_length=1) target_step_therapy_ind ;\n  //   string(\"\\x01\", maximum_length=1) target_specialty_ind ;\n  //   string(\"\\x01\", maximum_length=1) target_multi_src_cd ;\n  //   string(\"\\x01\", maximum_length=2) target_roa_cd ;\n  //   string(\"\\x01\", maximum_length=4) target_dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=14) target_gpi14 ;\n  //   string(\"\\x01\", maximum_length=70) target_prod_name_ext ;\n  //   string(\"\\x01\", maximum_length=30) target_prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) target_gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=60) target_gpi8_desc ;\n  //   string(\"\\x01\", maximum_length=50) target_formulary_tier_desc ;\n  //   string(\"\\x01\", maximum_length=50) target_formulary_status_desc ;\n  //   string(\"\\x01\", maximum_length=1) target_pa_type_cd ;\n  //   string(\"\\x01\", maximum_length=1) target_step_therapy_type_cd ;\n  //   string(\"\\x01\", maximum_length=1000) target_step_therapy_group_name = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) target_step_therapy_step_num = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=10) formulary_cd = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") last_exp_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_run_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") run_start_ts = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") run_complete_ts = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_run_status_cd ;\n  //   string(\"\\x01\", maximum_length=1) published_ind ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_last_upd_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_last_upd_user_id ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_dt = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_run_load_adhoc_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") run_start_ts = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") run_complete_ts = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_run_status_cd ;\n  //   string(\"\\x01\", maximum_length=1) published_ind ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_last_upd_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_last_upd_user_id ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_run_t =\n  // record\n  //   decimal(\"|\") alt_run_id ;\n  //   decimal(\"|\") output_profile_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"|\") run_start_ts = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"|\") run_complete_ts = NULL(\"\") ;\n  //   decimal(\"|\") alt_run_status_cd ;\n  //   string(\"|\") published_ind ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"|\") rec_crt_ts ;\n  //   string(\"|\") rec_crt_user_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"|\") rec_last_upd_ts ;\n  //   string(\"|\") rec_last_upd_user_id ;\n  //   date(\"YYYYMMDD\")(\"\\n\") run_eff_dt ;\n  // end;\n  // type alt_run_alt_proxy_dtl_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_id = -1;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_alt_dtl_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_target_dtl_id = -1 ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=11) alt_proxy_ndc ;\n  //   decimal(\"\\x01\",0, maximum_length=39 ) rank ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type file_load_cntl_load_t =\n  // record\n  //   string(\"\\x01\", maximum_length=50) user_id ;\n  //   string(\"\\x01\", maximum_length=1) file_load_type_cd ;\n  //   decimal(\"\\x01\",0, maximum_length=39) component_type_cd = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) file_load_status_cd ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") file_load_start_ts = NULL(\"\") ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   string(\"\\x01\", maximum_length=1) published_ind ;\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type file_load_ctl_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) file_load_cntl_id ;\n  //   string(\"\\x01\", maximum_length=4000) component_ids = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_date ;\n  //   string(\"\\x01\", maximum_length=20) rxclaim_env_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) carrier = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) account = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) group = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) component_type_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=512) file_name_w = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=1) published_ind ;\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=512) report_file_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type file_load_err_dtl_load_t =\n  // record\n  //   decimal(\",\",0, maximum_length=16) file_load_cntl_id ;\n  //   string(\",\", maximum_length=1024) err_desc ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\",\") rec_crt_ts ;\n  //   string(\",\", maximum_length=30) rec_crt_user_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\",\") rec_last_upd_ts ;\n  //   string(\"\\n\", maximum_length=30) rec_last_upd_user_id ;\n  // end;\n  // type tal_assoc_prdcts_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   bit_vector_t[int] target_prdcts;\n  //   bit_vector_t[int] alt_prdcts;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type part_exp_master_file_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) file_load_cntl_id ;\n  //   string(\"\\x01\", maximum_length=1024) component_ids ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_date ;\n  //   string(\"\\x01\", maximum_length=20) rxclaim_env_name = \"\" ;\n  //   string(\"\\x01\", maximum_length=50) cag_in = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=50) cag_out = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39, sign_reserved) component_type_cd = NULL(\"\") ;\n  //   utf8 string(\"\\x01\", maximum_length=512) file_name_w = NULL(\"\") ;\n  //   utf8 string(\"\\x01\", maximum_length=1) published_ind ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alt_rank_t =\n  // record\n  //   int alt_rank;\n  //   int[int] alt_prdcts;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   string(20) udl_nm = NULL(\"\");\n  // end;\n  // type rebate_elig_contents_t =\n  // record\n  //   string(\"\\x01\") rebate_elig_cd;\n  //   int[int] rebate_elig_prdcts;\n  // end;\n  // type target_prdct_t =\n  // record\n  //   int target_dl_bit;\n  //   decimal('\\x01') bucket_index = 0;\n  //   decimal('\\x01') udl_index = 0;\n  //   decimal('\\x01') tac_index = 0;\n  //   alt_rank_t[int] alt_prdcts_rank;\n  //   string(\"\\x01\")has_alt;\n  //   decimal(1) ST_flag = 0;\n  // end;\n  // type tal_assoc_adhoc_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=2000) clinical_indn_desc = NULL(\"\");\n  //   string(\"\\x01\", maximum_length=60) tal_assoc_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   record\n  //     string(\"\\x01\", maximum_length=20) udl_nm;\n  //     string(\"\\x01\", maximum_length=60) udl_desc;\n  //     bit_vector_t products;\n  //   end[int] target_udl_info ;\n  //   record\n  //      string(\"\\x01\", maximum_length=20) udl_nm;\n  //      string(\"\\x01\", maximum_length=60) udl_desc;\n  //      bit_vector_t products;\n  //      string(2) constituent_group = NULL(\"\");\n  //      string(1) constituent_reqd = NULL(\"\");\n  //      decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\");\n  //   end[int] alt_udl_info;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_container_adhoc_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=2000) clinical_indn_desc = NULL(\"\");\n  //   string(\"\\x01\", maximum_length=60) tal_desc ;\n  //   string(\"\\x01\", maximum_length=60) tal_assoc_desc ;\n  //   decimal(\"\\x01\", 6, maximum_length=39) priority ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   record\n  //       string(\"\\x01\", maximum_length=20) udl_nm;\n  //       string(\"\\x01\", maximum_length=60) udl_desc;\n  //       bit_vector_t products;\n  //   end[int] target_prdcts;\n  //   record\n  //       string(\"\\x01\", maximum_length=20) udl_nm;\n  //       string(\"\\x01\", maximum_length=60) udl_desc;\n  //       bit_vector_t products;\n  //       string(2) constituent_group = NULL(\"\");\n  //       string(1) constituent_reqd = NULL(\"\");\n  //       decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\");\n  //   end[int] alt_prdcts;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_assoc_adhoc_enrich_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=2000) clinical_indn_desc = NULL(\"\");\n  //   string(\"\\x01\", maximum_length=60) tal_assoc_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   string(\"\\x01\", maximum_length=20) udl_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=60) udl_desc;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   bit_vector_t products;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_rank = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\");\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_container_adhoc_enrich_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=2000) clinical_indn_desc = NULL(\"\");\n  //   string(\"\\x01\", maximum_length=60) tal_desc ;\n  //   string(\"\\x01\", maximum_length=60) tal_assoc_desc ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   decimal(\"\\x01\", 6, maximum_length=39) tal_assoc_rank = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) udl_id = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=60) udl_desc;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   bit_vector_t products;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_rank = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\");\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type error_info_V2_16 = record\n  //   utf8 string(big endian integer(4)) component;\n  //   big endian integer(4) port_index;\n  //   utf8 string(big endian integer(4)) parameter;\n  //   utf8 string(big endian integer(4)) message;\n  //   record\n  //     utf8 string(big endian integer(4)) code;\n  //     big endian integer(4) parent_index;\n  //     record\n  //       utf8 string(big endian integer(4)) name;\n  //       utf8 string(big endian integer(4)) value;\n  //     end [big endian integer(4)] attributes;\n  //   end [big endian integer(4)] details;\n  // end;\n  // type error_info_t = error_info_V2_16;\n  // type alt_run_target_dtl_ref_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_target_dtl_id ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  // end;\n  // type alt_run_alt_dtl_ref_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_alt_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=16 ) alt_run_target_dtl_id ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  //   string(\"\\x01\", maximum_length=11) alt_ndc ;\n  // end;\n  // type master_cag_mapping_adhoc_t =\n  // record\n  //   string(\"\\x01\") carrier = NULL(\"\") ;\n  //   string(\"\\x01\") account = NULL(\"\") ;\n  //   string(\"\\x01\") group = NULL(\"\") ;\n  //   string(\"\\x01\") cag_override_data_path= NULL(\"\");\n  //   decimal(\"\\x01\")[int] output_profile_id ;\n  //   record\n  //     string(\"\\x01\") output_profile_name ;\n  //     string(\"\\x01\") [int] alias_names;\n  //     string(\"\\x01\") [int] job_names;\n  //     string(\"\\x01\")[int] formulary_names ;\n  //     string(\"\\x01\") [int] form_override_data_paths;\n  //     string(\"\\x01\")[int] formulary_pseudonyms ;\n  //     string(\"\\x01\") tal_name ;\n  //     string(\"\\x01\") tac_name ;\n  //     string(\"\\x01\") tar_name ;\n  //     string(\"\\x01\") tsd_name ;\n  //     string(\"\\x01\", maximum_length=1) st_tac_ind ;\n  //   end[int] op_dtls;\n  //   string(\"\\x01\")[int] err_msgs ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tal_expansion_test_harness =\n  // record\n  //   string('\\x01') tal_id;\n  //   string('\\x01') tal_assoc_id;\n  //   string('\\x01') tal_assoc_desc;\n  //   string('\\x01') tal_assoc_type_cd;\n  //   string('\\x01') override_tac_name;\n  //   string('\\x01') override_tar_name;\n  //   string('\\x01') shared_qual;\n  //   string('\\x01') tal_assoc_rank;\n  //   string('\\x01') udl_id;\n  //   string('\\x01') udl_desc;\n  //   string('\\x01') alt_rank;\n  //   string('\\x01') target_alternative;\n  //   string('\\x01') ndc11;\n  //   string('\\x01') gpi14;\n  //   string('\\x01') msc;\n  //   string('\\x01') drug_name;\n  //   string('\\x01') prod_short_desc;\n  //   string('\\x01') gpi14_desc;\n  //   string('\\x01') prod_strength;\n  //   string('\\x01') roa_cd;\n  //   string('\\x01') dosage_form_cd;\n  //   string('\\x01') rx_otc;\n  //   string('\\x01') repack_cd;\n  //   string('\\x01') status_cd;\n  //   string('\\x01') inactive_dt;\n  //   string(1) newline = '\\n';\n  // end;\n  // type udl_expansion_test_harness =\n  // record\n  //   string('\\x01')udl_nm ;\n  //   string('\\x01')ndc11 ;\n  //   string('\\x01')gpi14 ;\n  //   string('\\x01')msc ;\n  //   string('\\x01')drug_name ;\n  //   string('\\x01')prod_short_desc ;\n  //   string('\\x01')gpi14_desc ;\n  //   string('\\x01')prod_strength;\n  //   string('\\x01')roa_cd ;\n  //   string('\\x01')dosage_form_cd ;\n  //   string('\\x01')rx_otc ;\n  //   string('\\x01')repack_cd;\n  //   string('\\x01')status_cd ;\n  //   string('\\x01')inactive_dt ;\n  //   string(1)newline = '\\n';\n  // end;\n  // type alt_run_job_details_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id ;\n  //   decimal(\"\\x01\",0, maximum_length=16) job_run_id ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alias_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) alias_dtl_id ;\n  //   decimal(\"\\x01\",0, maximum_length=10) alias_id ;\n  //   string(\"\\x01\", maximum_length=20) alias_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) qual_priority = 99;\n  //   string(\"\\x01\", maximum_length=10) qual_id_type_cd = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=14) qual_id_value = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=70) search_txt ;\n  //   string(\"\\x01\", maximum_length=70) replace_txt = NULL(\"\") ;\n  //   decimal(\"\\x01\",0, maximum_length=39) rank ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") eff_dt ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") term_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type alias_info_t =  record\n  //         decimal(\"\\x01\",0, maximum_length=39) qual_priority = 99;\n  //         string(\"\\x01\", maximum_length=14) qual_id_value = NULL(\"\") ;\n  //         string(\"\\x01\", maximum_length=70) search_txt ;\n  //         string(\"\\x01\", maximum_length=70) replace_txt  ;\n  //         date(\"YYYYMMDD\")(\"\\x01\") eff_dt;\n  //         date(\"YYYYMMDD\")(\"\\x01\") term_dt;\n  // end;\n  // type alias_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) alias_id ;\n  //   string(\"\\x01\", maximum_length=20) alias_name ;\n  //   alias_info_t[int] alias_info;\n  // end;\n  // type target_alt_rank_t =\n  // record\n  //     int target_dl_bit;\n  //     decimal('\\x01') bucket_index = 0;\n  //     decimal('\\x01') udl_index = 0;\n  //     string(20) tar_udl_nm =NULL(\"\");\n  //     decimal('\\x01') tac_index = 0;\n  //     record\n  //       int alt_rank;\n  //       int[int] alt_prdcts;\n  //       string(2) constituent_group = NULL(\"\");\n  //       string(1) constituent_reqd = NULL(\"\");\n  //       string(20) udl_nm =NULL(\"\");\n  //     end[int] alt_prdcts_rank;\n  //     string(\"\\x01\")has_alt;\n  //     decimal(1) ST_flag =0;\n  // end;\n  // type alias_content_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=13) alias_set_name;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\") alias_label_nm ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type gpi_rank_ratio_t =\n  // record\n  //   string(\"\\x01\", maximum_length=14) gpi14 ;\n  //   decimal(\"\\x01\",0, maximum_length=39) rank ;\n  //   decimal(\"\\x01\".3, maximum_length=6) ratio = NULL(\"\") ;\n  //   date(\"YYYYMMDD\")(\"\\x01\") run_eff_dt = NULL(\"\") ;\n  //  end;\n  // type tad_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tad_id ;\n  //   string(\"\\x01\", maximum_length=14) target_gpi14 ;\n  //   string(\"\\x01\", maximum_length=12) alt_grouping_gpi12 ;\n  //   string(\"\\x01\", maximum_length=14) alt_selection_id ;\n  //   decimal(\"\\x01\",0, maximum_length=39) rank ;\n  //   decimal(\"\\x01\".3, maximum_length=7) qty_adjust_factor = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tad_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=14) target_gpi14 ;\n  //   string(\"\\x01\", maximum_length=6) alt_selection_cd;\n  //   string(\"\\x01\", maximum_length=14)[int] alt_selection_ids ;\n  //   record\n  //     decimal(\"\\x01\",0, maximum_length=39) rank ;\n  //     decimal(\"\\x01\".3, maximum_length=7) qty_adjust_factor = NULL(\"\") ;\n  //   end[int] tad_alt_dtls ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type step_grp_xwalk_t =\n  // record\n  //   string(\"\\x01\", maximum_length=11) ndc11 ;\n  //   decimal(\"\\x01\",0, maximum_length=39) step_therapy_step_number = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=100)[int] step_therapy_group_names  ;\n  // end;\n  // type step_grp_num_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_id ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   decimal(\"\\x01\") _target_st_grp_num = allocate();\n  //   decimal(\"\\x01\")[int] _alt_st_grp_nums = allocate();\n  // end;\n  // type tal_assoc_clinical_indn_t =\n  // record\n  //  decimal(\"\\x01\",0, maximum_length=10) tal_assoc_id ;\n  //  string(\"\\x01\", maximum_length=40) tal_assoc_name ;\n  //  decimal(\"\\x01\",0, maximum_length=10) clinical_indn_id = NULL(\"\");\n  //  string(\"\\x01\", maximum_length=20) clinical_indn_name ;\n  //  string(\"\\x01\", maximum_length=200) clinical_indn_desc = NULL(\"\");\n  //  decimal(\"\\x01\",0, maximum_length=39) rank = NULL(\"\");\n  // end;\n  // type alt_run_clinical_indn_dtl_load_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_id = -1 ;\n  //   decimal(\"\\x01\",0, maximum_length=16) alt_run_target_dtl_id = -1 ;\n  //   string(\"\\x01\", maximum_length=20) formulary_name ;\n  //   string(\"\\x01\", maximum_length=11) target_ndc ;\n  //   string(\"\\x01\", maximum_length=40) tal_assoc_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) rank ;\n  //   datetime(\"YYYY-MM-DD HH24:MI:SS\")(\"\\x01\") rec_crt_ts ;\n  //   string(\"\\x01\", maximum_length=30) rec_crt_user_id ;\n  //   string(\"\\x01\", maximum_length=200) clinical_indn_desc = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type form_target_reject_t =\n  // record\n  // string(\",\") error_msg;\n  // decimal(\",\") tal_id ;\n  // string(\",\") tal_name ;\n  // string(\",\") tal_assoc_name = NULL(\"\") ;\n  // string(\",\") ndc11 = NULL(\"\");\n  // string(\",\") gpi14 = NULL(\"\");\n  // string(\"\\n\") prod_short_desc = NULL(\"\");\n  // end;\n  // type form_alt_reject_t =\n  // record\n  // string(\",\") error_msg;\n  // decimal(\",\") tal_id ;\n  // string(\",\") tal_name ;\n  // string(\",\") tal_assoc_name = NULL(\"\") ;\n  // string(\",\") target_ndc11 = NULL(\"\");\n  // string(\",\") alt_ndc11 = NULL(\"\");\n  // string(\",\") gpi14 = NULL(\"\");\n  // string(\"\\n\") prod_short_desc = NULL(\"\");\n  // end;\n  // type tal_assoc_enriched_data_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) tal_assoc_type_cd ;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   decimal(\"\\x01\",0, maximum_length=39) alt_rank = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   decimal(\"\\x01\",0, maximum_length=39) constituent_rank = NULL(\"\");\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tsd_enriched_data_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tsd_id ;\n  //   string(\"\\x01\", maximum_length=30) tsd_cd ;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tac_enriched_data_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tac_id ;\n  //   string(\"\\x01\", maximum_length=20) tac_name ;\n  //   decimal(\"\\x01\",0, maximum_length=39) priority ;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type tar_enriched_data_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_id  ;\n  //   string(\"\\x01\", maximum_length=20) tar_name ;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type asso_enriched_tac_data_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(\"\\x01\", maximum_length=30) shared_qual ;\n  //   string(\"\\x01\", maximum_length=20) override_tac_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=20) override_tar_name = NULL(\"\") ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type asso_enriched_sorted_data_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tal_id ;\n  //   string(\"\\x01\", maximum_length=20) tal_name ;\n  //   string(\"\\x01\", maximum_length=20) tal_assoc_name = NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=11)  Target_ndc11 ='N/A';\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=15) tad_eli_code= NULL(\"\") ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type asso_enriched_diff_data_t =\n  // record\n  //   string(\"\\x01\", maximum_length=20) Target_Alternative;\n  //   string(\"\\x01\", maximum_length=11)  ndc11 ;\n  //   string(\"\\x01\", maximum_length=14)  gpi14 ;\n  //   string(\"\\x01\", maximum_length=1)  msc ;\n  //   string(\"\\x01\", maximum_length=70)  drug_name ;\n  //   string(\"\\x01\", maximum_length=30) prod_short_desc ;\n  //   string(\"\\x01\", maximum_length=60) gpi14_desc ;\n  //   string(\"\\x01\", maximum_length=2)  roa_cd ;\n  //   string(\"\\x01\", maximum_length=4)  dosage_form_cd ;\n  //   string(\"\\x01\", maximum_length=3)  rx_otc ;\n  //   string(\"\\x01\", maximum_length=1)  repack_cd ;\n  //   string(\"\\x01\", maximum_length=1)  status_cd ;\n  //   string(\"\\x01\", maximum_length=8) inactive_dt ;\n  //   end;\n  // type udl_ref_t =\n  // record\n  //   date(\"YYYYMMDD\")(\"\\x01\") as_of_dt ;\n  // end;\n  // type output_profile_rebate_dtl_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_rebate_dtl_id ;\n  //   string(\"\\x01\", maximum_length=20) udl_name ;\n  //   decimal(\"\\x01\",0, maximum_length=10) output_profile_id ;\n  //   string(\"\\x01\", maximum_length=15) rebate_elig_cd ;\n  //   string(1) newline = \"\\n\";\n  // end;\n  // type products_traversing_mapping_t = record\n  //   bit_vector_t final_first_round_prdcts = allocate();\n  //   bit_vector_t[int] final_first_round_sorted_prdcts = allocate();\n  //   bit_vector_t first_round_prdcts = allocate();\n  //   bit_vector_t[int] first_round_sorted_prdcts = allocate();\n  //   bit_vector_t final_second_round_prdcts = allocate();\n  //   bit_vector_t[int] final_second_round_sorted_prdcts = allocate();\n  //   bit_vector_t second_round_prdcts  = allocate();\n  //   bit_vector_t[int] second_round_sorted_prdcts = allocate();\n  // end;\n  // type store_bucket_idx =\n  // record\n  //   decimal(\"\")index;\n  //   decimal(\"\")[int]bucket;\n  // end;\n  // type alt_contents_t =\n  // record\n  //   bit_vector_t[int] alt_prdcts;\n  //   bit_vector_t[int] alt_prdcts_all_prio;\n  //   bit_vector_t common_prdcts;\n  // end;\n  // type bucket_t =\n  // record\n  //   decimal('\\x01') tar_content_index;\n  //   decimal('\\x01') alt_index;\n  //   decimal('\\x01') udl_index;\n  //   bit_vector_t products = allocate();\n  //   bit_vector_t sorted_prdcts_placeholder = allocate();\n  //   bit_vector_t unsorted_prdcts_placeholder = allocate();\n  //   bit_vector_t[int] final_sorted_prdcts = allocate();\n  //   products_traversing_mapping_t sorted_prdcts = allocate();\n  //   products_traversing_mapping_t unsorted_prdcts = allocate();\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  //   string(20) udl_nm = NULL(\"\");\n  // end;\n  // type tar_prdcts_mapping_t = record\n  //  bucket_t[int] bucket;\n  //  int[int] target_tar_index = [vector];\n  // end;\n  // type content_t =\n  // record\n  //     bit_vector_t[int] target_prdcts;\n  // end;\n  // type contents_row_t =\n  // record\n  //   bit_vector_t target_prdcts;\n  //   bit_vector_t alt_prdcts;\n  //   decimal(1) priority;\n  //   decimal(1) ST_flag =0;\n  // end;\n  // type tac_contents_row_t =\n  // record\n  //   bit_vector_t target_prdcts;\n  //   bit_vector_t alt_prdcts;\n  //   contents_row_t[int] contents;\n  //   decimal(1) xtra_proc_flg = 0;\n  // end;\n  // type alt_prdcts_rank_t =\n  // record\n  //   int alt_rank;\n  //   int[int] alt_prdcts;\n  //   string(2) constituent_group = NULL(\"\");\n  //   string(1) constituent_reqd = NULL(\"\");\n  // end;\n  // let lookup_identifier_type tac_lkp = lookup_load($'TAC_EXP_XWALK',NULL,\"LKP: TAC Exp\");\n  // let lookup_identifier_type tar_lkp = lookup_load($'TAR_EXP_XWALK',NULL,\"LKP: TAR Exp\");\n  // let lookup_identifier_type prod_dtl = lookup_load($'PRODUCTS_FILE', NULL, \"LKP: Prod\");\n  // let lookup_identifier_type rule_prod_dtl = lookup_load($'RULE_PRODUCTS_FILE', NULL, \"LKP: Rule Products\");\n  // let lookup_identifier_type cag_udl_lkp = ($'CARRIER' == 'NULL')? lookup_load($'UDL_BASELINE_EXP_FILE',NULL,\"Expanded UDL\") : lookup_load($'UDL_CAG_EXP_FILE',NULL,\"Expanded UDL\");\n  // let lookup_identifier_type baseline_udl_lkp = ($'CARRIER' != 'NULL')? lookup_load($'UDL_BASELINE_EXP_FILE',NULL,\"Expanded UDL\") : lookup_not_loaded();\n  // let lookup_identifier_type cag_udl_lkp_wt_rule_priority = ($'CARRIER' == 'NULL')? lookup_load($'UDL_BASELINE_EXP_FILE_WT_RL_PRIORITY',NULL,\"Expanded_UDL_wt_rl_priority\") : lookup_load($'UDL_CAG_EXP_FILE_WT_RL_PRIORITY',NULL,\"Expanded_UDL_wt_rl_priority\");\n  // let lookup_identifier_type baseline_udl_lkp_wt_rule_priority = ($'CARRIER' != 'NULL')? lookup_load($'UDL_BASELINE_EXP_FILE_WT_RL_PRIORITY',NULL,\"Expanded_UDL_wt_rl_priority\") : lookup_not_loaded();\n  // type tar_xwalk_t =\n  // record\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_id /*NUMBER(9) NOT NULL*/;\n  //   decimal(\"\\x01\",0, maximum_length=10) tar_dtl_id /*NUMBER(9) NOT NULL*/;\n  //   string(\"\\x01\", maximum_length=20) tar_name /*VARCHAR2(20) NOT NULL*/;\n  //   decimal(\"\\x01\",0, maximum_length=39) tar_dtl_type_cd /*NUMBER(38) NOT NULL*/;\n  //   record\n  //     bit_vector_t target_prdcts;\n  //     record\n  //       bit_vector_t alt_prdcts;\n  //       bit_vector_t alt_prdcts_all_prio;\n  //       bit_vector_t common_prdcts;\n  //     end[int] alt_contents;\n  //   end[int] contents;\n  //   bit_vector_t common_alt_prdcts;\n  //   bit_vector_t common_target_prdcts;\n  //   decimal(1) keep_all_targets = 0;\n  //   string(1) newline = '\\n';\n  // end;\n  //\n  // out::reformat(in)=\n  // begin\n  // let tac_xwalk_t tac_dtls = allocate();\n  // let bit_vector_t[int] target_prdcts = allocate();\n  // let bit_vector_t[int] alt_prdcts = allocate();\n  // let int indx = -1;\n  // let tar_xwalk_t tar_prdcts = allocate();\n  // let tar_prdcts_mapping_t[int] target_tar_prdcts_mapping = allocate();\n  // let tar_prdcts_mapping_t[int] alt_tar_prdcts_mapping = allocate();\n  // let target_alt_rank_t[int] target_prdct_dtl = allocate();\n  // let target_alt_rank_t[int] unsorted_target_prdct_dtl = allocate();\n  // let bucket_t[int] alt_bucket_vec = allocate();\n  // let bucket_t[int] alt_bucket_vec_step = allocate();\n  // let int[int] target_dl_bits = allocate();\n  // let int[int] alt_dl_bits = allocate();\n  // let int[int] tac_target_dl_bits = allocate();\n  // let int[int] lv_tac_target_dl_bits = allocate();\n  // let alt_rank_t[int] alt_rank_vec = allocate();\n  // let contents_row_t[int] contents = allocate();\n  // let tac_contents_row_t lv_tac_contents = allocate_with_defaults();\n  // let bit_vector_t lv_target_prdcts = bv_all_zeros();\n  // let bit_vector_t lv_alt_prdcts = bv_all_zeros();\n  // let bit_vector_t _target_prdcts = bv_all_zeros();\n  // let bit_vector_t _alt_prdcts = bv_all_zeros();\n  // let bit_vector_t _tac_target_prdcts = bv_all_zeros();\n  // let bit_vector_t _tac_alt_prdcts = bv_all_zeros();\n  // let int pos;\n  // let int[int] tar_idx_vec = [vector];\n  // let bit_vector_t _all_tac_target_prdcts = bv_all_zeros();\n  // let bit_vector_t _all_tac_alt_prdcts = bv_all_zeros();\n  // let store_bucket_idx[int] store_bucket_idx_t = allocate();\n  // let int[int] index_vec = [vector];\n  // let alt_prdcts_rank_t[int] alt_prdcts_rank_vec = allocate();\n  // let target_alt_rank_t[int] target_wo_alt_prdct_dtl = allocate();\n  // let alt_constituent_prdct_t[int] alt_constituent_prdcts_vec = allocate();\n  // let bit_vector_t step_alt_prdcts = allocate();\n  //  let int length_of_contents=0;\n  //  let int length_of_alt_contents=0;\n  //  let alt_contents_t [int] tar_roa_df_alt=allocate();\n  //  let tac_st_contents[int] steptal_prdcts=allocate();\n  //  let tac_st_contents[int] steptal_inp=allocate();\n  //  let bit_vector_t tar_st_target =bv_all_zeros();\n  //  let bit_vector_t tar_prds = bv_all_zeros();\n  //  let bit_vector_t step_alt_prds=bv_all_zeros();\n  //  let bit_vector_t in_tar = bv_all_zeros();\n  //  let bit_vector_t in_alt_step =bv_all_zeros();\n  //  let bit_vector_t step_tar = bv_all_zeros();\n  //  let bit_vector_t step_tar1 = bv_all_zeros();\n  //  let bit_vector_t[int] final_sorted_prdcts1 = allocate();\n  // let bit_vector_t[int] final_sorted_prdcts2 = allocate();\n  // let bit_vector_t[int] final_sorted_prdcts_step = allocate();\n  // let bit_vector_t[int] final_sorted_prdcts_step1 = allocate();\n  // let bit_vector_t[int] final_sorted_prdcts_overlapping = allocate();\n  // let number_of_alt_bucket = 0;\n  // let st_len =0;\n  // let length_overlapping = 0;\n  // let bit_vector_t step_join_alternate=bv_all_zeros();\n  // let bit_vector_t step_alt_prdcts_tala = allocate();\n  //  tar_prdcts = if(in.tal_assoc_type_cd == 1 and is_defined(in.override_tar_name) and lookup_match(tar_lkp,\"LKP: TAR Exp\",in.override_tar_name)) lookup(tar_lkp,\"LKP: TAR Exp\",in.override_tar_name) else lookup(tar_lkp,\"LKP: TAR Exp\",$'TAR_NM');\n  //  tar_roa_df_alt=tar_prdcts.contents[0].alt_contents;\n  //  if(in.tal_id==0)\n  //  begin\n  //  step_alt_prdcts=in.alt_constituent_prdcts[0].alt_prdcts;\n  //  length_of_contents=length_of(tar_prdcts.contents);\n  //  for(let c=0 , c < length_of_contents)\n  //  begin\n  //  length_of_alt_contents=length_of(tar_prdcts.contents[c].alt_contents);\n  //  for( let a=0, a < length_of_alt_contents)\n  //  begin\n  //   tar_prdcts.contents[c].alt_contents[a].alt_prdcts=vector_append(tar_prdcts.contents[c].alt_contents[a].alt_prdcts,step_alt_prdcts);\n  //  tar_prdcts.contents[0].alt_contents[a].common_prdcts=bv_or(tar_prdcts.contents[0].alt_contents[a].common_prdcts,step_alt_prdcts);\n  //  end\n  //  end\n  //  end\n  //   if( in.tal_assoc_type_cd == 1)\n  //   begin\n  //      tac_dtls = if(is_defined(in.override_tac_name) and lookup_match(tac_lkp,\"LKP: TAC Exp\",in.override_tac_name)) lookup(tac_lkp,\"LKP: TAC Exp\",in.override_tac_name) else lookup(tac_lkp,\"LKP: TAC Exp\",$'TAC_NM');\n  //         for( let i , i < length_of(tac_dtls.tac_contents) )\n  //         begin\n  //             lv_target_prdcts = if(tar_prdcts.keep_all_targets) tac_dtls.tac_contents[i].target_prdcts else  bv_and(tac_dtls.tac_contents[i].target_prdcts,tar_prdcts.common_target_prdcts);\n  //             lv_alt_prdcts    = bv_and(tac_dtls.tac_contents[i].alt_prdcts,tar_prdcts.common_alt_prdcts);\n  //             if ( bv_count_one_bits(lv_target_prdcts) and bv_count_one_bits(lv_alt_prdcts) )\n  //             begin\n  //                 if(tac_dtls.tac_contents[i].xtra_proc_flg)\n  //                 begin\n  //                   for(let rec in tac_dtls.tac_contents[i].contents)\n  //                   begin\n  //                     _target_prdcts = bv_and(lv_target_prdcts,rec.target_prdcts);\n  //                     _alt_prdcts    = bv_and(lv_alt_prdcts,rec.alt_prdcts);\n  //                     if( bv_count_one_bits(_target_prdcts) and bv_count_one_bits(_alt_prdcts) )\n  //                     begin\n  //                       contents           = vector_append(contents,[record target_prdcts _target_prdcts alt_prdcts _alt_prdcts ST_flag rec.ST_flag priority rec.priority] );\n  //                       _tac_target_prdcts = bv_or(_tac_target_prdcts,_target_prdcts);\n  //                       _tac_alt_prdcts    = bv_or(_tac_alt_prdcts,_alt_prdcts);\n  //                     end\n  //                   end\n  //                   if( bv_count_one_bits(_tac_target_prdcts) and bv_count_one_bits(_tac_alt_prdcts) )\n  //                   begin\n  //                      _all_tac_target_prdcts = bv_or(_all_tac_target_prdcts, _tac_target_prdcts);\n  //                      _all_tac_alt_prdcts    = bv_or(_all_tac_alt_prdcts, _tac_alt_prdcts);\n  //                      _tac_target_prdcts     = bv_all_zeros();\n  //                      _tac_alt_prdcts        = bv_all_zeros();\n  //                   end\n  //                 end\n  //                 else\n  //                 begin\n  //                    contents               = vector_append(contents,[record target_prdcts lv_target_prdcts alt_prdcts lv_alt_prdcts ST_flag tac_dtls.tac_contents[i].contents[0].ST_flag priority tac_dtls.tac_contents[i].contents[0].priority]);\n  //                    _all_tac_target_prdcts = bv_or(_all_tac_target_prdcts, lv_target_prdcts);\n  //                    _all_tac_alt_prdcts    = bv_or(_all_tac_alt_prdcts, lv_alt_prdcts);\n  //                 end\n  //             end\n  //          end\n  //          if(bv_count_one_bits(_all_tac_target_prdcts))\n  //          begin\n  //              lv_tac_contents.target_prdcts = _all_tac_target_prdcts;\n  //              lv_tac_contents.alt_prdcts    = _all_tac_alt_prdcts;\n  //              lv_tac_contents.contents      = contents;\n  //              lv_tac_contents.xtra_proc_flg = (length_of(contents) > 1);\n  //          end\n  //          else\n  //            force_error(\"Applied TAR on TAC - No Products Left For Processing\");\n  //       for ( let target_prds in in.target_prdcts )\n  //         target_prdcts = vector_append( target_prdcts, bv_and(target_prds, _all_tac_target_prdcts));\n  //       if ( !bv_count_one_bits( bv_vector_or(target_prdcts) ) )\n  //          force_error(\"TAC Applied - No Target Products Left For Processing\");\n  //       if ( length_of(in.alt_constituent_prdcts) )\n  //       begin\n  //          for( let alt_consti_prdcts in in.alt_constituent_prdcts )\n  //              alt_constituent_prdcts_vec = vector_append( alt_constituent_prdcts_vec,[ record alt_prdcts bv_and( alt_consti_prdcts.alt_prdcts, _all_tac_alt_prdcts)\n  //                                                                                              constituent_group alt_consti_prdcts.constituent_group\n  //                                                                                              constituent_reqd alt_consti_prdcts.constituent_reqd\n  //                                                                                              udl_nm alt_consti_prdcts.udl_nm]);\n  //          target_tar_prdcts_mapping = apply_tar(target_prdcts,alt_constituent_prdcts_vec,tar_prdcts,0,target_tar_prdcts_mapping,'',0);\n  //          alt_tar_prdcts_mapping = apply_tar([vector],alt_constituent_prdcts_vec,tar_prdcts,1,target_tar_prdcts_mapping,in.shared_qual,0);\n  //         if(in.shared_qual == 'N/A')\n  //          begin\n  //             for(let target_prd in target_tar_prdcts_mapping)\n  //             begin\n  //                let bucket_index = 0;\n  //                for(let bucket in target_prd.bucket)\n  //                begin\n  //                   bucket_index = bucket_index + 1;\n  //                   number_of_alt_bucket=0;\n  //                   length_overlapping=0;\n  //                   step_join_alternate=allocate();\n  //                   final_sorted_prdcts_step= allocate();\n  //                   for(let alt_prd in alt_tar_prdcts_mapping)\n  //                   begin\n  //                      alt_bucket_vec = vector_concat(alt_bucket_vec,vector_select(alt_prd.bucket,[record tar_content_index bucket.tar_content_index alt_index 0 udl_index 0 products bv_all_zeros() sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts_dl_bits [vector]\n  //                                                                               sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_prdcts_dl_bits [vector] first_round_prdcts bv_all_zeros() first_round_prdcts_dl_bits [vector] final_second_round_prdcts bv_all_zeros() final_second_round_prdcts_dl_bits [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                               unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_prdcts_dl_bits [vector] first_round_prdcts bv_all_zeros() first_round_prdcts_dl_bits [vector] final_second_round_prdcts bv_all_zeros() final_second_round_prdcts_dl_bits [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]],${tar_content_index}));\n  //                   end\n  //                   for(let prds in bucket.final_sorted_prdcts) target_dl_bits = vector_concat(target_dl_bits, for (let p in bv_indices(prds) ): p);\n  //                   if(length_of(alt_bucket_vec))\n  //                   begin\n  //                      alt_bucket_vec = vector_sort(alt_bucket_vec, {tar_content_index;alt_index;udl_index});\n  //                      unsorted_target_prdct_dtl= apply_gpi14_sorting(target_dl_bits,bucket_index,bucket.udl_index,bucket.products,alt_bucket_vec,lv_tac_contents,tar_roa_df_alt,steptal_inp,in.tar_udl_nm,final_sorted_prdcts_step);\n  //                      for(let p in target_dl_bits)\n  //                      begin\n  //                         let idx = vector_search(unsorted_target_prdct_dtl,[record target_dl_bit p bucket_index bucket_index udl_index bucket.udl_index tac_index 0 alt_prdcts_rank [vector] has_alt '' ST_flag 0],${target_dl_bit});\n  //                           if( unsorted_target_prdct_dtl[idx].has_alt == 'Y' )\n  //                             target_prdct_dtl = vector_append(target_prdct_dtl, unsorted_target_prdct_dtl[idx]);\n  //                           else\n  //                             target_wo_alt_prdct_dtl = vector_append(target_wo_alt_prdct_dtl, unsorted_target_prdct_dtl[idx]);\n  //                      end\n  //                      alt_bucket_vec = allocate();\n  //                   end\n  //                   else\n  //                   begin\n  //                      for(let p in target_dl_bits)\n  //                         target_wo_alt_prdct_dtl = vector_append(target_wo_alt_prdct_dtl,[record target_dl_bit p bucket_index 0 udl_index 0 tac_index 0 alt_prdcts_rank [vector] has_alt 'N' ST_flag 0]);\n  //                   end\n  //                   target_dl_bits = allocate();\n  //                 end\n  //              end\n  //          end\n  //          else\n  //          begin\n  //             for (let y, y < length_of(alt_tar_prdcts_mapping) )\n  //             begin\n  //                tar_idx_vec = vector_sort_dedup_first(alt_tar_prdcts_mapping[y].target_tar_index);\n  //                store_bucket_idx_t = vector_append( store_bucket_idx_t , [ record index y bucket [vector] ] );\n  //                index_vec = vector_append(index_vec, y);\n  //                for( let z, z < length_of(tar_idx_vec) )\n  //                begin\n  //                   pos = vector_search(target_tar_prdcts_mapping[y].target_tar_index,tar_idx_vec[z]);\n  //                   target_dl_bits = allocate();\n  //                   alt_bucket_vec = vector_select(alt_tar_prdcts_mapping[y].bucket,[record tar_content_index tar_idx_vec[z] alt_index 0 udl_index y products bv_all_zeros() sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts_dl_bits [vector]\n  //                                                          sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_prdcts_dl_bits [vector] first_round_prdcts bv_all_zeros() first_round_prdcts_dl_bits [vector] final_second_round_prdcts bv_all_zeros() final_second_round_prdcts_dl_bits [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                          unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_prdcts_dl_bits [vector] first_round_prdcts bv_all_zeros() first_round_prdcts_dl_bits [vector] final_second_round_prdcts bv_all_zeros() final_second_round_prdcts_dl_bits [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]],{tar_content_index;udl_index});\n  //                   for(let prds in target_tar_prdcts_mapping[y].bucket[pos].final_sorted_prdcts)\n  //                   begin\n  //                      target_dl_bits = vector_concat(target_dl_bits, for (let p in bv_indices(prds) ): p);\n  //                      store_bucket_idx_t[y].bucket = vector_append(store_bucket_idx_t[y].bucket,pos);\n  //                   end\n  //                   if(in.shared_qual !='GPI14')\n  //                   begin\n  //                      unsorted_target_prdct_dtl = apply_gpi14_sorting(target_dl_bits,pos+1,target_tar_prdcts_mapping[y].bucket[pos].udl_index,target_tar_prdcts_mapping[y].bucket[pos].products,alt_bucket_vec,lv_tac_contents,tar_roa_df_alt,steptal_inp,in.tar_udl_nm,final_sorted_prdcts_step);\n  //                      for(let p in target_dl_bits)\n  //                      begin\n  //                         let idx = vector_search(unsorted_target_prdct_dtl,[record target_dl_bit p bucket_index 0 udl_index 0 tac_index 0 alt_prdcts_rank [vector] has_alt '' ST_flag 0],${target_dl_bit});\n  //                           if( unsorted_target_prdct_dtl[idx].has_alt == 'Y' )\n  //                             target_prdct_dtl = vector_append(target_prdct_dtl, unsorted_target_prdct_dtl[idx]);\n  //                           else\n  //                             target_wo_alt_prdct_dtl = vector_append(target_wo_alt_prdct_dtl, unsorted_target_prdct_dtl[idx]);\n  //                      end\n  //                      alt_bucket_vec = allocate();\n  //                   end\n  //                   else\n  //                   begin\n  //                      let int alt_rank = 1;\n  //                      let tac_index = 0;\n  //                      let bit_vector_t unmatching_udl_prd;\n  //                      tac_target_dl_bits = target_dl_bits;\n  //                      begin block exit_block\n  //                         for(let rec in lv_tac_contents.contents)\n  //                         begin\n  //                            if(length_of(tac_target_dl_bits))\n  //                            begin\n  //                               lv_tac_target_dl_bits = bv_indices(bv_and(target_tar_prdcts_mapping[y].bucket[pos].products,rec.target_prdcts));\n  //                               if(length_of(lv_tac_target_dl_bits))\n  //                               begin\n  //                                 for(let bucket1 in alt_bucket_vec)\n  //                                  begin\n  //                                     if(bv_count_one_bits(bucket1.sorted_prdcts_placeholder) or bv_count_one_bits(bucket1.unsorted_prdcts_placeholder))\n  //                                     begin\n  //                                           for( let alt_prds in bucket1.final_sorted_prdcts)\n  //                                           begin\n  //                                            let bit_vector_t[int] tar_roa_df_alt_cntnt=tar_roa_df_alt[bucket1.tar_content_index].alt_prdcts_all_prio[bucket1.alt_index];\n  //                                             unmatching_udl_prd =bv_and(alt_prds,rec.alt_prdcts);\n  //                                             alt_dl_bits = apply_udl_sort(unmatching_udl_prd,bucket1.udl_nm,tar_roa_df_alt_cntnt,0,1);\n  //                                             if(length_of(alt_dl_bits))\n  //                                             begin\n  //                                                alt_rank_vec = vector_append(alt_rank_vec, [record alt_rank alt_rank alt_prdcts alt_dl_bits udl_nm bucket1.udl_nm]);\n  //                                                alt_rank = alt_rank + length_of(bucket1.final_sorted_prdcts);\n  //                                             end\n  //                                           end\n  //                                     end\n  //                                  end\n  //                                  if(length_of(alt_rank_vec))\n  //                                  begin\n  //                                     tac_index = tac_index + 1;\n  //                                     for(let p in lv_tac_target_dl_bits)\n  //                                       unsorted_target_prdct_dtl = vector_append(unsorted_target_prdct_dtl, [record target_dl_bit p bucket_index pos+1 udl_index target_tar_prdcts_mapping[y].bucket[pos].udl_index tac_index tac_index alt_prdcts_rank alt_rank_vec rebate_elig_contents [vector] has_alt 'Y' ST_flag 0]);\n  //                                     alt_rank_vec = allocate();\n  //                                     tac_target_dl_bits = vector_difference(tac_target_dl_bits,lv_tac_target_dl_bits);\n  //                                     alt_rank = 1;\n  //                                  end\n  //                              end\n  //                           end\n  //                           else exit exit_block;\n  //                         end\n  //                      end block exit_block;\n  //                      for ( let p in tac_target_dl_bits )\n  //                        target_wo_alt_prdct_dtl = vector_append(target_wo_alt_prdct_dtl, [record target_dl_bit p bucket_index pos+1 udl_index target_tar_prdcts_mapping[y].bucket[pos].udl_index alt_prdcts_rank [vector] rebate_elig_contents [vector] has_alt 'N' ST_flag 0]);\n  //                      for(let p in target_dl_bits)\n  //                        target_prdct_dtl = vector_concat(target_prdct_dtl, vector_select(unsorted_target_prdct_dtl,[record target_dl_bit p bucket_index 0 udl_index 0 tac_index 0 alt_prdcts_rank [vector] has_alt '' ST_flag 0],${target_dl_bit}));\n  //                      alt_bucket_vec = allocate();\n  //                         end\n  //                    end\n  //              end\n  //              for( let int i , i < length_of(target_tar_prdcts_mapping))\n  //              begin\n  //                if ( i member index_vec )\n  //                begin\n  //                  for ( let int j , j < length_of(target_tar_prdcts_mapping[i].bucket) )\n  //                     if ( j not member store_bucket_idx_t[i].bucket )\n  //                     begin\n  //                       for ( let prod_grp in target_tar_prdcts_mapping[i].bucket[j].final_sorted_prdcts )\n  //                          target_wo_alt_prdct_dtl = vector_concat( target_wo_alt_prdct_dtl,for(let p in bv_indices(prod_grp)) : [ record target_dl_bit p  bucket_index 0 udl_index 0 alt_prdcts_rank [vector] has_alt 'N' ST_flag 0] );\n  //                     end;\n  //                end;\n  //                else\n  //                  for ( let int j , j < length_of(target_tar_prdcts_mapping[i].bucket) )\n  //                    target_wo_alt_prdct_dtl = vector_concat( target_wo_alt_prdct_dtl, for(let p in bv_indices(bv_vector_or(target_tar_prdcts_mapping[i].bucket[j].final_sorted_prdcts))) : [ record target_dl_bit p bucket_index 0 udl_index 0 alt_prdcts_rank [vector] has_alt 'N' ST_flag 0]);\n  //              end;\n  //          end;\n  //       end;\n  //       else\n  //       begin\n  //         target_wo_alt_prdct_dtl = vector_concat( target_wo_alt_prdct_dtl, for(let p in bv_indices(bv_vector_or(target_prdcts))) : [ record target_dl_bit p bucket_index 0 udl_index 0 alt_prdcts_rank [vector] has_alt 'N' ST_flag 0] );\n  //       end;\n  //   end\n  //   else\n  //   begin\n  //      let alt_rank = 1;\n  //       target_tar_prdcts_mapping = apply_tar(in.target_prdcts,in.alt_constituent_prdcts,tar_prdcts,0,target_tar_prdcts_mapping,'',0);\n  //       alt_tar_prdcts_mapping = apply_tar([vector],in.alt_constituent_prdcts,tar_prdcts,1,target_tar_prdcts_mapping,in.shared_qual,1);\n  //       if(in.shared_qual != 'N/A')\n  //       begin\n  //          for (let a, a < length_of(alt_tar_prdcts_mapping) )\n  //          begin\n  //              for(let bucket in alt_tar_prdcts_mapping[a].bucket )\n  //              begin\n  //                 let bit_vector_t[int] tar_roa_df_alt_cntnt=tar_roa_df_alt[bucket.tar_content_index].alt_prdcts_all_prio[bucket.alt_index];\n  //                 for(let prds in bucket.final_sorted_prdcts )\n  //                 begin\n  //                    alt_prdcts_rank_vec =  vector_append(alt_prdcts_rank_vec, [record alt_rank alt_rank alt_prdcts apply_udl_sort(prds,bucket.udl_nm,tar_roa_df_alt_cntnt,0,1)]);\n  //                    alt_rank = alt_rank + bv_count_one_bits(prds);\n  //                 end\n  //              end\n  //              target_prdct_dtl = vector_concat(target_prdct_dtl,  for(let prd in bv_indices(in.target_prdcts[a])): [record target_dl_bit prd bucket_index 0 udl_index a+1 alt_prdcts_rank alt_prdcts_rank_vec has_alt 'Y' ST_flag 0]);\n  //              alt_prdcts_rank_vec = allocate();\n  //              alt_rank = 1;\n  //          end\n  //          for(let b= length_of(alt_tar_prdcts_mapping), b < length_of(in.target_prdcts) )\n  //             target_wo_alt_prdct_dtl = vector_concat(target_wo_alt_prdct_dtl, for(let prd in bv_indices(in.target_prdcts[b])): [record target_dl_bit prd bucket_index 0 udl_index 0 alt_prdcts_rank [vector] has_alt 'N' ST_flag 0]);\n  //       end\n  //       else\n  //       begin\n  //          for(let alt_prd in alt_tar_prdcts_mapping)\n  //          begin\n  //               for(let bucket in alt_prd.bucket )\n  //               begin\n  //                  let bit_vector_t[int] tar_roa_df_alt_cntnt=tar_roa_df_alt[bucket.tar_content_index].alt_prdcts_all_prio[bucket.alt_index];\n  //                  for(let prds in bucket.final_sorted_prdcts )\n  //                  begin\n  //                     alt_prdcts_rank_vec = vector_append(alt_prdcts_rank_vec, [record alt_rank alt_rank alt_prdcts apply_udl_sort(prds,bucket.udl_nm,tar_roa_df_alt_cntnt,0,1) constituent_group bucket.constituent_group constituent_reqd  bucket.constituent_reqd]);\n  //                     alt_rank = alt_rank + bv_count_one_bits(prds);\n  //                  end\n  //               end\n  //          end\n  //           if( length_of(alt_prdcts_rank_vec))\n  //           begin\n  //               let udl_index = 0;\n  //               for(let target_prd in in.target_prdcts)\n  //               begin\n  //                 udl_index = udl_index + 1;\n  //                 target_prdct_dtl = vector_concat(target_prdct_dtl, for(let prd in bv_indices(target_prd)): [record target_dl_bit prd bucket_index 0 udl_index udl_index alt_prdcts_rank alt_prdcts_rank_vec has_alt 'Y' ST_flag 0]);\n  //               end\n  //           end\n  //           else\n  //           begin\n  //               for(let target_prd in in.target_prdcts)\n  //                 target_wo_alt_prdct_dtl = vector_concat(target_wo_alt_prdct_dtl, for(let prd in bv_indices(target_prd)): [record target_dl_bit prd alt_prdcts_rank [vector] has_alt 'N' ST_flag 0]);\n  //           end\n  //       end\n  //   end\n  //   out.* :: in.*;\n  //   out.ta_prdct_dtls :: target_prdct_dtl;\n  //   out.ta_prdct_dtls_wo_alt :: target_wo_alt_prdct_dtl;\n  // end;\n  // out::apply_tar(udl_prdcts,alt_udl_prdcts,tar_prdcts,is_alt,target_tar_prdcts_mapping, shared_qualifier,is_override_incl) =\n  // begin\n  // let tar_prdcts_mapping_t[int] tar_prdcts_mapping = allocate();\n  // let bit_vector_t _prdcts = bv_all_zeros();\n  // let bit_vector_t lv_prdcts = bv_all_zeros();\n  // let bit_vector_t left_over_prdcts = allocate();\n  // let content_t[int] contents = allocate();\n  // let len = 0;\n  // let udl_len = 0;\n  // if(is_alt)\n  // begin\n  //   len = length_of(tar_prdcts.contents[0].alt_contents);\n  //   udl_len = length_of(alt_udl_prdcts);\n  //   for ( let j=1, j < length_of(tar_prdcts.contents) )\n  //     contents = vector_append(contents, [record target_prdcts tar_prdcts.contents[j].alt_contents[0].alt_prdcts]);\n  // end\n  // else\n  // begin\n  //    len = length_of(tar_prdcts.contents[0].target_prdcts);\n  //    udl_len = length_of(udl_prdcts);\n  //    contents = vector_slice(tar_prdcts.contents,1,length_of(tar_prdcts.contents)-1);\n  // end\n  //  for (let i, i < udl_len)\n  //  begin\n  //   _prdcts = bv_all_zeros();\n  //   tar_prdcts_mapping = vector_append(tar_prdcts_mapping, [record bucket [vector]]);\n  //   if(is_alt)\n  //   begin\n  //     if(shared_qualifier == 'N/A')\n  //     begin\n  //       let bit_vector_t udl_prdts = alt_udl_prdcts[i].alt_prdcts;\n  //        for( let p, p < length_of(target_tar_prdcts_mapping) )\n  //        begin\n  //         for (let idx in target_tar_prdcts_mapping[p].target_tar_index)\n  //         begin\n  //             if( is_override_incl )\n  //            begin\n  //               _prdcts = bv_and(udl_prdts,tar_prdcts.contents[0].alt_contents[idx].common_prdcts);\n  //               udl_prdts = bv_difference(udl_prdts,_prdcts);\n  //            end\n  //            else\n  //               _prdcts = bv_and(alt_udl_prdcts[i].alt_prdcts,tar_prdcts.contents[0].alt_contents[idx].common_prdcts);\n  //            if(bv_count_one_bits(_prdcts))\n  //            begin\n  //               let bit_vector_t[int] alt_prds = tar_prdcts.contents[0].alt_contents[idx].alt_prdcts;\n  //               let alt_len = length_of(alt_prds);\n  //               begin block stop_block\n  //                 for(let n, n < alt_len)\n  //                 begin\n  //                    lv_prdcts = bv_and ( _prdcts, alt_prds[n] );\n  //                    if ( bv_count_one_bits( lv_prdcts ) )\n  //                    begin\n  //                      tar_prdcts_mapping[i].target_tar_index = vector_append(tar_prdcts_mapping[i].target_tar_index,idx);\n  //                      tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index idx alt_index n udl_index i products lv_prdcts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                                      sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                                                      unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                                                      constituent_group alt_udl_prdcts[i].constituent_group  constituent_reqd alt_udl_prdcts[i].constituent_reqd udl_nm alt_udl_prdcts[i].udl_nm]);\n  //                      _prdcts = bv_difference(_prdcts, lv_prdcts);\n  //                      if(!bv_count_one_bits(_prdcts))\n  //                        exit stop_block;\n  //                    end\n  //                 end\n  //               end block stop_block;\n  //           end\n  //         end\n  //        end\n  //          if( is_override_incl and bv_count_one_bits(udl_prdts))\n  //             tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index length_of(tar_prdcts_mapping[i].bucket) alt_index 0 udl_index i products udl_prdts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                                sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]\n  //                                                                                                unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]\n  //                                                                                                constituent_group alt_udl_prdcts[i].constituent_group  constituent_reqd alt_udl_prdcts[i].constituent_reqd udl_nm alt_udl_prdcts[i].udl_nm]);\n  //     end\n  //     else\n  //     begin\n  //       let bit_vector_t udl_prdts = alt_udl_prdcts[i].alt_prdcts;\n  //       for(let idx in target_tar_prdcts_mapping[i].target_tar_index)\n  //       begin\n  //         if( is_override_incl )\n  //           begin\n  //              _prdcts = bv_and(udl_prdts,tar_prdcts.contents[0].alt_contents[idx].common_prdcts);\n  //              udl_prdts = bv_difference(udl_prdts,_prdcts);\n  //           end\n  //           else\n  //              _prdcts = bv_and(alt_udl_prdcts[i].alt_prdcts,tar_prdcts.contents[0].alt_contents[idx].common_prdcts);\n  //         if(bv_count_one_bits(_prdcts))\n  //         begin\n  //            let bit_vector_t[int] alt_prds = tar_prdcts.contents[0].alt_contents[idx].alt_prdcts;\n  //            let alt_len = length_of(alt_prds);\n  //           begin block stop_block1\n  //              for(let n, n < alt_len)\n  //              begin\n  //                 lv_prdcts = bv_and ( _prdcts, alt_prds[n] );\n  //                 if ( bv_count_one_bits( lv_prdcts ) )\n  //                 begin\n  //                   tar_prdcts_mapping[i].target_tar_index = vector_append(tar_prdcts_mapping[i].target_tar_index,idx);\n  //                   tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index idx alt_index n udl_index i products lv_prdcts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                                   sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                                                   unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                                                   constituent_group alt_udl_prdcts[i].constituent_group  constituent_reqd alt_udl_prdcts[i].constituent_reqd udl_nm alt_udl_prdcts[i].udl_nm]);\n  //                   _prdcts = bv_difference(_prdcts, lv_prdcts);\n  //                   if(!bv_count_one_bits(_prdcts))\n  //                     exit stop_block1;\n  //                 end\n  //              end\n  //           end block stop_block1;\n  //         end\n  //      end\n  //       if( is_override_incl and bv_count_one_bits(udl_prdts))\n  //          tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index length_of(tar_prdcts_mapping[i].bucket) alt_index 0 udl_index i products udl_prdts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                             sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]\n  //                                                                                             unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]\n  //                                                                                             constituent_group alt_udl_prdcts[i].constituent_group  constituent_reqd alt_udl_prdcts[i].constituent_reqd udl_nm alt_udl_prdcts[i].udl_nm]);\n  //     end\n  //   end\n  //   else\n  //   begin\n  //       _prdcts = udl_prdcts[i];\n  //     begin block exit_block\n  //      for ( let m, m < len )\n  //      begin\n  //           lv_prdcts = bv_and ( _prdcts, tar_prdcts.contents[0].target_prdcts[m] );\n  //           if ( bv_count_one_bits( lv_prdcts ) )\n  //           begin\n  //             tar_prdcts_mapping[i].target_tar_index = vector_append(tar_prdcts_mapping[i].target_tar_index,m);\n  //             tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index m alt_index 0 udl_index i products lv_prdcts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                             sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]\n  //                                                                                             unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_prdcts_dl_bits [vector]]]);\n  //             _prdcts = bv_difference(_prdcts, lv_prdcts);\n  //             if(!bv_count_one_bits(_prdcts))\n  //                exit exit_block;\n  //           end\n  //       end\n  //       if(bv_count_one_bits(_prdcts))\n  //           left_over_prdcts = _prdcts;\n  //      if(bv_count_one_bits(left_over_prdcts))\n  //      begin\n  //         _prdcts = if(bv_count_one_bits(contents[0].target_prdcts[0])) bv_and ( left_over_prdcts, contents[0].target_prdcts[0] ) else left_over_prdcts;\n  //          if ( bv_count_one_bits( _prdcts ) )\n  //           tar_prdcts_mapping[i].bucket = vector_append(tar_prdcts_mapping[i].bucket, [record tar_content_index len alt_index 0 udl_index i products _prdcts sorted_prdcts_placeholder bv_all_zeros() unsorted_prdcts_placeholder bv_all_zeros() final_sorted_prdcts [vector]\n  //                                                                                                         sorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]\n  //                                                                                                         unsorted_prdcts [record final_first_round_prdcts bv_all_zeros() final_first_round_sorted_prdcts [vector] first_round_prdcts bv_all_zeros() first_round_sorted_prdcts [vector] final_second_round_prdcts bv_all_zeros() final_second_round_sorted_prdcts [vector] second_round_prdcts bv_all_zeros() second_round_sorted_prdcts [vector]]]);\n  //      end\n  //     end block exit_block;\n  //   end\n  //    for (let k, k < length_of(tar_prdcts_mapping[i].bucket))\n  //    begin\n  //      for ( let j, j < length_of(contents) )\n  //      begin\n  //       if(bv_count_one_bits(contents[j].target_prdcts[0]))\n  //       begin\n  //          if (!(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder)))\n  //          begin\n  //            tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder = bv_and ( tar_prdcts_mapping[i].bucket[k].products, contents[j].target_prdcts[0] );\n  //            tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder = bv_difference(tar_prdcts_mapping[i].bucket[k].products, tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder);\n  //          end\n  //          else if ( !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts)or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts)) )\n  //           begin\n  //             if ( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder) and !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts) and bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts)) and !( length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts) or length_of( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts) or length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts) or length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts)))\n  //             begin\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder, contents[j].target_prdcts[0] );\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts );\n  //             end\n  //             if ( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder) and !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts) and bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts)) and !( length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts) or length_of( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts) or length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts) or length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts)))\n  //             begin\n  //               tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder, contents[j].target_prdcts[0] );\n  //               tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts );\n  //             end\n  //           end\n  //           else if ( !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts)))\n  //             begin\n  //                if ( (bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts)) and !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts)) )\n  //                begin\n  //                  tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts, contents[j].target_prdcts[0] );\n  //                  tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts );\n  //                  tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts, contents[j].target_prdcts[0] );\n  //                  tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts);\n  //                end\n  //                if ( (bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts)) and !(bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts) or bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts)) )\n  //                begin\n  //                  tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts, contents[j].target_prdcts[0] );\n  //                  tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts );\n  //                  tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts, contents[j].target_prdcts[0] );\n  //                  tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts = bv_difference(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts);\n  //                end\n  //              end\n  //              else\n  //              begin\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts = vector_append(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //                if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts) )\n  //                begin\n  //                 _prdcts = bv_and ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts, contents[j].target_prdcts[0] );\n  //                   if(bv_count_one_bits(_prdcts))\n  //                   begin\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts, _prdcts );\n  //                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts = bv_difference ( tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts, _prdcts );\n  //                     _prdcts = bv_all_zeros();\n  //                   end\n  //                end\n  //             end\n  //            end\n  //      end\n  //      if ( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder))\n  //      begin\n  //          if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts) )\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_prdcts );\n  //          if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts) )\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_prdcts );\n  //          if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts) )\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_prdcts );\n  //          if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts) )\n  //               tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_prdcts );\n  //          tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts = vector_concat(tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts);\n  //         if( !length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_first_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.first_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.final_second_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].sorted_prdcts.second_round_sorted_prdcts)\n  //            )\n  //            tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts =vector_append(tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder);\n  //      end\n  //      if ( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder))\n  //      begin\n  //         if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts) )\n  //              tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_prdcts );\n  //         if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts) )\n  //              tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_prdcts );\n  //         if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts) )\n  //              tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_prdcts );\n  //         if( bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts) )\n  //              tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts = vector_append (tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_prdcts );\n  //         tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts = vector_concat(tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts,\n  //                                                                                     tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts);\n  //         if( !length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_first_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.first_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.final_second_round_sorted_prdcts) and\n  //             !length_of(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts.second_round_sorted_prdcts)\n  //             )\n  //         tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts = vector_append(tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder);\n  //      end\n  //      if(!bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].sorted_prdcts_placeholder) and !bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].unsorted_prdcts_placeholder) and bv_count_one_bits(tar_prdcts_mapping[i].bucket[k].products))\n  //        tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts = vector_append(tar_prdcts_mapping[i].bucket[k].final_sorted_prdcts, tar_prdcts_mapping[i].bucket[k].products);\n  //    end\n  //  end\n  //  out :: tar_prdcts_mapping;\n  // end;\n  // out :: gpi14_sorting(dl_bits,gpi14_container,alt_rank,in_constituent_group,in_constituent_reqd,udl_nm) =\n  // begin\n  //   let int[int] gpi14_matching_dl_bits = allocate();\n  //   let int[int] gpi14_non_matching_dl_bits = allocate();\n  //   let int lv_dl_bit;\n  //   let alt_rank_t[int] alt_rank_vec = allocate();\n  //   let len = 0;\n  //   let lv_alt_rank = alt_rank;\n  //   gpi14_matching_dl_bits     = vector_intersection(dl_bits,gpi14_container);\n  //   for(let _dlbit in dl_bits)\n  //   begin\n  //   if (_dlbit not member gpi14_matching_dl_bits)\n  //   gpi14_non_matching_dl_bits= vector_append(gpi14_non_matching_dl_bits,_dlbit);\n  //   end\n  //   len = length_of(gpi14_matching_dl_bits);\n  //   if(len)\n  //   begin\n  //      alt_rank_vec = vector_append(alt_rank_vec, [record alt_rank lv_alt_rank alt_prdcts gpi14_matching_dl_bits , constituent_group in_constituent_group constituent_reqd in_constituent_reqd udl_nm udl_nm]);\n  //      lv_alt_rank = lv_alt_rank + len;\n  //   end\n  //   len = length_of(gpi14_non_matching_dl_bits);\n  //   if(len)\n  //   begin\n  //      alt_rank_vec = vector_append(alt_rank_vec, [record alt_rank lv_alt_rank alt_prdcts gpi14_non_matching_dl_bits constituent_group in_constituent_group constituent_reqd in_constituent_reqd udl_nm udl_nm]);\n  //      lv_alt_rank = lv_alt_rank + len;\n  //   end\n  //   out :: alt_rank_vec;\n  // end;\n  // out :: apply_gpi14_sorting(target_dl_bits,bucket_index,udl_index,products,alt_bucket_vec,tac_contents,tar_roa_df_alt,steptal_inp,tar_udl_nm,final_sorted_prdcts_step1) =\n  // begin\n  // let target_prdct_t[int] unsorted_target_prdct_dtl = allocate();\n  // let alt_rank_t[int] alt_rank_vec = allocate();\n  // let alt_rank_t[int] lv_alt_rank_vec = allocate();\n  // let int[int] alt_dl_bits = allocate();\n  // let int[int] lv_target_dl_bits = allocate();\n  // let int[int] lv_gpi14_dl_bits = allocate();\n  // let int[int] lv_target_dl_bits1 = allocate();\n  // let bit_vector_t lv_target_prdcts = bv_all_zeros();\n  // let bit_vector_t lv_target_prdcts_sec = bv_all_zeros();\n  // let int[int] tac_target_dl_bits = allocate();\n  // let int[int] lv_tac_target_dl_bits = allocate();\n  // let int tar_idx=0;\n  // let int alt_idx=0;\n  // let bit_vector_t[int] tar_roa_df_alt_cntnt=allocate();\n  // let bit_vector_t[int] tar_roa_df_alt_cntnt1=allocate();\n  // let bit_vector_t[int] tar_roa_df_alt_cntnt2=allocate();\n  // let decimal('\\x01') lv_udl_index = 0;\n  // let decimal('\\x01') udl_prdct_count = 0;\n  // let string(14) _gpi14;\n  // let bit_vector_t unmatching_udl_prd=bv_all_zeros();\n  // let tac_index = 0;\n  // let int[int] target_tac_index = [vector];\n  // let bit_vector_t[int] in_tar_vec = [vector];\n  // let int[int] tar_bits = allocate();\n  // let bit_vector_t[int] final_sorted_prdcts1 = [vector];\n  // let bit_vector_t[int] final_sorted_prdcts2 = [vector];\n  // let st_len =0;\n  // let len_now =0;\n  // let len_alt =0;\n  // let length_overlapping = 0;\n  // let alt_idx1 = 0;\n  // let int[int] alt_idx2 = allocate();\n  //       for(let dl_bit in target_dl_bits)\n  //       begin\n  //         let wc=0;\n  //         if( dl_bit not member lv_target_dl_bits)\n  //         begin\n  //            let alt_rank = 1;\n  //            let tac_idx = -1;\n  //            let idx=-1;\n  //            let idx_ord =-1;\n  //            let first_hit_priority = 0;\n  //            target_tac_index=allocate();\n  //            lv_target_prdcts_sec=allocate();\n  //            final_sorted_prdcts1 = allocate();\n  //            final_sorted_prdcts2 = allocate();\n  //            len_now=length_of(alt_bucket_vec);\n  //            st_len=length_of(steptal_inp);\n  //            length_overlapping=length_of(final_sorted_prdcts_step1);\n  //            tar_bits = allocate();\n  //            _gpi14 = lookup(prod_dtl, \"LKP: Prod\",dl_bit).gpi14;\n  //            lv_target_prdcts = bv_and(lookup(rule_prod_dtl, \"LKP: Rule Products\", 'GPI14', 'eq',_gpi14).products,products);\n  //            begin block exit_block\n  //                for(let rec in tac_contents.contents)\n  //                begin\n  //                 let lv_target_prdcts1 = bv_and(lv_target_prdcts,rec.target_prdcts);\n  //                 target_tac_index=allocate();\n  //                 lv_target_prdcts_sec=allocate();\n  //                  lv_tac_target_dl_bits = bv_indices(lv_target_prdcts1);\n  //                  tac_idx = tac_idx + 1;\n  //                  if( is_defined(lv_tac_target_dl_bits) and length_of(lv_tac_target_dl_bits) )\n  //                  begin\n  //                   target_tac_index = vector_append(target_tac_index,tac_idx);\n  //                   first_hit_priority = rec.priority;\n  //                   for(let i=tac_idx+1,i<length_of(tac_contents.contents) and first_hit_priority == tac_contents.contents[i].priority)\n  //                   begin block my_target_block\n  //                    lv_target_prdcts_sec = bv_and(lv_target_prdcts1,tac_contents.contents[i].target_prdcts);\n  //                    if(bv_count_one_bits(lv_target_prdcts_sec)) target_tac_index = vector_append(target_tac_index,i);\n  //                   end block my_target_block;\n  //                    for(let bucket1 in alt_bucket_vec)\n  //                    begin\n  //                       tar_idx=bucket1.tar_content_index;\n  //                       alt_idx=bucket1.alt_index;\n  //                       tar_roa_df_alt_cntnt=tar_roa_df_alt[tar_idx].alt_prdcts_all_prio[alt_idx];\n  //                       unmatching_udl_prd=allocate();\n  //                       if(bv_count_one_bits(bucket1.sorted_prdcts_placeholder) or bv_count_one_bits(bucket1.unsorted_prdcts_placeholder) or bv_count_one_bits(bucket1.products))\n  //                       begin\n  //                             for( let alt_prds in bucket1.final_sorted_prdcts)\n  //                             begin\n  //                             unmatching_udl_prd=allocate();\n  //                                for(let alt_tac_idx in target_tac_index)\n  //                                  begin block my_alt_block\n  //                                  unmatching_udl_prd = bv_or(unmatching_udl_prd, bv_and(alt_prds,tac_contents.contents[alt_tac_idx].alt_prdcts));\n  //                                  end block my_alt_block;\n  //                                  alt_dl_bits =apply_udl_sort(unmatching_udl_prd,bucket1.udl_nm,tar_roa_df_alt_cntnt,st_len,1);\n  //                               if(length_of(alt_dl_bits))\n  //                               begin\n  //                                  lv_alt_rank_vec = if(length_of(alt_dl_bits) > 1) gpi14_sorting(alt_dl_bits,lv_gpi14_dl_bits,alt_rank,bucket1.constituent_group,bucket1.constituent_reqd,bucket1.udl_nm ) else [vector [record alt_rank alt_rank alt_prdcts alt_dl_bits constituent_group bucket1.constituent_group constituent_reqd bucket1.constituent_reqd udl_nm bucket1.udl_nm ]];\n  //                                  alt_rank_vec = vector_concat(alt_rank_vec,lv_alt_rank_vec);\n  //                                  udl_prdct_count = udl_prdct_count + length_of(alt_dl_bits);\n  //                                  alt_rank = if(lv_udl_index != bucket1.udl_index)  udl_prdct_count + 1\n  //                                             else alt_rank + length_of(alt_dl_bits);\n  //                                  lv_udl_index = bucket1.udl_index;\n  //                               end\n  //                             end\n  //                       end\n  //                       len_now=len_alt-1;\n  //                    end\n  //                    udl_prdct_count = 0;\n  //                    if(length_of(alt_rank_vec))\n  //                     begin\n  //                       tac_index = tac_index + 1;\n  //                       for(let p in lv_tac_target_dl_bits)\n  //                         unsorted_target_prdct_dtl = vector_append(unsorted_target_prdct_dtl, [record target_dl_bit p bucket_index bucket_index udl_index udl_index tac_index tac_index alt_prdcts_rank alt_rank_vec has_alt 'Y' ST_flag rec.ST_flag]);\n  //                       alt_rank_vec = allocate();\n  //                       lv_target_dl_bits = vector_concat(lv_target_dl_bits,lv_tac_target_dl_bits);\n  //                       lv_target_prdcts = bv_difference(lv_target_prdcts,lv_target_prdcts1);\n  //                       if ( !bv_count_one_bits(lv_target_prdcts) )\n  //                         exit exit_block;\n  //                     end\n  //                    end\n  //                  end\n  //               end block exit_block;\n  //             lv_target_dl_bits1 = bv_indices(lv_target_prdcts);\n  //            for( let p in lv_target_dl_bits1 )\n  //            begin\n  //              unsorted_target_prdct_dtl = vector_append(unsorted_target_prdct_dtl, [record target_dl_bit p bucket_index 0 udl_index 0 tac_index 0 alt_prdcts_rank [ vector ] has_alt 'N' ST_flag 0]);\n  //            end;\n  //            lv_target_dl_bits = vector_concat(lv_target_dl_bits,lv_target_dl_bits1);\n  //            lv_target_dl_bits1 = allocate();\n  //         end\n  //      end\n  //     out :: unsorted_target_prdct_dtl;\n  // end;\n  // out :: apply_udl_sort(unmatching_udl_prd,udl_nm,tar_roa_df_alt_cntnt,st_len,wcx)=\n  // begin\n  //     let bit_vector_t matching_udl_prd;\n  //     let bit_vector_t lv_unmatching_udl_prd;\n  //     let bit_vector_t _roa_df_match;\n  //     let int[int] lv_alt_dl_bits = allocate();\n  //     let bit_vector_t[int] alt_udl_content_lkp  = [vector];\n  //     let bit_vector_t[int] roa_df_alt_dtl=tar_roa_df_alt_cntnt;\n  //     let record\n  //                 int dl_bits;\n  //                 string(14)gpi14;\n  //         end [int] udl_rule_prd = allocate_with_defaults();\n  //     let string(\"\") lv_udl_nm=string_lrtrim(udl_nm);\n  //      if((lv_udl_nm=='N/A'))\n  //      begin\n  //        _roa_df_match   = unmatching_udl_prd;\n  //        begin block roa_df_blk_1\n  //           for (let k in roa_df_alt_dtl)\n  //           begin\n  //                 udl_rule_prd=allocate_with_defaults();\n  //                 lv_unmatching_udl_prd=bv_and(_roa_df_match,k);\n  //                 _roa_df_match =bv_difference(_roa_df_match,lv_unmatching_udl_prd);\n  //                 if(bv_count_one_bits(lv_unmatching_udl_prd))\n  //                 begin\n  //                         for(let p in bv_indices(lv_unmatching_udl_prd))udl_rule_prd = vector_append(udl_rule_prd,[record dl_bits p gpi14 lookup(prod_dtl, \"LKP: Prod\",p).gpi14]);\n  //                         udl_rule_prd=vector_sort(udl_rule_prd,{gpi14});\n  //                         lv_alt_dl_bits=vector_concat(lv_alt_dl_bits,for(let i in udl_rule_prd):i.dl_bits);\n  //                 end\n  //                 if(!bv_count_one_bits(_roa_df_match))\n  //                         exit roa_df_blk_1;\n  //          end\n  //          end block roa_df_blk_1;\n  //     end\n  //     else\n  //     begin\n  //         alt_udl_content_lkp   = first_without_error( first_defined(lookup(cag_udl_lkp_wt_rule_priority, \"Expanded_UDL_wt_rl_priority\",lv_udl_nm).contents, lookup(baseline_udl_lkp_wt_rule_priority,\"Expanded_UDL_wt_rl_priority\",lv_udl_nm).contents,[vector]) , [vector] );\n  //         _roa_df_match   = unmatching_udl_prd;\n  //         begin block roa_df_blk\n  //           for (let k in roa_df_alt_dtl)\n  //           begin\n  //                 lv_unmatching_udl_prd=bv_and(_roa_df_match,k);\n  //                 _roa_df_match =bv_difference(_roa_df_match,lv_unmatching_udl_prd);\n  //                 begin block udl_blk\n  //                         for(let c in alt_udl_content_lkp)\n  //                         begin\n  //                                 udl_rule_prd= allocate_with_defaults();\n  //                                 matching_udl_prd=bv_and(lv_unmatching_udl_prd,c);\n  //                                 lv_unmatching_udl_prd=bv_difference(lv_unmatching_udl_prd,matching_udl_prd);\n  //                                 if(bv_count_one_bits(matching_udl_prd))\n  //                                 begin\n  //                                         for(let p in bv_indices(matching_udl_prd))udl_rule_prd = vector_append(udl_rule_prd,[record dl_bits p gpi14 lookup(prod_dtl, \"LKP: Prod\",p).gpi14]);\n  //                                         udl_rule_prd=vector_sort(udl_rule_prd,{gpi14});\n  //                                         lv_alt_dl_bits=vector_concat(lv_alt_dl_bits,for(let i in udl_rule_prd):i.dl_bits);\n  //                                 end\n  //                                 if(!bv_count_one_bits(lv_unmatching_udl_prd))\n  //                                         exit udl_blk;\n  //                         end\n  //                 end block udl_blk;\n  //                 if(!bv_count_one_bits(_roa_df_match))\n  //                         exit roa_df_blk;\n  //          end\n  //          end block roa_df_blk;\n  //     end\n  // out :: lv_alt_dl_bits;\n  // end;\n  //\n  val out = in\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_AltsReformat_0" : {
          "id" : "Rank_AltsReformat_0",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Rank_AltsReformat_0",
            "slug" : "Rank_AltsReformat_0",
            "x" : 620,
            "y" : 60,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_0__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_0__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "Association_Processing__Rank_AltsReformat_0__in##tal_id", "Association_Processing__Rank_AltsReformat_0__in##tal_name", "Association_Processing__Rank_AltsReformat_0__in##tal_assoc_name", "Association_Processing__Rank_AltsReformat_0__in##tar_udl_nm", "Association_Processing__Rank_AltsReformat_0__in##shared_qual", "Association_Processing__Rank_AltsReformat_0__in##ta_prdct_dtls_wo_alt", "Association_Processing__Rank_AltsReformat_0__in##newline" ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl_nm",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl_nm\")"
              },
              "description" : ""
            }, {
              "target" : "shared_qual",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"shared_qual\")"
              },
              "description" : ""
            }, {
              "target" : "ta_prdct_dtls_wo_alt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"ta_prdct_dtls_wo_alt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Normalize_TAL_Target_Drugs_Without_Alternatives" : {
          "id" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives",
            "slug" : "Normalize_TAL_Target_Drugs_Without_Alternatives",
            "x" : 820,
            "y" : 60,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs_Without_Alternatives__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"ta_prdct_dtls_wo_alt\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          col(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n          col(\"tar_udl_nm\").as(\"tar_udl\"),\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\")\n            .as(\"target_ndc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_tier\")\n          ).otherwise(lit(null)).as(\"target_formulary_tier\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_status\")\n          ).otherwise(lit(null)).as(\"target_formulary_status\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"pa_reqd_ind\")\n          ).otherwise(lit(null)).as(\"target_pa_reqd_ind\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_ind\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_ind\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"specialty_ind\")\n          ).otherwise(lit(null)).as(\"target_specialty_ind\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"msc\")\n            .as(\"target_multi_src_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"roa_cd\")\n            .as(\"target_roa_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"dosage_form_cd\")\n            .as(\"target_dosage_form_cd\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\",\n                        element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                 ).getField(\"gpi14\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              ).getField(\"gpi14\")\n            )\n            .as(\"target_gpi14\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\",\n                        element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                 ).getField(\"drug_name\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              ).getField(\"drug_name\")\n            )\n            .as(\"target_prod_name_ext\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"prod_short_desc\")\n            .as(\"target_prod_short_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi14_desc\")\n            .as(\"target_gpi14_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi8_desc\")\n            .as(\"target_gpi8_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_tier_desc\")\n          ).otherwise(lit(null)).as(\"target_formulary_tier_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_status_desc\")\n          ).otherwise(lit(null)).as(\"target_formulary_status_desc\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"pa_type_cd\")\n          ).otherwise(lit(null)).as(\"target_pa_type_cd\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_type_cd\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_type_cd\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_group_name\")\n          ).otherwise(lit(null)).as(\"target_step_therapy_group_name\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"step_therapy_step_number\")\n          ).otherwise(lit(null)).cast(StringType).as(\"target_step_therapy_step_num\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"formulary_cd\")\n          ).otherwise(lit(\"\")).as(\"formulary_cd\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          when(\n            !isnull(\n              lookup(\"LKP_Prod\",\n                     element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n              )\n            ),\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            ).getField(\"last_exp_dt\")\n          ).otherwise(lit(null)).as(\"last_exp_dt\")\n        )\n      ).as(\"alt_run_target_dtl_load\"),\n      (when(\n        !isnull(\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n        ),\n        when(\n          isnull(\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\",\n                          element_at(col(\"ta_prdct_dtls_wo_alt\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\")\n                   ).getField(\"ndc11\")\n            )\n          ),\n          lit(0)\n        ).otherwise(lit(1))\n      ).otherwise(lit(0)).cast(DecimalType(1, 0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select((col(\"alt_run_target_dtl_load\")).as(\"alt_run_target_dtl_load\"),\n                                              (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Normalize_TAL_Target_Drugs" : {
          "id" : "Normalize_TAL_Target_Drugs",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Target_Drugs",
            "slug" : "Normalize_TAL_Target_Drugs",
            "x" : 820,
            "y" : 320,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(10,0)",
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_prd",
                              "type" : "integer",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "rebate_elig_cd",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tad_eli_code",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "qty_adjust_factor",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tal_assoc_name",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "tala",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "priority",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : false,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : false
                        },
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : false
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Target_Drugs__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"ta_prdct_dtls\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\")\n            .as(\"target_ndc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_tier\").as(\"target_formulary_tier\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_status\").as(\"target_formulary_status\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"pa_reqd_ind\").as(\"target_pa_reqd_ind\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"step_therapy_ind\").as(\"target_step_therapy_ind\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"specialty_ind\").as(\"target_specialty_ind\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"msc\")\n            .as(\"target_multi_src_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"roa_cd\")\n            .as(\"target_roa_cd\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"dosage_form_cd\")\n            .as(\"target_dosage_form_cd\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"gpi14\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                .getField(\"gpi14\")\n            )\n            .as(\"target_gpi14\"),\n          when(is_blank(\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"drug_name\")\n               ),\n               lit(\" \")\n          ).otherwise(\n              lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                .getField(\"drug_name\")\n            )\n            .as(\"target_prod_name_ext\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"prod_short_desc\")\n            .as(\"target_prod_short_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi14_desc\")\n            .as(\"target_gpi14_desc\"),\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"gpi8_desc\")\n            .as(\"target_gpi8_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_tier_desc\").as(\"target_formulary_tier_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_status_desc\").as(\"target_formulary_status_desc\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"pa_type_cd\").as(\"target_pa_type_cd\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"step_therapy_type_cd\").as(\"target_step_therapy_type_cd\"),\n          when(\n            element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n            array_join(\n              lookup(\n                \"LKP_Step_Grp_NM\",\n                lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                  .getField(\"ndc11\"),\n                lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n              ).getField(\"step_therapy_group_names\"),\n              \"|\"\n            )\n          ).otherwise(lit(\"\")).as(\"target_step_therapy_group_name\"),\n          when(\n            element_at(col(\"ta_prdct_dtls\"),  col(\"index\") + lit(1)).getField(\"ST_flag\"),\n            lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n          ).otherwise(lit(0.0)).cast(StringType).as(\"target_step_therapy_step_num\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"formulary_cd\").as(\"formulary_cd\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          lookup(\"LKP_Form_CAG_dataset\",\n                 lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                   .getField(\"ndc11\")\n          ).getField(\"last_exp_dt\").as(\"last_exp_dt\")\n        )\n      ).as(\"target_dtl\"),\n      (when(\n        is_blank(\n          when(\n            element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n            array_join(\n              lookup(\n                \"LKP_Step_Grp_NM\",\n                lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                  .getField(\"ndc11\"),\n                lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n              ).getField(\"step_therapy_group_names\"),\n              \"|\"\n            )\n          ).otherwise(lit(\"\"))\n        ),\n        lit(\" \")\n      ).when(\n          size(\n            element_at(element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\"), lit(1))\n              .getField(\"tala\")\n          ) > lit(20),\n          element_at(element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\"), lit(1))\n            .getField(\"tala\")\n        )\n        .otherwise(col(\"tal_assoc_name\")))\n        .as(\"tala\"),\n      (element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1))\n        .getField(\"ST_flag\")\n        .cast(DecimalType(1, 0)))\n        .as(\"ST_flag\"),\n      (when(\n        element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"ST_flag\").cast(BooleanType),\n        lookup(\n          \"LKP_Step_Grp_NM\",\n          lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n            .getField(\"ndc11\"),\n          lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_target_st_grp_num\")\n        ).getField(\"step_therapy_group_names\")\n      ).otherwise(array())).as(\"tar_group_names\"),\n      (element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"alt_prdcts\")).as(\"alt_products_def\"),\n      (when(\n        !isnull(lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))),\n        when(\n          isnull(\n            lookup(\"LKP_Form_CAG_dataset\",\n                   lookup(\"LKP_Prod\", element_at(col(\"ta_prdct_dtls\"), col(\"index\") + lit(1)).getField(\"target_dl_bit\"))\n                     .getField(\"ndc11\")\n            )\n          ),\n          lit(0)\n        ).otherwise(lit(1))\n      ).otherwise(lit(0)).cast(DecimalType(1, 0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select(\n    (col(\"tal_id\").cast(DecimalType(10, 0))).as(\"tal_id\"),\n    (col(\"tal_name\")).as(\"tal_name\"),\n    (col(\"target_dtl\")).as(\"target_dtl\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"tala\")).as(\"tala\"),\n    (col(\"tar_udl_nm\")).as(\"tar_udl\"),\n    (col(\"ST_flag\")).as(\"ST_flag\"),\n    (col(\"tar_group_names\")).as(\"tar_group_names\"),\n    (col(\"alt_products_def\")).as(\"alt_products_def\"),\n    (col(\"constituent_grp_vec\")).as(\"constituent_grp_vec\"),\n    (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_AltsReformat_1" : {
          "id" : "Rank_AltsReformat_1",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Rank_AltsReformat_1",
            "slug" : "Rank_AltsReformat_1",
            "x" : 620,
            "y" : 320,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_1__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_AltsReformat_1__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "Association_Processing__Rank_AltsReformat_1__in##tal_id", "Association_Processing__Rank_AltsReformat_1__in##tal_name", "Association_Processing__Rank_AltsReformat_1__in##tal_assoc_name", "Association_Processing__Rank_AltsReformat_1__in##tar_udl_nm", "Association_Processing__Rank_AltsReformat_1__in##ta_prdct_dtls", "Association_Processing__Rank_AltsReformat_1__in##constituent_grp_vec", "Association_Processing__Rank_AltsReformat_1__in##newline" ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl_nm",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl_nm\")"
              },
              "description" : ""
            }, {
              "target" : "ta_prdct_dtls",
              "expression" : {
                "format" : "scala",
                "expression" : "transform(\n    col(\"ta_prdct_dtls\"),\n    y =>\n      struct(\n        y.getField(\"target_dl_bit\").as(\"target_dl_bit\"),\n        coalesce(y.getField(\"ST_flag\"), lit(0)).as(\"ST_flag\"),\n        array(\n          struct(\n            lit(0).as(\"alt_prd\"),\n            lit(0).as(\"alt_rank\"),\n            lit(\"\").as(\"rebate_elig_cd\"),\n            lit(\"\").as(\"tad_eli_code\"),\n            lit(\"\").as(\"qty_adjust_factor\"),\n            lit(\"\").as(\"tal_assoc_name\"),\n            lit(\"\").as(\"tala\"),\n            lit(\"\").as(\"udl_nm\"),\n            lit(\"\").as(\"priority\"),\n            lit(\"\").as(\"constituent_group\"),\n            lit(\"\").as(\"constituent_reqd\")\n          )\n        ).as(\"alt_prdcts\")\n      )\n  )"
              },
              "description" : ""
            }, {
              "target" : "constituent_grp_vec",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"constituent_grp_vec\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Tranform_Proxy_DTL_Layout" : {
          "id" : "Tranform_Proxy_DTL_Layout",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Tranform_Proxy_DTL_Layout",
            "slug" : "Tranform_Proxy_DTL_Layout",
            "x" : 1820,
            "y" : 340,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Tranform_Proxy_DTL_Layout__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Tranform_Proxy_DTL_Layout__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_alt_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_alt_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"formulary_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "alt_proxy_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"alt_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "rank",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rank\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rec_crt_ts\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"rec_crt_user_id\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Normalize_Clinical_Indication" : {
          "id" : "Normalize_Clinical_Indication",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_Clinical_Indication",
            "slug" : "Normalize_Clinical_Indication",
            "x" : 1420,
            "y" : 20,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_Clinical_Indication__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_step_num",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_exp_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_Clinical_Indication__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = None,\n    finishedExpression = None,\n    finishedCondition = lit(false),\n    alias = \"index\",\n    colsToSelect = List(\n      coalesce(\n        (element_at(\n          lookup_row(\"LKP_CLIN_INDCN\", col(\"tal_assoc_name\")),\n          col(\"index\") + lit(1)\n        ).getField(\"rank\").cast(StringType)),\n        lit(\"\")\n      ).as(\"rank\"),\n      coalesce(\n        (element_at(\n          lookup_row(\"LKP_CLIN_INDCN\", col(\"tal_assoc_name\")),\n          col(\"index\") + lit(1)\n        )\n          .getField(\"clinical_indn_desc\")),\n        lit(0)\n      )\n        .as(\"clinical_indn_desc\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"formulary_name\")).as(\"formulary_name\"),\n    (col(\"target_ndc\")).as(\"target_ndc\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"rank\")).as(\"rank\"),\n    (lit(Config.RUN_TS)).as(\"rec_crt_ts\"),\n    (lit(Config.USER_ID)).as(\"rec_crt_user_id\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\")\n  )\n\n  val out = simpleSelect_in_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Rank_Alts_RowDistributor" : {
          "id" : "Rank_Alts_RowDistributor",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "Association_Processing__Rank_Alts_RowDistributor",
            "slug" : "Rank_Alts_RowDistributor",
            "x" : 420,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl_nm",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ta_prdct_dtls_wo_alt",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "target_dl_bit",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "bucket_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tar_udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tac_index",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_prdcts_rank",
                        "type" : {
                          "type" : "array",
                          "elementType" : {
                            "type" : "struct",
                            "fields" : [ {
                              "name" : "alt_rank",
                              "type" : "integer",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "alt_prdcts",
                              "type" : {
                                "type" : "array",
                                "elementType" : "integer",
                                "containsNull" : true
                              },
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_group",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "constituent_reqd",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            }, {
                              "name" : "udl_nm",
                              "type" : "string",
                              "nullable" : true,
                              "metadata" : {
                                "description" : "",
                                "mappings" : [ ],
                                "tags" : [ ]
                              }
                            } ]
                          },
                          "containsNull" : true
                        },
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "has_alt",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "ST_flag",
                        "type" : "decimal(1,0)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out0",
              "slug" : "out0"
            }, {
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out1",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out0",
              "model" : {
                "format" : "scala",
                "expression" : "size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType)"
              }
            }, {
              "path" : "out1",
              "id" : "Association_Processing__Rank_Alts_RowDistributor__out1",
              "model" : {
                "format" : "scala",
                "expression" : "size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType).or(!size(col(\"ta_prdct_dtls_wo_alt\")).cast(BooleanType))"
              }
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Alternative_Rollup_Processing" : {
          "id" : "Alternative_Rollup_Processing",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "Alternative_Rollup_Processing",
            "slug" : "Alternative_Rollup_Processing",
            "x" : 1420,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1",
              "slug" : "out1"
            }, {
              "id" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "e54",
            "source" : "Alternative_Rollup_Processing",
            "sourcePort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__in",
            "target" : "FBE_Target_Product_with_without_Constituent_Data",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__in"
          }, {
            "id" : "56",
            "source" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__out",
            "target" : "Alternative_Rollup_Processing",
            "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out1"
          }, {
            "id" : "57",
            "source" : "Normalize_Alt_Proxy_Products",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__out",
            "target" : "Alternative_Rollup_Processing",
            "targetPort" : "altexp_tal_container_xwalk__Association_Processing__Alternative_Rollup_Processing__out"
          }, {
            "id" : "e12",
            "source" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__out",
            "target" : "Normalize_Alt_Proxy_Products",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__in"
          }, {
            "id" : "WHw6yY_u7xIR4Y3cBN3s1",
            "source" : "FBE_Target_Product_with_without_Constituent_Data",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
            "target" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
            "targetPort" : "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES"
          }, {
            "id" : "WDS04qMTXZjEBLi9CpJjP$$rYjnUIlwZ2R5Mq7FG1eNv",
            "source" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
            "sourcePort" : "H5fZmwWlbI4umLZnBqBj_$$aJBcwOodL-Lp93Oi9YHH8",
            "target" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
            "targetPort" : "-K4vXWdYTmRcsk7i8R_GZ$$eqRkJ1k5yt5kV3JV1IqWW"
          }, {
            "id" : "e8SCAw1hJT4ikO7bdsqyS",
            "source" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
            "sourcePort" : "aiJGUXi45T1q-KLb8hEjB$$JlMH1ty8uZNyq0HDfkScd",
            "target" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__in"
          }, {
            "id" : "9NiGmYMzn419XoLzPFDcT",
            "source" : "FBE_Target_Product_with_without_Constituent_Data",
            "sourcePort" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
            "target" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
            "targetPort" : "kf3CU5JisDRkY3bTX8P7v$$RqsEpMaGtPqWl8_kLetUK"
          }, {
            "id" : "Vm-1ErkFqDDmk9hBZ7t_G$$rvwx4TgyZQ07zFbc3fayK",
            "source" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
            "sourcePort" : "8nYrYzvuQyh9-uBpgfSaS$$CPzzTJMIISIiriEB4L47q",
            "target" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
            "targetPort" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__in"
          } ],
          "processes" : {
            "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl" : {
              "id" : "QzCy7_aBM68nXJOysFz-Z$$H368vYw0j7T3HDgKLLTzl",
              "component" : "Script",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents",
                "slug" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents",
                "x" : 220,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "kf3CU5JisDRkY3bTX8P7v$$RqsEpMaGtPqWl8_kLetUK",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "8nYrYzvuQyh9-uBpgfSaS$$CPzzTJMIISIiriEB4L47q",
                  "slug" : "out0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "val process_udf = udf(\n  { (inputRows: Seq[Row]) =>\n    {\n\n      var alt_run_alt_dtl_load_vec = Array[Row]()\n      var alt_prod_short_desc_grp_vec = Array[String]()\n      var lv_constituent_grp_vec = Array[String]()\n      var _constituent_Y_alt_dtl_vec = Array[Row]()\n      var _constituent_N_alt_dtl_vec = Array[Row]()\n\n      inputRows.zipWithIndex.foreach {\n        case (in, jdx) => {\n          var idx = -1\n          if (\n            !alt_prod_short_desc_grp_vec.contains(\n              in.getAs[Row](\"alt_run_alt_dtl_load\")\n                .getAs[String](\"alt_prod_short_desc_grp\")\n            )\n          ) {\n            alt_prod_short_desc_grp_vec = Array.concat(\n              alt_prod_short_desc_grp_vec,\n              Array.fill(1)(\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"alt_prod_short_desc_grp\")\n              )\n            )\n\n            if (\n              !_isnull(\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"constituent_reqd\")\n              )\n            ) {\n\n              if (\n                in.getAs[Row](\"alt_run_alt_dtl_load\")\n                  .getAs[String](\"constituent_reqd\") == \"Y\"\n              ) {\n                _constituent_Y_alt_dtl_vec = Array.concat(\n                  _constituent_Y_alt_dtl_vec,\n                  Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n                )\n              } else {\n                _constituent_N_alt_dtl_vec = Array.concat(\n                  _constituent_N_alt_dtl_vec,\n                  Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n                )\n              }\n            } else {\n              alt_run_alt_dtl_load_vec = Array.concat(\n                alt_run_alt_dtl_load_vec,\n                Array.fill(1)(in.getAs[Row](\"alt_run_alt_dtl_load\"))\n              )\n            }\n          }\n        }\n      }\n      if (\n        in.getAs[Seq[String]](\"constituent_grp_vec\")\n          .diff(lv_constituent_grp_vec)\n          .isEmpty\n      ) {\n        alt_run_alt_dtl_load_vec =\n          Array.concat(alt_run_alt_dtl_load_vec, _constituent_Y_alt_dtl_vec)\n        alt_run_alt_dtl_load_vec =\n          Array.concat(alt_run_alt_dtl_load_vec, _constituent_N_alt_dtl_vec)\n      }\n    }\n    Row(alt_run_alt_dtl_load_vec)\n  },\n  StructType(\n              List(\n                StructField(\"alt_run_alt_dtl_id\",           DecimalType(16, 0)),\n                StructField(\"alt_run_id\",                   DecimalType(16, 0)),\n                StructField(\"alt_run_target_dtl_id\",        DecimalType(16, 0)),\n                StructField(\"formulary_name\",               StringType),\n                StructField(\"target_ndc\",                   StringType),\n                StructField(\"alt_ndc\",                      StringType),\n                StructField(\"alt_formulary_tier\",           StringType),\n                StructField(\"alt_multi_src_cd\",             StringType),\n                StructField(\"alt_roa_cd\",                   StringType),\n                StructField(\"alt_dosage_form_cd\",           StringType),\n                StructField(\"rank\",                         StringType),\n                StructField(\"alt_step_therapy_ind\",         StringType),\n                StructField(\"alt_pa_reqd_ind\",              StringType),\n                StructField(\"alt_formulary_status\",         StringType),\n                StructField(\"alt_specialty_ind\",            StringType),\n                StructField(\"alt_gpi14\",                    StringType),\n                StructField(\"alt_prod_name_ext\",            StringType),\n                StructField(\"alt_prod_short_desc\",          StringType),\n                StructField(\"alt_prod_short_desc_grp\",      StringType),\n                StructField(\"alt_gpi14_desc\",               StringType),\n                StructField(\"alt_gpi8_desc\",                StringType),\n                StructField(\"alt_formulary_tier_desc\",      StringType),\n                StructField(\"alt_formulary_status_desc\",    StringType),\n                StructField(\"alt_pa_type_cd\",               StringType),\n                StructField(\"alt_step_therapy_type_cd\",     StringType),\n                StructField(\"alt_step_therapy_group_name\",  StringType),\n                StructField(\"alt_step_therapy_step_number\", StringType),\n                StructField(\"rec_crt_ts\",                   StringType),\n                StructField(\"rec_crt_user_id\",              StringType),\n                StructField(\"rebate_elig_cd\",               StringType),\n                StructField(\"tad_eligible_cd\",              StringType),\n                StructField(\"alt_qty_adj\",                  DecimalType(6, 3)),\n                StructField(\"tal_assoc_name\",               StringType),\n                StructField(\"tala\",                         StringType),\n                StructField(\"alt_udl\",                      StringType),\n                StructField(\"tal_assoc_rank\",               DecimalType(38, 6)),\n                StructField(\"constituent_group\",            StringType),\n                StructField(\"constituent_reqd\",             StringType),\n                StructField(\"newline\",                      StringType)\n              )\n            )\n)\n\nval out0 = in0\n  .groupBy(\n    \"alt_run_alt_dtl_load.tal_assoc_name\",\n    \"alt_run_alt_dtl_load.target_ndc\"\n  )\n  .agg(collect_list(col(\"tmp\")).as(\"input\"))\n  .select(process_udf(col(\"input\")).as(\"output\"))\n  .select(col(\"output.*\"))\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out0\n}"
              }
            },
            "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG" : {
              "id" : "ui6Oi7FNjhKiDFNpsbNjL$$NGOStT71eKKu5l_dlSNwG",
              "component" : "Script",
              "metadata" : {
                "label" : "flatten",
                "slug" : "flatten",
                "x" : 420,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "-K4vXWdYTmRcsk7i8R_GZ$$eqRkJ1k5yt5kV3JV1IqWW",
                  "slug" : "in0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "out",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "aiJGUXi45T1q-KLb8hEjB$$JlMH1ty8uZNyq0HDfkScd",
                  "slug" : "out0",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "val out = in0.select(\"out.*\")",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out0\n}"
              }
            },
            "Identify_Alt_Proxy_Targets_w_Constituents_Reformat" : {
              "id" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
              "component" : "Reformat",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
                "slug" : "Identify_Alt_Proxy_Targets_w_Constituents_Reformat",
                "x" : 420,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_Constituents_Reformat__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "expressions" : [ {
                  "target" : "alt_run_alt_dtl_load_vec",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "transform(\n    col(\"alt_run_alt_dtl_load_vec\"),\n    x =>\n      struct(\n        coalesce(x.getField(\"alt_run_alt_dtl_id\"),    lit(-1)).as(\"alt_run_alt_dtl_id\"),\n        coalesce(x.getField(\"alt_run_id\"),            lit(-1)).as(\"alt_run_id\"),\n        coalesce(x.getField(\"alt_run_target_dtl_id\"), lit(-1)).as(\"alt_run_target_dtl_id\"),\n        x.getField(\"formulary_name\").as(\"formulary_name\"),\n        x.getField(\"target_ndc\").as(\"target_ndc\"),\n        x.getField(\"alt_ndc\").as(\"alt_ndc\"),\n        x.getField(\"alt_formulary_tier\").as(\"alt_formulary_tier\"),\n        x.getField(\"alt_multi_src_cd\").as(\"alt_multi_src_cd\"),\n        x.getField(\"alt_roa_cd\").as(\"alt_roa_cd\"),\n        x.getField(\"alt_dosage_form_cd\").as(\"alt_dosage_form_cd\"),\n        x.getField(\"rank\").as(\"rank\"),\n        x.getField(\"alt_step_therapy_ind\").as(\"alt_step_therapy_ind\"),\n        x.getField(\"alt_pa_reqd_ind\").as(\"alt_pa_reqd_ind\"),\n        x.getField(\"alt_formulary_status\").as(\"alt_formulary_status\"),\n        x.getField(\"alt_specialty_ind\").as(\"alt_specialty_ind\"),\n        x.getField(\"alt_gpi14\").as(\"alt_gpi14\"),\n        x.getField(\"alt_prod_name_ext\").as(\"alt_prod_name_ext\"),\n        x.getField(\"alt_prod_short_desc\").as(\"alt_prod_short_desc\"),\n        x.getField(\"alt_prod_short_desc_grp\").as(\"alt_prod_short_desc_grp\"),\n        x.getField(\"alt_gpi14_desc\").as(\"alt_gpi14_desc\"),\n        x.getField(\"alt_gpi8_desc\").as(\"alt_gpi8_desc\"),\n        x.getField(\"alt_formulary_tier_desc\").as(\"alt_formulary_tier_desc\"),\n        x.getField(\"alt_formulary_status_desc\").as(\"alt_formulary_status_desc\"),\n        x.getField(\"alt_pa_type_cd\").as(\"alt_pa_type_cd\"),\n        x.getField(\"alt_step_therapy_type_cd\").as(\"alt_step_therapy_type_cd\"),\n        x.getField(\"alt_step_therapy_group_name\").as(\"alt_step_therapy_group_name\"),\n        x.getField(\"alt_step_therapy_step_number\").as(\"alt_step_therapy_step_number\"),\n        x.getField(\"rec_crt_ts\").as(\"rec_crt_ts\"),\n        x.getField(\"rec_crt_user_id\").as(\"rec_crt_user_id\"),\n        x.getField(\"rebate_elig_cd\").as(\"rebate_elig_cd\"),\n        x.getField(\"tad_eligible_cd\").as(\"tad_eligible_cd\"),\n        x.getField(\"alt_qty_adj\").as(\"alt_qty_adj\"),\n        x.getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n        x.getField(\"tala\").as(\"tala\"),\n        x.getField(\"alt_udl\").as(\"alt_udl\"),\n        x.getField(\"tal_assoc_rank\").as(\"tal_assoc_rank\"),\n        x.getField(\"constituent_group\").as(\"constituent_group\"),\n        x.getField(\"constituent_reqd\").as(\"constituent_reqd\"),\n        coalesce(x.getField(\"newline\"),                        lit(\"\\n\")).as(\"newline\")\n      )\n  )"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat" : {
              "id" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
              "component" : "Reformat",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
                "slug" : "Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat",
                "x" : 620,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_Reformat__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "expressions" : [ {
                  "target" : "alt_run_alt_dtl_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_alt_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_run_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_run_target_dtl_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
                  },
                  "description" : ""
                }, {
                  "target" : "formulary_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"formulary_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "target_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"target_ndc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_ndc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_tier",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_tier\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_multi_src_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_multi_src_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_roa_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_roa_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_dosage_form_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_dosage_form_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rank\").cast(StringType)"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_pa_reqd_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_pa_reqd_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_status",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_status\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_specialty_ind",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_specialty_ind\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi14",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi14\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_name_ext",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_name_ext\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_short_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_short_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_prod_short_desc_grp",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_prod_short_desc_grp\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi14_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi14_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_gpi8_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_gpi8_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_tier_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_tier_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_formulary_status_desc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_formulary_status_desc\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_pa_type_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_pa_type_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_type_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_type_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_group_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_group_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_step_therapy_step_number",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_step_therapy_step_number\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rec_crt_ts",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rec_crt_ts\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rec_crt_user_id",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rec_crt_user_id\")"
                  },
                  "description" : ""
                }, {
                  "target" : "rebate_elig_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"rebate_elig_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tad_eligible_cd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tad_eligible_cd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_qty_adj",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_qty_adj\").cast(DecimalType(6, 3))"
                  },
                  "description" : ""
                }, {
                  "target" : "tal_assoc_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_assoc_name\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tala",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tala\")"
                  },
                  "description" : ""
                }, {
                  "target" : "alt_udl",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_udl\")"
                  },
                  "description" : ""
                }, {
                  "target" : "tal_assoc_rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_assoc_rank\").cast(DecimalType(38, 6))"
                  },
                  "description" : ""
                }, {
                  "target" : "constituent_group",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"constituent_group\")"
                  },
                  "description" : ""
                }, {
                  "target" : "constituent_reqd",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"constituent_reqd\")"
                  },
                  "description" : ""
                }, {
                  "target" : "newline",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Normalize_Alt_Proxy_Products" : {
              "id" : "Normalize_Alt_Proxy_Products",
              "component" : "Script",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products",
                "slug" : "Normalize_Alt_Proxy_Products",
                "x" : 620,
                "y" : 220,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "alt_run_alt_dtl_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_run_target_dtl_id",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "formulary_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "target_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_ndc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_multi_src_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_roa_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_dosage_form_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_reqd_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_specialty_ind",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_name_ext",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_prod_short_desc_grp",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi14_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_gpi8_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_tier_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_formulary_status_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_pa_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_type_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_group_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_step_therapy_step_number",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_ts",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rec_crt_user_id",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "rebate_elig_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tad_eligible_cd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_qty_adj",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_name",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tala",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "alt_udl",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "tal_assoc_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "newline",
                            "type" : "string",
                            "nullable" : false,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : false
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__Normalize_Alt_Proxy_Products__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_run_alt_dtl_load_vec\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_run_alt_dtl_id\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_alt_dtl_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_run_id\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"*\")\n        .cast(DecimalType(16, 0)))\n        .as(\"alt_run_target_dtl_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"formulary_name\")).as(\"formulary_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"target_ndc\")).as(\"target_ndc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_ndc\")).as(\"alt_ndc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_tier\")).as(\"alt_formulary_tier\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_multi_src_cd\")).as(\"alt_multi_src_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_roa_cd\")).as(\"alt_roa_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_dosage_form_cd\")).as(\"alt_dosage_form_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rank\").cast(StringType)).as(\"rank\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_step_therapy_ind\")).as(\"alt_step_therapy_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_pa_reqd_ind\")).as(\"alt_pa_reqd_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_status\")).as(\"alt_formulary_status\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_specialty_ind\")).as(\"alt_specialty_ind\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi14\")).as(\"alt_gpi14\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_name_ext\")).as(\"alt_prod_name_ext\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_short_desc\")).as(\"alt_prod_short_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_prod_short_desc_grp\")).as(\"alt_prod_short_desc_grp\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi14_desc\")).as(\"alt_gpi14_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_gpi8_desc\")).as(\"alt_gpi8_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_formulary_tier_desc\")).as(\"alt_formulary_tier_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_formulary_status_desc\"))\n        .as(\"alt_formulary_status_desc\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_pa_type_cd\")).as(\"alt_pa_type_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_step_therapy_type_cd\")).as(\"alt_step_therapy_type_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_step_therapy_group_name\"))\n        .as(\"alt_step_therapy_group_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"alt_step_therapy_step_number\"))\n        .as(\"alt_step_therapy_step_number\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rec_crt_ts\")).as(\"rec_crt_ts\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rec_crt_user_id\")).as(\"rec_crt_user_id\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"rebate_elig_cd\")).as(\"rebate_elig_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tad_eligible_cd\")).as(\"tad_eligible_cd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"*\")\n        .cast(DecimalType(6, 3)))\n        .as(\"alt_qty_adj\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"tala\")).as(\"tala\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"alt_udl\")).as(\"alt_udl\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1))\n        .getField(\"tal_assoc_rank\")\n        .cast(DecimalType(38, 6)))\n        .as(\"tal_assoc_rank\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"constituent_group\")).as(\"constituent_group\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"constituent_reqd\")).as(\"constituent_reqd\"),\n      (element_at(col(\"alt_run_alt_dtl_load_vec\"), col(\"index\") + lit(1)).getField(\"newline\").cast(StringType)).as(\"newline\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"alt_run_alt_dtl_id\")).as(\"alt_run_alt_dtl_id\"),\n    (col(\"alt_run_id\")).as(\"alt_run_id\"),\n    (col(\"alt_run_target_dtl_id\")).as(\"alt_run_target_dtl_id\"),\n    (col(\"formulary_name\")).as(\"formulary_name\"),\n    (col(\"target_ndc\")).as(\"target_ndc\"),\n    (col(\"alt_ndc\")).as(\"alt_ndc\"),\n    (col(\"alt_formulary_tier\")).as(\"alt_formulary_tier\"),\n    (col(\"alt_multi_src_cd\")).as(\"alt_multi_src_cd\"),\n    (col(\"alt_roa_cd\")).as(\"alt_roa_cd\"),\n    (col(\"alt_dosage_form_cd\")).as(\"alt_dosage_form_cd\"),\n    (col(\"rank\")).as(\"rank\"),\n    (col(\"alt_step_therapy_ind\")).as(\"alt_step_therapy_ind\"),\n    (col(\"alt_pa_reqd_ind\")).as(\"alt_pa_reqd_ind\"),\n    (col(\"alt_formulary_status\")).as(\"alt_formulary_status\"),\n    (col(\"alt_specialty_ind\")).as(\"alt_specialty_ind\"),\n    (col(\"alt_gpi14\")).as(\"alt_gpi14\"),\n    (col(\"alt_prod_name_ext\")).as(\"alt_prod_name_ext\"),\n    (col(\"alt_prod_short_desc\")).as(\"alt_prod_short_desc\"),\n    (col(\"alt_prod_short_desc_grp\")).as(\"alt_prod_short_desc_grp\"),\n    (col(\"alt_gpi14_desc\")).as(\"alt_gpi14_desc\"),\n    (col(\"alt_gpi8_desc\")).as(\"alt_gpi8_desc\"),\n    (col(\"alt_formulary_tier_desc\")).as(\"alt_formulary_tier_desc\"),\n    (col(\"alt_formulary_status_desc\")).as(\"alt_formulary_status_desc\"),\n    (col(\"alt_pa_type_cd\")).as(\"alt_pa_type_cd\"),\n    (col(\"alt_step_therapy_type_cd\")).as(\"alt_step_therapy_type_cd\"),\n    (col(\"alt_step_therapy_group_name\")).as(\"alt_step_therapy_group_name\"),\n    (col(\"alt_step_therapy_step_number\")).as(\"alt_step_therapy_step_number\"),\n    (col(\"rec_crt_ts\")).as(\"rec_crt_ts\"),\n    (col(\"rec_crt_user_id\")).as(\"rec_crt_user_id\"),\n    (col(\"rebate_elig_cd\")).as(\"rebate_elig_cd\"),\n    (col(\"tad_eligible_cd\")).as(\"tad_eligible_cd\"),\n    (col(\"alt_qty_adj\")).as(\"alt_qty_adj\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"tala\")).as(\"tala\"),\n    (col(\"alt_udl\")).as(\"alt_udl\"),\n    (col(\"tal_assoc_rank\")).as(\"tal_assoc_rank\"),\n    (col(\"constituent_group\")).as(\"constituent_group\"),\n    (col(\"constituent_reqd\")).as(\"constituent_reqd\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
                "scriptMethodFooter" : "    out\n}"
              }
            },
            "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe" : {
              "id" : "jeAaQsnUBvVBck04F0KKA$$DggpaxxsC4DJ8B6DJKAxe",
              "component" : "Aggregate",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_1",
                "slug" : "Association_Processing__Alternative_Rollup_Processing__Identify_Alt_Proxy_Targets_w_o_Constituent_1",
                "x" : 220,
                "y" : 20,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "H5fZmwWlbI4umLZnBqBj_$$aJBcwOodL-Lp93Oi9YHH8",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "allIns" : false,
                "doPivot" : false,
                "aggregate" : [ {
                  "_row_id" : "c_36",
                  "target" : "out",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "    element_at(reverse(filter(\n    collect_list(\n      col(\"alt_run_alt_dtl_load\")\n    ),\n     xx => xx.getField(\"rank\") === min(col(\"alt_run_alt_dtl_load.rank\"))\n    )), 1)"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_52",
                  "target" : "rank",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "min(col(\"alt_run_alt_dtl_load.rank\").cast(StringType)).cast(StringType)"
                  },
                  "description" : ""
                } ],
                "allowSelection" : true,
                "pivotValues" : [ ],
                "activeTab" : "aggregate",
                "columnsSelector" : [ "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.tal_assoc_name", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.target_ndc", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.alt_prod_short_desc_grp", "wmQ_4TYkkhZw5lFUP5Lpt$$V52SK1rw_Fi4FwbQ1zyES##alt_run_alt_dtl_load.rank" ],
                "groupBy" : [ {
                  "_row_id" : "c_15",
                  "target" : "tal_assoc_name",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.tal_assoc_name\")"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_18",
                  "target" : "target_ndc",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.target_ndc\")"
                  },
                  "description" : ""
                }, {
                  "_row_id" : "c_21",
                  "target" : "alt_prod_short_desc_grp",
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"alt_run_alt_dtl_load.alt_prod_short_desc_grp\")"
                  },
                  "description" : ""
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Aggregate",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "FBE_Target_Product_with_without_Constituent_Data" : {
              "id" : "FBE_Target_Product_with_without_Constituent_Data",
              "component" : "RowDistributor",
              "metadata" : {
                "label" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data",
                "slug" : "FBE_Target_Product_with_without_Constituent_Data",
                "x" : 20,
                "y" : 120,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_load",
                      "type" : {
                        "type" : "struct",
                        "fields" : [ {
                          "name" : "alt_run_alt_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_run_target_dtl_id",
                          "type" : "decimal(16,0)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "formulary_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "target_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_ndc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_multi_src_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_roa_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_dosage_form_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rank",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_reqd_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_specialty_ind",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_name_ext",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_prod_short_desc_grp",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi14_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_gpi8_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_tier_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_formulary_status_desc",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_pa_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_type_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_group_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_step_therapy_step_number",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_ts",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rec_crt_user_id",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "rebate_elig_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tad_eligible_cd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_qty_adj",
                          "type" : "decimal(6,3)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_name",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tala",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "alt_udl",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "tal_assoc_rank",
                          "type" : "decimal(38,6)",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_group",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "constituent_reqd",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        }, {
                          "name" : "newline",
                          "type" : "string",
                          "nullable" : true,
                          "metadata" : {
                            "description" : "",
                            "mappings" : [ ],
                            "tags" : [ ]
                          }
                        } ]
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_grp_vec",
                      "type" : {
                        "type" : "array",
                        "elementType" : "string",
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "is_valid_rec",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
                  "slug" : "out0"
                }, {
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
                  "slug" : "out1"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "outports" : [ {
                  "path" : "out0",
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out0",
                  "model" : {
                    "format" : "scala",
                    "expression" : "!size(col(\"constituent_grp_vec\")).cast(BooleanType)"
                  }
                }, {
                  "path" : "out1",
                  "id" : "Association_Processing__Alternative_Rollup_Processing__FBE_Target_Product_with_without_Constituent_Data__out1",
                  "model" : {
                    "format" : "scala",
                    "expression" : "size(col(\"constituent_grp_vec\")).cast(BooleanType)"
                  }
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
                "projectName" : "ProphecySparkBasicsScala"
              }
            }
          }
        },
        "Normalize_TAL_Alts_assign_attributes" : {
          "id" : "Normalize_TAL_Alts_assign_attributes",
          "component" : "Script",
          "metadata" : {
            "label" : "Association_Processing__Normalize_TAL_Alts_assign_attributes",
            "slug" : "Normalize_TAL_Alts_assign_attributes",
            "x" : 1220,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : false,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : false
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Normalize_TAL_Alts_assign_attributes__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_alt_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prod_short_desc_grp",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_step_therapy_step_number",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rebate_elig_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tad_eligible_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_qty_adj",
                      "type" : "decimal(6,3)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "decimal(38,6)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "def temp202006_UDF(alt_prod_attrs: org.apache.spark.sql.Column) = {\n  val _alt_group_names_list = flatten(\n    transform(\n      lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_alt_st_grp_nums\"),\n      xx =>\n        array_intersect(\n          coalesce(\n            lookup(\"LKP_Step_Grp_NM\", alt_prod_attrs.getField(\"ndc11\"), xx)\n              .getField(\"step_therapy_group_names\"),\n            array()\n          ),\n          col(\"tar_group_names\")\n        )\n    )\n  )\n\n  val _alt_group_num = filter(\n    transform(\n      lookup(\"LKP_ST_GRP_NUM\", lit(0)).getField(\"_alt_st_grp_nums\"),\n      xx =>\n        when(\n          size(\n            array_intersect(\n              coalesce(\n                lookup(\"LKP_Step_Grp_NM\", alt_prod_attrs.getField(\"ndc11\"), xx)\n                  .getField(\"step_therapy_group_names\"),\n                array()\n              ),\n              col(\"tar_group_names\")\n            )\n          ) > lit(0),\n          xx\n        ),\n      xx => !isnull(xx)\n    )\n  )\n\n  struct(\n    _alt_group_names_list.as(\"_alt_group_names_list\"),\n    _alt_group_num(\"_alt_group_num\")\n  )\n}\n\n\n  \n  val normalizeDF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_products_def\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (\n        struct(\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_alt_dtl_id\"),\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_id\"),\n          lit(-1).cast(DecimalType(16, 0)).as(\"alt_run_target_dtl_id\"),\n          lit(Config.FORMULARY_NM).as(\"formulary_name\"),\n          col(\"target_dtl.target_ndc\").as(\"target_ndc\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"ndc11\").as(\"alt_ndc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_tier\")\n          ).otherwise(lit(null)).as(\"alt_formulary_tier\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"msc\").as(\"alt_multi_src_cd\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"roa_cd\").as(\"alt_roa_cd\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"dosage_form_cd\").as(\"alt_dosage_form_cd\"),\n          (col(\"index\") + lit(1)).cast(StringType).as(\"rank\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"step_therapy_ind\")\n          ).otherwise(lit(null)).as(\"alt_step_therapy_ind\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"pa_reqd_ind\")\n          ).otherwise(lit(null)).as(\"alt_pa_reqd_ind\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_status\")\n          ).otherwise(lit(null)).as(\"alt_formulary_status\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"specialty_ind\")\n          ).otherwise(lit(null)).as(\"alt_specialty_ind\"),\n          when(\n            is_blank(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"gpi14\")\n            ),\n            lit(\" \")\n          ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"gpi14\")\n            )\n            .as(\"alt_gpi14\"),\n          when(\n            is_blank(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"drug_name\")\n            ),\n            lit(\" \")\n          ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"drug_name\")\n            )\n            .as(\"alt_prod_name_ext\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"prod_short_desc\").as(\"alt_prod_short_desc\"),\n          string_substring(\n            when(\n              when(file_information(lit(Config.ALIAS_PRODUCT_FILE)).getField(\"size\").cast(BooleanType),\n                   lit(1).cast(BooleanType)\n              ).otherwise(lit(0).cast(BooleanType)),\n              lookup(\n                \"LKP_Alias_Prod\",\n                coalesce(\n                  lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                  struct(\n                    lit(null).as(\"alt_run_alt_dtl_id\"),\n                    lit(null).as(\"alt_run_id\"),\n                    lit(null).as(\"alt_run_target_dtl_id\"),\n                    lit(null).as(\"formulary_name\"),\n                    lit(null).as(\"target_ndc\"),\n                    lit(null).as(\"alt_ndc\"),\n                    lit(null).as(\"alt_formulary_tier\"),\n                    lit(null).as(\"alt_multi_src_cd\"),\n                    lit(null).as(\"alt_roa_cd\"),\n                    lit(null).as(\"alt_dosage_form_cd\"),\n                    lit(null).as(\"rank\"),\n                    lit(null).as(\"alt_step_therapy_ind\"),\n                    lit(null).as(\"alt_pa_reqd_ind\"),\n                    lit(null).as(\"alt_formulary_status\"),\n                    lit(null).as(\"alt_specialty_ind\"),\n                    lit(null).as(\"alt_gpi14\"),\n                    lit(null).as(\"alt_prod_name_ext\"),\n                    lit(null).as(\"alt_prod_short_desc\"),\n                    lit(null).as(\"alt_prod_short_desc_grp\"),\n                    lit(null).as(\"alt_gpi14_desc\"),\n                    lit(null).as(\"alt_gpi8_desc\"),\n                    lit(null).as(\"alt_formulary_tier_desc\"),\n                    lit(null).as(\"alt_formulary_status_desc\"),\n                    lit(null).as(\"alt_pa_type_cd\"),\n                    lit(null).as(\"alt_step_therapy_type_cd\"),\n                    lit(null).as(\"alt_step_therapy_group_name\"),\n                    lit(null).as(\"alt_step_therapy_step_number\"),\n                    lit(null).as(\"rec_crt_ts\"),\n                    lit(null).as(\"rec_crt_user_id\"),\n                    lit(null).as(\"rebate_elig_cd\"),\n                    lit(null).as(\"tad_eligible_cd\"),\n                    lit(null).as(\"alt_qty_adj\"),\n                    lit(null).as(\"tal_assoc_name\"),\n                    lit(null).as(\"tala\"),\n                    lit(null).as(\"alt_udl\"),\n                    lit(null).as(\"tal_assoc_rank\"),\n                    lit(null).as(\"constituent_group\"),\n                    lit(null).as(\"constituent_reqd\"),\n                    lit(null).as(\"newline\")\n                  )\n                ).getField(\"ndc11\")\n              ).getField(\"alias_label_nm\")\n            ).otherwise(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"prod_short_desc\")\n            ),\n            lit(1),\n            lit(12)\n          ).as(\"alt_prod_short_desc_grp\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"gpi14_desc\").as(\"alt_gpi14_desc\"),\n          coalesce(\n            lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n            struct(\n              lit(null).as(\"alt_run_alt_dtl_id\"),\n              lit(null).as(\"alt_run_id\"),\n              lit(null).as(\"alt_run_target_dtl_id\"),\n              lit(null).as(\"formulary_name\"),\n              lit(null).as(\"target_ndc\"),\n              lit(null).as(\"alt_ndc\"),\n              lit(null).as(\"alt_formulary_tier\"),\n              lit(null).as(\"alt_multi_src_cd\"),\n              lit(null).as(\"alt_roa_cd\"),\n              lit(null).as(\"alt_dosage_form_cd\"),\n              lit(null).as(\"rank\"),\n              lit(null).as(\"alt_step_therapy_ind\"),\n              lit(null).as(\"alt_pa_reqd_ind\"),\n              lit(null).as(\"alt_formulary_status\"),\n              lit(null).as(\"alt_specialty_ind\"),\n              lit(null).as(\"alt_gpi14\"),\n              lit(null).as(\"alt_prod_name_ext\"),\n              lit(null).as(\"alt_prod_short_desc\"),\n              lit(null).as(\"alt_prod_short_desc_grp\"),\n              lit(null).as(\"alt_gpi14_desc\"),\n              lit(null).as(\"alt_gpi8_desc\"),\n              lit(null).as(\"alt_formulary_tier_desc\"),\n              lit(null).as(\"alt_formulary_status_desc\"),\n              lit(null).as(\"alt_pa_type_cd\"),\n              lit(null).as(\"alt_step_therapy_type_cd\"),\n              lit(null).as(\"alt_step_therapy_group_name\"),\n              lit(null).as(\"alt_step_therapy_step_number\"),\n              lit(null).as(\"rec_crt_ts\"),\n              lit(null).as(\"rec_crt_user_id\"),\n              lit(null).as(\"rebate_elig_cd\"),\n              lit(null).as(\"tad_eligible_cd\"),\n              lit(null).as(\"alt_qty_adj\"),\n              lit(null).as(\"tal_assoc_name\"),\n              lit(null).as(\"tala\"),\n              lit(null).as(\"alt_udl\"),\n              lit(null).as(\"tal_assoc_rank\"),\n              lit(null).as(\"constituent_group\"),\n              lit(null).as(\"constituent_reqd\"),\n              lit(null).as(\"newline\")\n            )\n          ).getField(\"gpi8_desc\").as(\"alt_gpi8_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_tier_desc\")\n          ).otherwise(lit(null)).as(\"alt_formulary_tier_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"formulary_status_desc\")\n          ).otherwise(lit(null)).as(\"alt_formulary_status_desc\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"pa_type_cd\")\n          ).otherwise(lit(null)).as(\"alt_pa_type_cd\"),\n          when(\n            !isnull(\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ),\n            lookup(\n              \"LKP_Form_CAG_dataset\",\n              coalesce(\n                lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                struct(\n                  lit(null).as(\"alt_run_alt_dtl_id\"),\n                  lit(null).as(\"alt_run_id\"),\n                  lit(null).as(\"alt_run_target_dtl_id\"),\n                  lit(null).as(\"formulary_name\"),\n                  lit(null).as(\"target_ndc\"),\n                  lit(null).as(\"alt_ndc\"),\n                  lit(null).as(\"alt_formulary_tier\"),\n                  lit(null).as(\"alt_multi_src_cd\"),\n                  lit(null).as(\"alt_roa_cd\"),\n                  lit(null).as(\"alt_dosage_form_cd\"),\n                  lit(null).as(\"rank\"),\n                  lit(null).as(\"alt_step_therapy_ind\"),\n                  lit(null).as(\"alt_pa_reqd_ind\"),\n                  lit(null).as(\"alt_formulary_status\"),\n                  lit(null).as(\"alt_specialty_ind\"),\n                  lit(null).as(\"alt_gpi14\"),\n                  lit(null).as(\"alt_prod_name_ext\"),\n                  lit(null).as(\"alt_prod_short_desc\"),\n                  lit(null).as(\"alt_prod_short_desc_grp\"),\n                  lit(null).as(\"alt_gpi14_desc\"),\n                  lit(null).as(\"alt_gpi8_desc\"),\n                  lit(null).as(\"alt_formulary_tier_desc\"),\n                  lit(null).as(\"alt_formulary_status_desc\"),\n                  lit(null).as(\"alt_pa_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_type_cd\"),\n                  lit(null).as(\"alt_step_therapy_group_name\"),\n                  lit(null).as(\"alt_step_therapy_step_number\"),\n                  lit(null).as(\"rec_crt_ts\"),\n                  lit(null).as(\"rec_crt_user_id\"),\n                  lit(null).as(\"rebate_elig_cd\"),\n                  lit(null).as(\"tad_eligible_cd\"),\n                  lit(null).as(\"alt_qty_adj\"),\n                  lit(null).as(\"tal_assoc_name\"),\n                  lit(null).as(\"tala\"),\n                  lit(null).as(\"alt_udl\"),\n                  lit(null).as(\"tal_assoc_rank\"),\n                  lit(null).as(\"constituent_group\"),\n                  lit(null).as(\"constituent_reqd\"),\n                  lit(null).as(\"newline\")\n                )\n              ).getField(\"ndc11\")\n            ).getField(\"step_therapy_type_cd\")\n          ).otherwise(lit(null)).as(\"alt_step_therapy_type_cd\"),\n          when(\n            size(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            array_join(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array()),\n              \"|\"\n            )\n          ).otherwise(lit(\"\")).as(\"alt_step_therapy_group_name\"),\n          when(\n            size(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            array_join(\n              when(\n                !isnull(\n                  coalesce(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                    struct(\n                      lit(null).as(\"alt_run_alt_dtl_id\"),\n                      lit(null).as(\"alt_run_id\"),\n                      lit(null).as(\"alt_run_target_dtl_id\"),\n                      lit(null).as(\"formulary_name\"),\n                      lit(null).as(\"target_ndc\"),\n                      lit(null).as(\"alt_ndc\"),\n                      lit(null).as(\"alt_formulary_tier\"),\n                      lit(null).as(\"alt_multi_src_cd\"),\n                      lit(null).as(\"alt_roa_cd\"),\n                      lit(null).as(\"alt_dosage_form_cd\"),\n                      lit(null).as(\"rank\"),\n                      lit(null).as(\"alt_step_therapy_ind\"),\n                      lit(null).as(\"alt_pa_reqd_ind\"),\n                      lit(null).as(\"alt_formulary_status\"),\n                      lit(null).as(\"alt_specialty_ind\"),\n                      lit(null).as(\"alt_gpi14\"),\n                      lit(null).as(\"alt_prod_name_ext\"),\n                      lit(null).as(\"alt_prod_short_desc\"),\n                      lit(null).as(\"alt_prod_short_desc_grp\"),\n                      lit(null).as(\"alt_gpi14_desc\"),\n                      lit(null).as(\"alt_gpi8_desc\"),\n                      lit(null).as(\"alt_formulary_tier_desc\"),\n                      lit(null).as(\"alt_formulary_status_desc\"),\n                      lit(null).as(\"alt_pa_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_type_cd\"),\n                      lit(null).as(\"alt_step_therapy_group_name\"),\n                      lit(null).as(\"alt_step_therapy_step_number\"),\n                      lit(null).as(\"rec_crt_ts\"),\n                      lit(null).as(\"rec_crt_user_id\"),\n                      lit(null).as(\"rebate_elig_cd\"),\n                      lit(null).as(\"tad_eligible_cd\"),\n                      lit(null).as(\"alt_qty_adj\"),\n                      lit(null).as(\"tal_assoc_name\"),\n                      lit(null).as(\"tala\"),\n                      lit(null).as(\"alt_udl\"),\n                      lit(null).as(\"tal_assoc_rank\"),\n                      lit(null).as(\"constituent_group\"),\n                      lit(null).as(\"constituent_reqd\"),\n                      lit(null).as(\"newline\")\n                    )\n                  ).getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    coalesce(\n                      lookup(\"LKP_Prod\",\n                             element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                      ),\n                      struct(\n                        lit(null).as(\"alt_run_alt_dtl_id\"),\n                        lit(null).as(\"alt_run_id\"),\n                        lit(null).as(\"alt_run_target_dtl_id\"),\n                        lit(null).as(\"formulary_name\"),\n                        lit(null).as(\"target_ndc\"),\n                        lit(null).as(\"alt_ndc\"),\n                        lit(null).as(\"alt_formulary_tier\"),\n                        lit(null).as(\"alt_multi_src_cd\"),\n                        lit(null).as(\"alt_roa_cd\"),\n                        lit(null).as(\"alt_dosage_form_cd\"),\n                        lit(null).as(\"rank\"),\n                        lit(null).as(\"alt_step_therapy_ind\"),\n                        lit(null).as(\"alt_pa_reqd_ind\"),\n                        lit(null).as(\"alt_formulary_status\"),\n                        lit(null).as(\"alt_specialty_ind\"),\n                        lit(null).as(\"alt_gpi14\"),\n                        lit(null).as(\"alt_prod_name_ext\"),\n                        lit(null).as(\"alt_prod_short_desc\"),\n                        lit(null).as(\"alt_prod_short_desc_grp\"),\n                        lit(null).as(\"alt_gpi14_desc\"),\n                        lit(null).as(\"alt_gpi8_desc\"),\n                        lit(null).as(\"alt_formulary_tier_desc\"),\n                        lit(null).as(\"alt_formulary_status_desc\"),\n                        lit(null).as(\"alt_pa_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_type_cd\"),\n                        lit(null).as(\"alt_step_therapy_group_name\"),\n                        lit(null).as(\"alt_step_therapy_step_number\"),\n                        lit(null).as(\"rec_crt_ts\"),\n                        lit(null).as(\"rec_crt_user_id\"),\n                        lit(null).as(\"rebate_elig_cd\"),\n                        lit(null).as(\"tad_eligible_cd\"),\n                        lit(null).as(\"alt_qty_adj\"),\n                        lit(null).as(\"tal_assoc_name\"),\n                        lit(null).as(\"tala\"),\n                        lit(null).as(\"alt_udl\"),\n                        lit(null).as(\"tal_assoc_rank\"),\n                        lit(null).as(\"constituent_group\"),\n                        lit(null).as(\"constituent_reqd\"),\n                        lit(null).as(\"newline\")\n                      )\n                    )\n                  ).getField(\"_alt_group_num\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array()),\n              \"|\"\n            )\n          ).otherwise(lit(0.0)).as(\"alt_step_therapy_step_number\"),\n          lit(Config.RUN_TS).as(\"rec_crt_ts\"),\n          lit(Config.USER_ID).as(\"rec_crt_user_id\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"rebate_elig_cd\").as(\"rebate_elig_cd\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tad_eli_code\").as(\"tad_eligible_cd\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"qty_adjust_factor\")\n            .cast(DecimalType(6, 3))\n            .as(\"alt_qty_adj\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"tala\").as(\"tala\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"udl_nm\").as(\"alt_udl\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"priority\")\n            .cast(DecimalType(38, 6))\n            .as(\"tal_assoc_rank\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"constituent_group\")\n            .as(\"constituent_group\"),\n          element_at(col(\"alt_products_def\"), col(\"index\") + lit(1))\n            .getField(\"constituent_reqd\")\n            .as(\"constituent_reqd\"),\n          lit(\"\\n\").cast(StringType).as(\"newline\")\n        )\n      ).as(\"alt_run_alt_dtl_load\"),\n      (when(\n        !isnull(\n          lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n            .getField(\"ndc11\")\n        ),\n        when(\n          col(\"ST_flag\").cast(BooleanType),\n          when(\n            !size(\n              when(\n                !isnull(\n                  lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n                    .getField(\"ndc11\")\n                ),\n                when(\n                  col(\"ST_flag\").cast(BooleanType),\n                  temp202006_UDF(\n                    lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")),\n                  ).getField(\"_alt_group_names_list\")\n                ).otherwise(\n                  array()\n                )\n              ).otherwise(array())\n            ).cast(BooleanType),\n            lit(0)\n          ).when(\n              isnull(\n                lookup(\"LKP_Form_CAG_dataset\",\n                       lookup(\"LKP_Prod\",\n                              element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\")\n                       ).getField(\"ndc11\")\n                )\n              ),\n              lit(0)\n            )\n            .otherwise(lit(1))\n        ).when(\n            isnull(\n              lookup(\"LKP_Form_CAG_dataset\",\n                     lookup(\"LKP_Prod\", element_at(col(\"alt_products_def\"), col(\"index\") + lit(1)).getField(\"alt_prd\"))\n                       .getField(\"ndc11\")\n              )\n            ),\n            lit(0)\n          )\n          .otherwise(lit(1))\n      ).otherwise(lit(0))).as(\"is_valid_rec\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalizeDF.select(\n    (col(\"alt_run_alt_dtl_load\")).as(\"alt_run_alt_dtl_load\"),\n    (col(\"constituent_grp_vec\")).as(\"constituent_grp_vec\"),\n    (col(\"is_valid_rec\")).as(\"is_valid_rec\")\n  )\n\n  val normalize_out_DF = simpleSelect_in_DF.filter(col(\"is_valid_rec\"))\n\n  val out = normalize_out_DF\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0" : {
          "id" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
            "slug" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_0",
            "x" : 1020,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_0__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"target_dtl.alt_run_target_dtl_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"target_dtl.alt_run_id\").cast(DecimalType(16, 0)), lit(-1))"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tala\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl\")"
              },
              "description" : ""
            }, {
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.formulary_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_ndc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_tier",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_tier\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_status",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_status\")"
              },
              "description" : ""
            }, {
              "target" : "target_pa_reqd_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_pa_reqd_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_specialty_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_specialty_ind\")"
              },
              "description" : ""
            }, {
              "target" : "target_multi_src_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_multi_src_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_roa_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_roa_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_dosage_form_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_dosage_form_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi14",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi14\")"
              },
              "description" : ""
            }, {
              "target" : "target_prod_name_ext",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_prod_name_ext\")"
              },
              "description" : ""
            }, {
              "target" : "target_prod_short_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_prod_short_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi14_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi14_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_gpi8_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_gpi8_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_tier_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_tier_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_formulary_status_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_formulary_status_desc\")"
              },
              "description" : ""
            }, {
              "target" : "target_pa_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_pa_type_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_type_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_group_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_group_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_step_therapy_step_num",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.target_step_therapy_step_num\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "formulary_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.formulary_cd\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.rec_crt_ts\")"
              },
              "description" : ""
            }, {
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.rec_crt_user_id\")"
              },
              "description" : ""
            }, {
              "target" : "last_exp_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_dtl.last_exp_dt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(rpad(col(\"target_dtl.newline\"), 1, \" \"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1" : {
          "id" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
          "component" : "Reformat",
          "metadata" : {
            "label" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
            "slug" : "Separate_Target_and_Alternative_Load_Ready_FilesReformat_1",
            "x" : 1020,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dtl",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "ST_flag",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_group_names",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_products_def",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "alt_prd",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "alt_rank",
                        "type" : "integer",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "rebate_elig_cd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tad_eli_code",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "qty_adjust_factor",
                        "type" : "decimal(6,3)",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tal_assoc_name",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "tala",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "priority",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_grp_vec",
                  "type" : {
                    "type" : "array",
                    "elementType" : "string",
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Separate_Target_and_Alternative_Load_Ready_FilesReformat_1__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "target_dtl",
              "expression" : {
                "format" : "scala",
                "expression" : "struct(\n    coalesce(col(\"target_dtl\").getField(\"alt_run_target_dtl_id\"), lit(-1)).as(\"alt_run_target_dtl_id\"),\n    coalesce(col(\"target_dtl\").getField(\"alt_run_id\"),            lit(-1)).as(\"alt_run_id\"),\n    col(\"target_dtl\").getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n    col(\"target_dtl\").getField(\"tala\").as(\"tala\"),\n    col(\"target_dtl\").getField(\"tar_udl\").as(\"tar_udl\"),\n    col(\"target_dtl\").getField(\"formulary_name\").as(\"formulary_name\"),\n    col(\"target_dtl\").getField(\"target_ndc\").as(\"target_ndc\"),\n    col(\"target_dtl\").getField(\"target_formulary_tier\").as(\"target_formulary_tier\"),\n    col(\"target_dtl\").getField(\"target_formulary_status\").as(\"target_formulary_status\"),\n    col(\"target_dtl\").getField(\"target_pa_reqd_ind\").as(\"target_pa_reqd_ind\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_ind\").as(\"target_step_therapy_ind\"),\n    col(\"target_dtl\").getField(\"target_specialty_ind\").as(\"target_specialty_ind\"),\n    col(\"target_dtl\").getField(\"target_multi_src_cd\").as(\"target_multi_src_cd\"),\n    col(\"target_dtl\").getField(\"target_roa_cd\").as(\"target_roa_cd\"),\n    col(\"target_dtl\").getField(\"target_dosage_form_cd\").as(\"target_dosage_form_cd\"),\n    col(\"target_dtl\").getField(\"target_gpi14\").as(\"target_gpi14\"),\n    col(\"target_dtl\").getField(\"target_prod_name_ext\").as(\"target_prod_name_ext\"),\n    col(\"target_dtl\").getField(\"target_prod_short_desc\").as(\"target_prod_short_desc\"),\n    col(\"target_dtl\").getField(\"target_gpi14_desc\").as(\"target_gpi14_desc\"),\n    col(\"target_dtl\").getField(\"target_gpi8_desc\").as(\"target_gpi8_desc\"),\n    col(\"target_dtl\").getField(\"target_formulary_tier_desc\").as(\"target_formulary_tier_desc\"),\n    col(\"target_dtl\").getField(\"target_formulary_status_desc\").as(\"target_formulary_status_desc\"),\n    col(\"target_dtl\").getField(\"target_pa_type_cd\").as(\"target_pa_type_cd\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_type_cd\").as(\"target_step_therapy_type_cd\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_group_name\").as(\"target_step_therapy_group_name\"),\n    col(\"target_dtl\").getField(\"target_step_therapy_step_num\").as(\"target_step_therapy_step_num\"),\n    col(\"target_dtl\").getField(\"formulary_cd\").as(\"formulary_cd\"),\n    col(\"target_dtl\").getField(\"rec_crt_ts\").as(\"rec_crt_ts\"),\n    col(\"target_dtl\").getField(\"rec_crt_user_id\").as(\"rec_crt_user_id\"),\n    col(\"target_dtl\").getField(\"last_exp_dt\").as(\"last_exp_dt\"),\n    coalesce(col(\"target_dtl\").getField(\"newline\"),              lit(\"\\n\")).as(\"newline\")\n  )"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tala\")"
              },
              "description" : ""
            }, {
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_udl\")"
              },
              "description" : ""
            }, {
              "target" : "ST_flag",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"ST_flag\"), lit(0))"
              },
              "description" : ""
            }, {
              "target" : "tar_group_names",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tar_group_names\")"
              },
              "description" : ""
            }, {
              "target" : "alt_products_def",
              "expression" : {
                "format" : "scala",
                "expression" : "transform(\n    col(\"alt_products_def\"),\n    x =>\n      struct(\n        x.getField(\"alt_prd\").as(\"alt_prd\"),\n        x.getField(\"alt_rank\").as(\"alt_rank\"),\n        coalesce(x.getField(\"rebate_elig_cd\"), lit(\"\")).as(\"rebate_elig_cd\"),\n        x.getField(\"tad_eli_code\").as(\"tad_eli_code\"),\n        x.getField(\"qty_adjust_factor\").as(\"qty_adjust_factor\"),\n        x.getField(\"tal_assoc_name\").as(\"tal_assoc_name\"),\n        x.getField(\"tala\").as(\"tala\"),\n        x.getField(\"udl_nm\").as(\"udl_nm\"),\n        x.getField(\"priority\").as(\"priority\"),\n        x.getField(\"constituent_group\").as(\"constituent_group\"),\n        x.getField(\"constituent_reqd\").as(\"constituent_reqd\")\n      )\n  )"
              },
              "description" : ""
            }, {
              "target" : "constituent_grp_vec",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"constituent_grp_vec\")"
              },
              "description" : ""
            }, {
              "target" : "is_valid_rec",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"is_valid_rec\"), lit(1))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Get_Unique_Target_Products" : {
          "id" : "Get_Unique_Target_Products",
          "component" : "Join",
          "metadata" : {
            "label" : "Association_Processing__Get_Unique_Target_Products",
            "slug" : "Get_Unique_Target_Products",
            "x" : 1220,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__Get_Unique_Target_Products__left",
              "slug" : "left",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_load",
                  "type" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "alt_run_target_dtl_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_run_id",
                      "type" : "decimal(16,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tala",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tar_udl",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_ndc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_reqd_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_specialty_ind",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_multi_src_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_roa_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_dosage_form_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_name_ext",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prod_short_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi14_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_gpi8_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_tier_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_formulary_status_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_pa_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_group_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_step_therapy_step_num",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "formulary_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_ts",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "rec_crt_user_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "last_exp_dt",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "is_valid_rec",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Association_Processing__Get_Unique_Target_Products__right",
              "slug" : "right",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tar_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_step_therapy_step_num",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "last_exp_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__Get_Unique_Target_Products__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "conditions" : [ {
              "alias" : "right",
              "expression" : {
                "format" : "scala",
                "expression" : "(col(\"left.alt_run_target_dtl_load.tal_assoc_name\") === col(\"right.tal_assoc_name\")) && (col(\n    \"left.alt_run_target_dtl_load.target_ndc\"\n  ) === col(\"right.target_ndc\"))"
              },
              "joinType" : "inner"
            } ],
            "expressions" : [ {
              "_row_id" : null,
              "target" : "alt_run_target_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.alt_run_target_dtl_id\"), col(\"left.alt_run_target_dtl_load.alt_run_target_dtl_id\")), lit(-1))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "alt_run_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.alt_run_id\"), col(\"left.alt_run_target_dtl_load.alt_run_id\")), lit(-1))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tal_assoc_name\"), col(\"left.alt_run_target_dtl_load.tal_assoc_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tala",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tala\"), col(\"left.alt_run_target_dtl_load.tala\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "tar_udl",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.tar_udl\"), col(\"left.alt_run_target_dtl_load.tar_udl\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "formulary_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.formulary_name\"), col(\"left.alt_run_target_dtl_load.formulary_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_ndc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_ndc\"), col(\"left.alt_run_target_dtl_load.target_ndc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_tier",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_tier\"), col(\"left.alt_run_target_dtl_load.target_formulary_tier\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_status",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_status\"), col(\"left.alt_run_target_dtl_load.target_formulary_status\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_pa_reqd_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_pa_reqd_ind\"), col(\"left.alt_run_target_dtl_load.target_pa_reqd_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_ind\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_specialty_ind",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_specialty_ind\"), col(\"left.alt_run_target_dtl_load.target_specialty_ind\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_multi_src_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_multi_src_cd\"), col(\"left.alt_run_target_dtl_load.target_multi_src_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_roa_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_roa_cd\"), col(\"left.alt_run_target_dtl_load.target_roa_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_dosage_form_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_dosage_form_cd\"), col(\"left.alt_run_target_dtl_load.target_dosage_form_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi14",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi14\"), col(\"left.alt_run_target_dtl_load.target_gpi14\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_prod_name_ext",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_prod_name_ext\"), col(\"left.alt_run_target_dtl_load.target_prod_name_ext\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_prod_short_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_prod_short_desc\"), col(\"left.alt_run_target_dtl_load.target_prod_short_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi14_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi14_desc\"), col(\"left.alt_run_target_dtl_load.target_gpi14_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_gpi8_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_gpi8_desc\"), col(\"left.alt_run_target_dtl_load.target_gpi8_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_tier_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_tier_desc\"), col(\"left.alt_run_target_dtl_load.target_formulary_tier_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_formulary_status_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_formulary_status_desc\"), col(\"left.alt_run_target_dtl_load.target_formulary_status_desc\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_pa_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_pa_type_cd\"), col(\"left.alt_run_target_dtl_load.target_pa_type_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_type_cd\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_type_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_group_name",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_group_name\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_group_name\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "target_step_therapy_step_num",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.target_step_therapy_step_num\"), col(\"left.alt_run_target_dtl_load.target_step_therapy_step_num\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "formulary_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.formulary_cd\"), col(\"left.alt_run_target_dtl_load.formulary_cd\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "rec_crt_ts",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.rec_crt_ts\"), col(\"left.alt_run_target_dtl_load.rec_crt_ts\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "rec_crt_user_id",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.rec_crt_user_id\"), col(\"left.alt_run_target_dtl_load.rec_crt_user_id\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "last_exp_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"right.last_exp_dt\"), col(\"left.alt_run_target_dtl_load.last_exp_dt\"))"
              },
              "description" : ""
            }, {
              "_row_id" : null,
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(coalesce(col(\"right.newline\"), col(\"left.alt_run_target_dtl_load.newline\")), lit(\"\\n\"))"
              },
              "description" : ""
            } ],
            "hints" : [ {
              "id" : "in0",
              "alias" : "in0",
              "hintType" : "none",
              "propagateColumns" : false
            }, {
              "id" : "in1",
              "alias" : "in1",
              "hintType" : "none",
              "propagateColumns" : false
            } ],
            "activeTab" : "conditions",
            "columnsSelector" : [ ],
            "whereClause" : null,
            "headAlias" : "left"
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Join",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "RPL" : {
          "id" : "RPL",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "Association_Processing__RPL",
            "slug" : "RPL",
            "x" : 1620,
            "y" : 440,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "Association_Processing__RPL__in3",
              "slug" : "in3",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "Association_Processing__RPL__in2",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "alt_run_alt_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_run_target_dtl_id",
                  "type" : "decimal(16,0)",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "formulary_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_ndc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_multi_src_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_roa_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_dosage_form_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_reqd_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_specialty_ind",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_name_ext",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prod_short_desc_grp",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi14_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_gpi8_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_tier_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_formulary_status_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_pa_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_group_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_step_therapy_step_number",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_ts",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rec_crt_user_id",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "rebate_elig_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tad_eligible_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_qty_adj",
                  "type" : "decimal(6,3)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tala",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_rank",
                  "type" : "decimal(38,6)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "Association_Processing__RPL__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsScala"
          }
        }
      }
    },
    "LKP_TAR_Exp" : {
      "id" : "LKP_TAR_Exp",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_TAR_Exp",
        "slug" : "LKP_TAR_Exp",
        "x" : 20,
        "y" : 1020,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_TAR_Exp__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_TAR_Exp"
      }
    },
    "Expanded_UDL_wt_rl_priority_lookup" : {
      "id" : "Expanded_UDL_wt_rl_priority_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Expanded_UDL_wt_rl_priority_lookup",
        "slug" : "Expanded_UDL_wt_rl_priority_lookup",
        "x" : 220,
        "y" : 3020,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Expanded_UDL_wt_rl_priority_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "udl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "udl_nm" ],
        "valueColumns" : [ "udl_id", "udl_nm", "udl_desc", "products", "eff_dt", "term_dt", "contents", "newline" ],
        "processName" : "Expanded_UDL_wt_rl_priority"
      }
    },
    "LKP_TAC_Exp" : {
      "id" : "LKP_TAC_Exp",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_TAC_Exp",
        "slug" : "LKP_TAC_Exp",
        "x" : 20,
        "y" : 2220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_TAC_Exp__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_TAC_Exp"
      }
    },
    "Target_Load_Ready" : {
      "id" : "Target_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Target_Load_Ready",
        "slug" : "Target_Load_Ready",
        "x" : 480,
        "y" : 620,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Target_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tala",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tar_udl",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_multi_src_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prod_name_ext",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_step_therapy_step_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Target_Load_Ready"
      }
    },
    "Clinical_indn_Load_Ready" : {
      "id" : "Clinical_indn_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Clinical_indn_Load_Ready",
        "slug" : "Clinical_indn_Load_Ready",
        "x" : 480,
        "y" : 220,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Clinical_indn_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Clinical_indn_Load_Ready"
      }
    },
    "TAD_Xwalk_lookup" : {
      "id" : "TAD_Xwalk_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "TAD_Xwalk_lookup",
        "slug" : "TAD_Xwalk_lookup",
        "x" : 220,
        "y" : 1220,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "TAD_Xwalk_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "target_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_selection_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_selection_ids",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tad_alt_dtls",
              "type" : {
                "type" : "array",
                "elementType" : {
                  "type" : "struct",
                  "fields" : [ {
                    "name" : "rank",
                    "type" : "string",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  }, {
                    "name" : "qty_adjust_factor",
                    "type" : "decimal(6,3)",
                    "nullable" : true,
                    "metadata" : {
                      "description" : "",
                      "mappings" : [ ],
                      "tags" : [ ]
                    }
                  } ]
                },
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "target_gpi14" ],
        "valueColumns" : [ "target_gpi14", "alt_selection_cd", "alt_selection_ids", "tad_alt_dtls", "newline" ],
        "processName" : "TAD_Xwalk"
      }
    },
    "LKP_Step_Grp_NM" : {
      "id" : "LKP_Step_Grp_NM",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_Step_Grp_NM",
        "slug" : "LKP_Step_Grp_NM",
        "x" : 20,
        "y" : 1820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_Step_Grp_NM__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_Step_Grp_NM"
      }
    },
    "Alt_Load_Ready" : {
      "id" : "Alt_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Alt_Load_Ready",
        "slug" : "Alt_Load_Ready",
        "x" : 480,
        "y" : 820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Alt_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_alt_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_multi_src_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_roa_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_dosage_form_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi14",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_name_ext",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_short_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_prod_short_desc_grp",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi14_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_gpi8_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rebate_elig_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tad_eligible_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_qty_adj",
              "type" : "decimal(6,3)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tala",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_udl",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_rank",
              "type" : "decimal(38,6)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "constituent_reqd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Alt_Load_Ready"
      }
    },
    "Gpi_rank_ratio" : {
      "id" : "Gpi_rank_ratio",
      "component" : "Source",
      "metadata" : {
        "label" : "Gpi_rank_ratio",
        "slug" : "Gpi_rank_ratio",
        "x" : 20,
        "y" : 2820,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Gpi_rank_ratio__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Gpi_rank_ratio"
      }
    },
    "Alt_Proxy_Load_Ready" : {
      "id" : "Alt_Proxy_Load_Ready",
      "component" : "Target",
      "metadata" : {
        "label" : "Alt_Proxy_Load_Ready",
        "slug" : "Alt_Proxy_Load_Ready",
        "x" : 480,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Alt_Proxy_Load_Ready__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "alt_run_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_alt_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_run_target_dtl_id",
              "type" : "decimal(16,0)",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "target_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "alt_proxy_ndc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_ts",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rec_crt_user_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Alt_Proxy_Load_Ready"
      }
    },
    "LKP_Form_CAG_dataset_lookup" : {
      "id" : "LKP_Form_CAG_dataset_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_Form_CAG_dataset_lookup",
        "slug" : "LKP_Form_CAG_dataset_lookup",
        "x" : 220,
        "y" : 1620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_Form_CAG_dataset_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "formulary_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "carrier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "group",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "last_exp_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ndc11",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_reqd_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "specialty_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_ind",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_tier_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "formulary_status_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "pa_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_type_cd",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_group_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "step_therapy_step_number",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "ndc11" ],
        "valueColumns" : [ "formulary_name", "formulary_cd", "carrier", "account", "group", "last_exp_dt", "ndc11", "formulary_tier", "formulary_status", "pa_reqd_ind", "specialty_ind", "step_therapy_ind", "formulary_tier_desc", "formulary_status_desc", "pa_type_cd", "step_therapy_type_cd", "step_therapy_group_name", "step_therapy_step_number", "newline" ],
        "processName" : "LKP_Form_CAG_dataset"
      }
    },
    "LKP_ST_GRP_NUM_with_sequence" : {
      "id" : "LKP_ST_GRP_NUM_with_sequence",
      "component" : "Script",
      "metadata" : {
        "label" : "LKP_ST_GRP_NUM_with_sequence",
        "slug" : "LKP_ST_GRP_NUM_with_sequence",
        "x" : 220,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_ST_GRP_NUM_with_sequence__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "LKP_ST_GRP_NUM_with_sequence__out",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tac_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tac_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "priority",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_target_st_grp_num",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "_alt_st_grp_nums",
              "type" : {
                "type" : "array",
                "elementType" : "decimal(10,0)",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "__id",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n  lazy val out = in.zipWithIndex(0, 1, \"__id\", spark)\n\n",
        "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
        "scriptMethodFooter" : "out"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}