{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "7.1.83"
      }
    },
    "id" : "altexp_generate_cag_tal_container_xwalk",
    "uri" : "pipelines/altexp_partial_tal_cntr_assoc_xwalk",
    "language" : "scala",
    "fabricId" : "1593",
    "frontEndLanguage" : "scala",
    "mode" : "batch",
    "udfs" : {
      "language" : "scala",
      "udfs" : [ ],
      "functionPackageName" : "hariprophecyioteam.transpilermaltexpansion.functions",
      "sharedFunctionPackageNames" : [ "io.prophecy.scalagems.functions", "io.prophecy.warehousegems.functions" ],
      "initialCode" : "",
      "isAbInitioTranspilerImport" : true
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "TAL_ASSOC_NAME",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "TAL_DTL_Crosswalk",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "TAL_NAME",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAL_DTL",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAL_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "TAL_Container_Assoc",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "TAL_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Expand_TAL_Data_At_UDL_level",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "CAG_TAL_CONTAINER_FILE",
                  "kind" : {
                    "type" : "string",
                    "value" : ""
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        }, {
          "name" : "TAL_Assoc_Crosswalk",
          "kind" : {
            "type" : "record",
            "fields" : [ {
              "name" : "UDL_CAG_EXP_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAL_ASSOC_XWALK",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "UDL_BASELINE_EXP_FILE",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAL_ASSOC_NAME",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "CARRIER",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "TAL_ASSOC_DTL",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "CLIN_INDCN",
              "kind" : {
                "type" : "string",
                "value" : ""
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : false,
              "isReferenced" : false
            }, {
              "name" : "Expand_TAL_Assoc_Data_At_UDL_level",
              "kind" : {
                "type" : "record",
                "fields" : [ {
                  "name" : "TAL_ASSOC_XWALK",
                  "kind" : {
                    "type" : "string",
                    "value" : ""
                  },
                  "optional" : false,
                  "isWorkflowNodeConfiguration" : false,
                  "isReferenced" : false
                } ]
              },
              "optional" : false,
              "isWorkflowNodeConfiguration" : true,
              "isReferenced" : false
            } ]
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : true,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12651",
      "projectName" : "ProphecySparkBasicsScala",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12652",
      "projectName" : "ProphecyWarehouseScala",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "e36",
    "source" : "Expanded_UDL",
    "sourcePort" : "Expanded_UDL__out",
    "target" : "Expanded_UDL_lookup",
    "targetPort" : "Expanded_UDL_lookup__in"
  }, {
    "id" : "e37",
    "source" : "LKP_CLIN_INDCN",
    "sourcePort" : "LKP_CLIN_INDCN__out",
    "target" : "LKP_CLIN_INDCN_lookup",
    "targetPort" : "LKP_CLIN_INDCN_lookup__in"
  } ],
  "processes" : {
    "LKP_CLIN_INDCN" : {
      "id" : "LKP_CLIN_INDCN",
      "component" : "Source",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN",
        "slug" : "LKP_CLIN_INDCN",
        "x" : 20,
        "y" : 420,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "LKP_CLIN_INDCN__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/LKP_CLIN_INDCN"
      }
    },
    "Expanded_UDL_lookup" : {
      "id" : "Expanded_UDL_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "Expanded_UDL_lookup",
        "slug" : "Expanded_UDL_lookup",
        "x" : 220,
        "y" : 20,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Expanded_UDL_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "udl_id",
              "type" : "decimal(10,0)",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_nm",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "udl_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "products",
              "type" : "binary",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "eff_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "term_dt",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "contents",
              "type" : {
                "type" : "array",
                "elementType" : "binary",
                "containsNull" : true
              },
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "newline",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "udl_nm" ],
        "valueColumns" : [ "udl_id", "udl_nm", "udl_desc", "products", "eff_dt", "term_dt", "contents", "newline" ],
        "processName" : "Expanded_UDL"
      }
    },
    "TAL_DTL_Crosswalk" : {
      "id" : "TAL_DTL_Crosswalk",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "TAL_DTL_Crosswalk",
        "slug" : "TAL_DTL_Crosswalk",
        "x" : 20,
        "y" : 620,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "_root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(_root_.io.prophecy.abinitio.ScalaFunctions._is_blank(context.config.TAL_ASSOC_NAME))"
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "e31",
        "source" : "Select_TALs_w_o_Nested_TAL_Filter_select",
        "sourcePort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_Filter_select__out",
        "target" : "Select_TALs_w_o_Nested_TAL_RowDistributor",
        "targetPort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__in"
      }, {
        "id" : "e17",
        "source" : "TAL_Container_Dtls",
        "sourcePort" : "TAL_DTL_Crosswalk__TAL_Container_Dtls__out",
        "target" : "Select_TALs_w_o_Nested_TAL_Filter_select",
        "targetPort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_Filter_select__in"
      }, {
        "id" : "e30",
        "source" : "Select_TALs_w_o_Nested_TAL_RowDistributor",
        "sourcePort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out0",
        "target" : "Select_TALs_w_o_Nested_TALReformat_0",
        "targetPort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_0__in"
      }, {
        "id" : "e29",
        "source" : "Select_TALs_w_o_Nested_TALReformat_0",
        "sourcePort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_0__out",
        "target" : "Merge_UnionAll",
        "targetPort" : "TAL_DTL_Crosswalk__Merge_UnionAll__in3"
      }, {
        "id" : "e11",
        "source" : "Get_the_association_details_for_nested_TAL",
        "sourcePort" : "TAL_DTL_Crosswalk__Get_the_association_details_for_nested_TAL__out",
        "target" : "Merge_UnionAll",
        "targetPort" : "TAL_DTL_Crosswalk__Merge_UnionAll__in2"
      }, {
        "id" : "e28",
        "source" : "Select_TALs_w_o_Nested_TAL_RowDistributor",
        "sourcePort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out1",
        "target" : "Select_TALs_w_o_Nested_TALReformat_1",
        "targetPort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_1__in"
      }, {
        "id" : "e27",
        "source" : "Select_TALs_w_o_Nested_TALReformat_1",
        "sourcePort" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_1__out",
        "target" : "Get_the_association_details_for_nested_TAL",
        "targetPort" : "TAL_DTL_Crosswalk__Get_the_association_details_for_nested_TAL__in"
      }, {
        "id" : "e10",
        "source" : "Merge",
        "sourcePort" : "TAL_DTL_Crosswalk__Merge__out",
        "target" : "TAL_DTL_XWALK",
        "targetPort" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK__in"
      }, {
        "id" : "e2",
        "source" : "Merge_UnionAll",
        "sourcePort" : "TAL_DTL_Crosswalk__Merge_UnionAll__out",
        "target" : "Merge",
        "targetPort" : "TAL_DTL_Crosswalk__Merge__in"
      }, {
        "id" : "e9",
        "source" : "Merge",
        "sourcePort" : "TAL_DTL_Crosswalk__Merge__out",
        "target" : "TAL_DTL_XWALK_lookup",
        "targetPort" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK_lookup__in"
      } ],
      "processes" : {
        "Merge_UnionAll" : {
          "id" : "Merge_UnionAll",
          "component" : "SetOperation",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Merge_UnionAll",
            "slug" : "Merge_UnionAll",
            "x" : 1020,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Merge_UnionAll__in3",
              "slug" : "in3",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            }, {
              "id" : "TAL_DTL_Crosswalk__Merge_UnionAll__in2",
              "slug" : "in2",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Merge_UnionAll__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "operationType" : "unionAll",
            "allowMissingColumns" : false
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Select_TALs_w_o_Nested_TAL_Filter_select" : {
          "id" : "Select_TALs_w_o_Nested_TAL_Filter_select",
          "component" : "Filter",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_Filter_select",
            "slug" : "Select_TALs_w_o_Nested_TAL_Filter_select",
            "x" : 220,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_Filter_select__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_Filter_select__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "condition" : {
              "format" : "scala",
              "expression" : "array_contains(split(lit(Config.TAL_NAME), \",\"), col(\"tal_name\"))"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Select_TALs_w_o_Nested_TAL_RowDistributor" : {
          "id" : "Select_TALs_w_o_Nested_TAL_RowDistributor",
          "component" : "RowDistributor",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor",
            "slug" : "Select_TALs_w_o_Nested_TAL_RowDistributor",
            "x" : 420,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out0",
              "slug" : "out0"
            }, {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out1",
              "slug" : "out1"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "outports" : [ {
              "path" : "out0",
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out0",
              "model" : {
                "format" : "scala",
                "expression" : "is_not_null(col(\"tal_assoc_name\"))"
              }
            }, {
              "path" : "out1",
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TAL_RowDistributor__out1",
              "model" : {
                "format" : "scala",
                "expression" : "!is_not_null(col(\"tal_assoc_name\"))"
              }
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/RowDistributor",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "TAL_DTL_XWALK_lookup" : {
          "id" : "TAL_DTL_XWALK_lookup",
          "component" : "Lookup",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK_lookup",
            "slug" : "TAL_DTL_XWALK_lookup",
            "x" : 1420,
            "y" : 20,
            "phase" : -3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK_lookup__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "isRange" : false,
            "keyColumns" : [ "tal_assoc_name" ],
            "valueColumns" : [ "tal_dtl_id", "tal_id", "tal_name", "tal_desc", "tal_dtl_type_cd", "nested_tal_name", "tal_assoc_name", "priority", "eff_dt", "term_dt", "newline" ],
            "processName" : "TAL_DTL_XWALK"
          }
        },
        "Select_TALs_w_o_Nested_TALReformat_0" : {
          "id" : "Select_TALs_w_o_Nested_TALReformat_0",
          "component" : "Reformat",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_0",
            "slug" : "Select_TALs_w_o_Nested_TALReformat_0",
            "x" : 820,
            "y" : 20,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_0__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_0__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_dtl_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_dtl_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_dtl_type_cd\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "nested_tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"nested_tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "priority",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"priority\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "eff_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"eff_dt\")"
              },
              "description" : ""
            }, {
              "target" : "term_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"term_dt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Get_the_association_details_for_nested_TAL" : {
          "id" : "Get_the_association_details_for_nested_TAL",
          "component" : "Script",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Get_the_association_details_for_nested_TAL",
            "slug" : "Get_the_association_details_for_nested_TAL",
            "x" : 820,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Get_the_association_details_for_nested_TAL__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Get_the_association_details_for_nested_TAL__out",
              "slug" : "out",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\nimport scala.collection.mutable.ArrayBuffer\n\nval process_udf = udf({ (row: Row) =>\n  val results = ArrayBuffer[Row]()\n  var _l1_factor = BigDecimal(5)\n  var _l1_denominator = BigDecimal(100)\n  var _l1_assocition_cnt = BigDecimal(2000)\n  var _l2_factor = BigDecimal(1000)\n  var tal_dtl_final = Array[Row]()\n  var i = 0\n  var j = 0\n  var nested_tal_l1_dtl = row.getAs[Seq[Row]](11).toArray\n  while (compareTo(i, nested_tal_l1_dtl.length) < 0) {\n    if (!_isnull(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_assoc_name\"))) {\n          val nested_tal_l1_dtl_i = Row(\n            nested_tal_l1_dtl(convertToInt(i)).getAs[java.math.BigDecimal](\"tal_dtl_id\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[java.math.BigDecimal](\"tal_id\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_name\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_desc\"),\n            (nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_dtl_type_cd\")),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"nested_tal_name\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_assoc_name\"),\n            (BigDecimal(row.getAs[String](\"priority\")) + (BigDecimal(\n              nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"priority\")\n            ) / (_l1_denominator * (_l1_factor / _l1_assocition_cnt)))).toString,\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"eff_dt\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"term_dt\"),\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"newline\")\n          )\n          tal_dtl_final = Array.concat(tal_dtl_final, Array.fill(1)(nested_tal_l1_dtl_i))\n    } else {\n      j = 0\n      val nested_tal_l1_dtl_arr = nested_tal_l1_dtl(i).getAs[Seq[Row]](0).toArray\n      while (\n        compareTo(j,\n              nested_tal_l1_dtl_arr.length    \n        ) < 0\n      ) {\n        var nested_tal_l2_dtl = nested_tal_l1_dtl_arr(convertToInt(j))\n        nested_tal_l2_dtl = updateIndexInRow(\n          nested_tal_l2_dtl,\n          7,\n          ((BigDecimal(row.getAs[String](\"priority\")) + (BigDecimal(\n            nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"priority\")\n          ) / (_l1_denominator * (_l1_factor / _l1_assocition_cnt)))) + (BigDecimal(\n            nested_tal_l2_dtl.getAs[String](\"priority\")\n          ) / (_l2_factor * _l2_factor))).toString\n        )\n        tal_dtl_final = Array.concat(tal_dtl_final, Array.fill(1)(nested_tal_l2_dtl))\n        j = j + 1\n      }\n    }\n    i = i + 1\n  }\n\n  tal_dtl_final.zipWithIndex.foreach {\n    case (r, idx) \n      results.append(\n        Row(\n        row.getAs[java.math.BigDecimal](0),\n        row.getAs[java.math.BigDecimal](1),\n        row.getAs[String](2),\n        row.getAs[String](3),\n        row.getAs[String](4),\n        tal_dtl_final(idx).getAs[String](2),\n        if (tal_dtl_final(idx).getAs[String](6) != null)  tal_dtl_final(idx).getAs[String](6) else row.getAs[String](6),\n        if (tal_dtl_final(idx).getAs[String](7) != null)  tal_dtl_final(idx).getAs[String](7) else row.getAs[String](7),\n        row.getAs[String](8),\n        row.getAs[String](9),\n        row.getAs[String](10),\n      ))\n  }\n  results.toArray\n}, ArrayType(StructType(\n    List(\n      StructField(\"tal_dtl_id\",      DecimalType(10, 0),  false),\n      StructField(\"tal_id\",          DecimalType(10, 0),  false),\n      StructField(\"tal_name\",        StringType,         false),\n      StructField(\"tal_desc\",        StringType,         false),\n      StructField(\"tal_dtl_type_cd\", StringType,         false),\n      StructField(\"nested_tal_name\", StringType,         true),\n      StructField(\"tal_assoc_name\",  StringType,         true),\n      StructField(\"priority\",        StringType,         false),\n      StructField(\"eff_dt\",          StringType,         false),\n      StructField(\"term_dt\",         StringType,         false),\n      StructField(\"newline\",         StringType,         true)\n    )\n)))\n\ndef nested_tal_l1_dtl() = {\n  lookup_row(\"TAL_Container_Dtls\", col(\"nested_tal_name\"))\n}\n\ndef nested_tal_l2_dtl() = {\n    transform(\n      nested_tal_l1_dtl(),\n      xx =>\n        lookup_row(\"TAL_Container_Dtls\", xx.getField(\"nested_tal_name\"))\n    )\n}\n\nval df = in\n  .withColumn(\n    \"nested_tal_l1_dtl\",\n    nested_tal_l1_dtl(),\n  ).withColumn(\n    \"nested_tal_l2_dtl\",\n    nested_tal_l2_dtl()\n  )\n  \nval origColumns = df.columns.map(col)\nval out = df\n  .select(struct(origColumns: _*).as(\"inputRows\"))\n  .select(explode(process_udf(col(\"inputRows\"))).alias(\"output\"))\n  .select(col(\"output.*\"))",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out\n}"
          }
        },
        "TAL_Container_Dtls" : {
          "id" : "TAL_Container_Dtls",
          "component" : "Source",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__TAL_Container_Dtls",
            "slug" : "TAL_Container_Dtls",
            "x" : 20,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__TAL_Container_Dtls__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/TAL_DTL_Crosswalk__TAL_Container_Dtls"
          }
        },
        "Select_TALs_w_o_Nested_TALReformat_1" : {
          "id" : "Select_TALs_w_o_Nested_TALReformat_1",
          "component" : "Reformat",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_1",
            "slug" : "Select_TALs_w_o_Nested_TALReformat_1",
            "x" : 620,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_1__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Select_TALs_w_o_Nested_TALReformat_1__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_dtl_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_dtl_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_dtl_type_cd\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "nested_tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"nested_tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "priority",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"priority\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "eff_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"eff_dt\")"
              },
              "description" : ""
            }, {
              "target" : "term_dt",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"term_dt\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "TAL_DTL_XWALK" : {
          "id" : "TAL_DTL_XWALK",
          "component" : "Target",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK",
            "slug" : "TAL_DTL_XWALK",
            "x" : 1420,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__TAL_DTL_XWALK__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/TAL_DTL_Crosswalk__TAL_DTL_XWALK"
          }
        },
        "Merge" : {
          "id" : "Merge",
          "component" : "OrderBy",
          "metadata" : {
            "label" : "TAL_DTL_Crosswalk__Merge",
            "slug" : "Merge",
            "x" : 1220,
            "y" : 120,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Merge__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_DTL_Crosswalk__Merge__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "orders" : [ {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\")"
              },
              "sortType" : "asc"
            }, {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"priority\")"
              },
              "sortType" : "asc"
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
            "projectName" : "ProphecySparkBasicsScala"
          }
        }
      }
    },
    "Expanded_UDL" : {
      "id" : "Expanded_UDL",
      "component" : "Source",
      "metadata" : {
        "label" : "Expanded_UDL",
        "slug" : "Expanded_UDL",
        "x" : 20,
        "y" : 20,
        "phase" : 3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "Expanded_UDL__out",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Expanded_UDL"
      }
    },
    "TAL_Container_Assoc" : {
      "id" : "TAL_Container_Assoc",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "TAL_Container_Assoc",
        "slug" : "TAL_Container_Assoc",
        "x" : 20,
        "y" : 820,
        "phase" : -5,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "removalCondition" : "_root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(_root_.io.prophecy.abinitio.ScalaFunctions._is_blank(context.config.TAL_ASSOC_NAME))"
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "e33",
        "source" : "Combine_Association_details_Filter_select",
        "sourcePort" : "TAL_Container_Assoc__Combine_Association_details_Filter_select__out",
        "target" : "Combine_Association_details_Reformat",
        "targetPort" : "TAL_Container_Assoc__Combine_Association_details_Reformat__in"
      }, {
        "id" : "e18",
        "source" : "IFILE_TAL_DTL_XWALK",
        "sourcePort" : "TAL_Container_Assoc__IFILE_TAL_DTL_XWALK__out",
        "target" : "Combine_Association_details_Filter_select",
        "targetPort" : "TAL_Container_Assoc__Combine_Association_details_Filter_select__in"
      }, {
        "id" : "e32",
        "source" : "Combine_Association_details_Reformat",
        "sourcePort" : "TAL_Container_Assoc__Combine_Association_details_Reformat__out",
        "target" : "Sort",
        "targetPort" : "TAL_Container_Assoc__Sort__in"
      }, {
        "id" : "e14",
        "source" : "Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter",
        "sourcePort" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter__out",
        "target" : "TAL_Name",
        "targetPort" : "TAL_Container_Assoc__TAL_Name__in"
      }, {
        "id" : "e41",
        "source" : "TAL_Name",
        "sourcePort" : "TAL_Container_Assoc__TAL_Name__out",
        "target" : "Expand_TAL_Data_At_UDL_level",
        "targetPort" : "altexp_generate_cag_tal_container_xwalk__TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__in"
      }, {
        "id" : "WwNyu956n__d2bAsfV0dq",
        "source" : "Sort",
        "sourcePort" : "TAL_Container_Assoc__Sort__out",
        "target" : "ZxVSdT6UqCJXlHwwe5Jo7$$RMQ_Anzv9aZzPj-2MLnmC",
        "targetPort" : "7AfZTuccxDwKKOfc-dTCY$$5PWfqK9Tc4EG7X2iFL4aY"
      }, {
        "id" : "r3_xrxPHWwvWmBFfFjted$$aP1r9LQAF7MVbbsSrZMEd",
        "source" : "ZxVSdT6UqCJXlHwwe5Jo7$$RMQ_Anzv9aZzPj-2MLnmC",
        "sourcePort" : "VwDAVw1dwWn_kbvKW86fr$$ot4Ow7pOXqJmwefXMiTXI",
        "target" : "Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter",
        "targetPort" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter__in"
      } ],
      "processes" : {
        "Combine_Association_details_Reformat" : {
          "id" : "Combine_Association_details_Reformat",
          "component" : "Reformat",
          "metadata" : {
            "label" : "TAL_Container_Assoc__Combine_Association_details_Reformat",
            "slug" : "Combine_Association_details_Reformat",
            "x" : 420,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Container_Assoc__Combine_Association_details_Reformat__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__Combine_Association_details_Reformat__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "clinical_indn_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"clinical_indn_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"tal_assoc_desc\")"
              },
              "description" : ""
            }, {
              "target" : "priority",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"priority\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"tal_assoc_type_cd\")"
              },
              "description" : ""
            }, {
              "target" : "target_prdcts",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"target_udl_info\")"
              },
              "description" : ""
            }, {
              "target" : "alt_prdcts",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"alt_udl_info\")"
              },
              "description" : ""
            }, {
              "target" : "shared_qual",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"shared_qual\")"
              },
              "description" : ""
            }, {
              "target" : "override_tac_name",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"override_tac_name\")"
              },
              "description" : ""
            }, {
              "target" : "override_tar_name",
              "expression" : {
                "format" : "scala",
                "expression" : "lookup(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).getField(\"override_tar_name\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "ZxVSdT6UqCJXlHwwe5Jo7$$RMQ_Anzv9aZzPj-2MLnmC" : {
          "id" : "ZxVSdT6UqCJXlHwwe5Jo7$$RMQ_Anzv9aZzPj-2MLnmC",
          "component" : "Script",
          "metadata" : {
            "label" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association",
            "slug" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association",
            "x" : 820,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "7AfZTuccxDwKKOfc-dTCY$$5PWfqK9Tc4EG7X2iFL4aY",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "VwDAVw1dwWn_kbvKW86fr$$ot4Ow7pOXqJmwefXMiTXI",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\n\nval process_udf = udf(\n{ (input: Seq[Row]) \n    val outputRows = scala.collection.mutable.ArrayBuffer[Row]()\n\n    var excl_target_prdcts = Array[Byte]()\n    var excl_alt_prdcts    = Array[Byte]()\n    var target_prdcts      = Array[Row]()\n    var alt_prdcts         = Array[Row]()\n\n    input.foreach { in \n    var lv_target_prdcts = Array[Byte]()\n    var lv_alt_prdcts    = Array[Byte]()\n    if (in.getAs[String](\"tal_assoc_type_cd\").toInt == 3) {\n        excl_target_prdcts =\n        _bv_or(excl_target_prdcts, _bv_vector_or(in.getSeq[Row](8).toArray.map(r  r.getAs[Array[Byte]](2))))\n        excl_alt_prdcts =\n        _bv_or(excl_alt_prdcts, _bv_vector_or(in.getSeq[Row](9).toArray.map(r  r.getAs[Array[Byte]](2))))\n    } else {\n        in.getSeq[Row](8).toArray.foreach { target_prds \n            lv_target_prdcts = _bv_difference(target_prds.getAs[Array[Byte]](2), excl_target_prdcts)\n            if (_bv_count_one_bits(lv_target_prdcts) > 0) {\n                target_prdcts = Array\n                .concat(\n                    target_prdcts,\n                    Array.fill(1)(\n                    Row(target_prds.getAs[String](0), target_prds.getAs[String](1), lv_target_prdcts)\n                    )\n                )\n            }\n        }\n\n        in.getSeq[Row](9).toArray.foreach { alt_prds \n            lv_alt_prdcts = _bv_difference(alt_prds.getAs[Array[Byte]](2), excl_alt_prdcts)\n            if (_bv_count_one_bits(lv_target_prdcts) > 0) {\n                alt_prdcts = Array\n                .concat(\n                    alt_prdcts,\n                    Array.fill(1)(\n                    Row(alt_prds.getAs[String](0),\n                        alt_prds.getAs[String](1),\n                        lv_alt_prdcts,\n                        alt_prds.getAs[String](3),\n                        alt_prds.getAs[String](4),\n                        alt_prds.getAs[String](5)\n                    )\n                    )\n                )\n            }\n        }\n    }\n    outputRows.append(\n        Row(\n        in.getAs[java.math.BigDecimal](0),\n        in.getAs[String](1),\n        in.getAs[String](2),\n        in.getAs[String](3),\n        in.getAs[String](4),\n        in.getAs[String](5),\n        in.getAs[String](6),\n        in.getAs[String](7),\n        target_prdcts,\n        alt_prdcts,\n        in.getAs[String](10),\n        in.getAs[String](11),\n        in.getAs[String](12),\n        in.getAs[String](13)\n        )\n    )\n    }\n    outputRows.toArray\n},\nArrayType(\n    StructType(\n    List(\n        StructField(\"tal_id\",             StringType, true),\n        StructField(\"tal_name\",           StringType, true),\n        StructField(\"tal_assoc_name\",     StringType, true),\n        StructField(\"clinical_indn_desc\", StringType, true),\n        StructField(\"tal_desc\",           StringType, true),\n        StructField(\"tal_assoc_desc\",     StringType, true),\n        StructField(\"priority\",           StringType, true),\n        StructField(\"tal_assoc_type_cd\",  StringType, true),\n        StructField(\n        \"target_prdcts\",\n        ArrayType(StructType(\n                    List(StructField(\"udl_nm\",   StringType, true),\n                            StructField(\"udl_desc\", StringType, true),\n                            StructField(\"products\", BinaryType, true)\n                    )\n                    ),\n                    true\n        ),\n        true\n        ),\n        StructField(\n        \"alt_prdcts\",\n        ArrayType(\n            StructType(\n            List(\n                StructField(\"udl_nm\",            StringType, true),\n                StructField(\"udl_desc\",          StringType, true),\n                StructField(\"products\",          BinaryType, true),\n                StructField(\"constituent_group\", StringType, true),\n                StructField(\"constituent_reqd\",  StringType, true),\n                StructField(\"constituent_rank\",  StringType, true)\n            )\n            ),\n            true\n        ),\n        true\n        ),\n        StructField(\"shared_qual\",       StringType, true),\n        StructField(\"override_tac_name\", StringType, true),\n        StructField(\"override_tar_name\", StringType, true),\n        StructField(\"newline\",           StringType, true)\n    )\n    )\n)\n)\n\nval origColumns = in0.columns.map(col)\nval out0 = in0\n.groupBy(\"tal_id\")\n.agg(\n    collect_list(\n    struct(\n        origColumns: _*\n    )\n    ).alias(\"inputRows\")\n)\n.select(explode(process_udf(col(\"inputRows\"))).alias(\"output\"))\n.select(col(\"output.*\"))\n",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out0\n}"
          }
        },
        "TAL_Name" : {
          "id" : "TAL_Name",
          "component" : "OrderBy",
          "metadata" : {
            "label" : "TAL_Container_Assoc__TAL_Name",
            "slug" : "TAL_Name",
            "x" : 1220,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Container_Assoc__TAL_Name__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__TAL_Name__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "orders" : [ {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_name\")"
              },
              "sortType" : "asc"
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Combine_Association_details_Filter_select" : {
          "id" : "Combine_Association_details_Filter_select",
          "component" : "Filter",
          "metadata" : {
            "label" : "TAL_Container_Assoc__Combine_Association_details_Filter_select",
            "slug" : "Combine_Association_details_Filter_select",
            "x" : 220,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Container_Assoc__Combine_Association_details_Filter_select__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_dtl_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "nested_tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "eff_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "term_dt",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__Combine_Association_details_Filter_select__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "TAL_Container_Assoc__Combine_Association_details_Filter_select__in##tal_assoc_name" ],
            "condition" : {
              "format" : "scala",
              "expression" : "lookup_match(\"TAL_ASSOC_XWALK\", col(\"tal_assoc_name\")).cast(BooleanType)"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "IFILE_TAL_DTL_XWALK" : {
          "id" : "IFILE_TAL_DTL_XWALK",
          "component" : "Source",
          "metadata" : {
            "label" : "TAL_Container_Assoc__IFILE_TAL_DTL_XWALK",
            "slug" : "IFILE_TAL_DTL_XWALK",
            "x" : 20,
            "y" : 20,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__IFILE_TAL_DTL_XWALK__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/TAL_Container_Assoc__IFILE_TAL_DTL_XWALK"
          }
        },
        "Sort" : {
          "id" : "Sort",
          "component" : "OrderBy",
          "metadata" : {
            "label" : "TAL_Container_Assoc__Sort",
            "slug" : "Sort",
            "x" : 620,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Container_Assoc__Sort__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__Sort__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "orders" : [ {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_id\")"
              },
              "sortType" : "asc"
            }, {
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_type_cd\")"
              },
              "sortType" : "desc"
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter" : {
          "id" : "Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter",
          "component" : "Filter",
          "metadata" : {
            "label" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter",
            "slug" : "Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter",
            "x" : 1020,
            "y" : 20,
            "phase" : 5,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Container_Assoc__Scan_Remove_Exclusion_Products_from_Inclusion_and_Standard_Association_output_select_filter__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "condition" : {
              "format" : "scala",
              "expression" : "when(col(\"tal_assoc_type_cd\").cast(StringType) === lit(3), lit(0))\n    .when(\n      !size(col(\"target_prdcts\")).cast(BooleanType),\n      force_error(\n        concat(\n          lit(\"TAL Assocation : \"),\n          col(\"tal_assoc_name\"),\n          lit(\" with type code \"),\n          col(\"tal_assoc_type_cd\").cast(StringType),\n          lit(\" do not have Target Products after applying Exlcusion Association\")\n        ).cast(StringType)\n      )\n    )\n    .otherwise(lit(1))\n    .cast(BooleanType)"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Expand_TAL_Data_At_UDL_level" : {
          "id" : "Expand_TAL_Data_At_UDL_level",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "Expand_TAL_Data_At_UDL_level",
            "slug" : "Expand_TAL_Data_At_UDL_level",
            "x" : 1420,
            "y" : 20,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "altexp_generate_cag_tal_container_xwalk__TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "priority",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_prdcts",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "e0",
            "source" : "s_UnionAll",
            "sourcePort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__out",
            "target" : "s",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s__in"
          }, {
            "id" : "e19",
            "source" : "s",
            "sourcePort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s__out",
            "target" : "OFILE_Normaize_TAL_data_UDL_level",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__OFILE_Normaize_TAL_data_UDL_level__in"
          }, {
            "id" : "e21",
            "source" : "Expand_Alternate_UDL_1",
            "sourcePort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_Alternate_UDL__out",
            "target" : "s_UnionAll",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__in3"
          }, {
            "id" : "e20",
            "source" : "Expand_target_UDL_1",
            "sourcePort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_target_UDL__out",
            "target" : "s_UnionAll",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__in2"
          }, {
            "id" : "e42",
            "source" : "Expand_TAL_Data_At_UDL_level",
            "sourcePort" : "altexp_generate_cag_tal_container_xwalk__TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__in",
            "target" : "Expand_target_UDL_1",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_target_UDL__in"
          }, {
            "id" : "e43",
            "source" : "Expand_TAL_Data_At_UDL_level",
            "sourcePort" : "altexp_generate_cag_tal_container_xwalk__TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__in",
            "target" : "Expand_Alternate_UDL_1",
            "targetPort" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_Alternate_UDL__in"
          } ],
          "processes" : {
            "s" : {
              "id" : "s",
              "component" : "OrderBy",
              "metadata" : {
                "label" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s",
                "slug" : "s",
                "x" : 420,
                "y" : 120,
                "phase" : 5,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "orders" : [ {
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_id\")"
                  },
                  "sortType" : "asc"
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Expand_Alternate_UDL_1" : {
              "id" : "Expand_Alternate_UDL_1",
              "component" : "Script",
              "metadata" : {
                "label" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_Alternate_UDL",
                "slug" : "Expand_Alternate_UDL_1",
                "x" : 20,
                "y" : 20,
                "phase" : 5,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_Alternate_UDL__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "priority",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prdcts",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prdcts",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_Alternate_UDL__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_prdcts\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"udl_nm\")).as(\"udl_id\"),\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"udl_desc\")).as(\"udl_desc\"),\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"products\")).as(\"products\"),\n      (col(\"index\") + lit(1)).as(\"alt_rank\"),\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"constituent_group\")).as(\"constituent_group\"),\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"constituent_reqd\")).as(\"constituent_reqd\"),\n      (element_at(col(\"alt_prdcts\"), col(\"index\") + lit(1)).getField(\"constituent_rank\")).as(\"constituent_rank\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"tal_name\")).as(\"tal_id\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_id\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\"),\n    (col(\"tal_desc\")).as(\"tal_desc\"),\n    (col(\"tal_assoc_desc\")).as(\"tal_assoc_desc\"),\n    (col(\"tal_assoc_type_cd\").cast(StringType)).as(\"tal_assoc_type_cd\"),\n    (col(\"priority\").cast(StringType)).as(\"tal_assoc_rank\"),\n    (col(\"udl_id\")).as(\"udl_id\"),\n    (col(\"udl_desc\")).as(\"udl_desc\"),\n    (lit(\"ALTERNATIVE\")).as(\"Target_Alternative\"),\n    (col(\"products\")).as(\"products\"),\n    (col(\"alt_rank\")).as(\"alt_rank\"),\n    (col(\"shared_qual\")).as(\"shared_qual\"),\n    (col(\"override_tac_name\")).as(\"override_tac_name\"),\n    (col(\"override_tar_name\")).as(\"override_tar_name\"),\n    (col(\"constituent_group\")).as(\"constituent_group\"),\n    (col(\"constituent_reqd\")).as(\"constituent_reqd\"),\n    (col(\"constituent_rank\")).as(\"constituent_rank\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
                "scriptMethodFooter" : "out"
              }
            },
            "Expand_target_UDL_1" : {
              "id" : "Expand_target_UDL_1",
              "component" : "Script",
              "metadata" : {
                "label" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_target_UDL",
                "slug" : "Expand_target_UDL_1",
                "x" : 20,
                "y" : 220,
                "phase" : 5,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_target_UDL__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "priority",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_prdcts",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_prdcts",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__Expand_target_UDL__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"target_prdcts\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"target_prdcts\"), col(\"index\") + lit(1)).getField(\"udl_nm\")).as(\"udl_id\"),\n      (element_at(col(\"target_prdcts\"), col(\"index\") + lit(1)).getField(\"udl_desc\")).as(\"udl_desc\"),\n      (element_at(col(\"target_prdcts\"), col(\"index\") + lit(1)).getField(\"products\")).as(\"products\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"tal_name\")).as(\"tal_id\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_id\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\"),\n    (col(\"tal_desc\")).as(\"tal_desc\"),\n    (col(\"tal_assoc_desc\")).as(\"tal_assoc_desc\"),\n    (col(\"tal_assoc_type_cd\").cast(StringType)).as(\"tal_assoc_type_cd\"),\n    (col(\"priority\").cast(StringType)).as(\"tal_assoc_rank\"),\n    (col(\"udl_id\")).as(\"udl_id\"),\n    (col(\"udl_desc\")).as(\"udl_desc\"),\n    (lit(\"TARGET\")).as(\"Target_Alternative\"),\n    (col(\"products\")).as(\"products\"),\n    (lit(null)).as(\"alt_rank\"),\n    (col(\"shared_qual\")).as(\"shared_qual\"),\n    (col(\"override_tac_name\")).as(\"override_tac_name\"),\n    (col(\"override_tar_name\")).as(\"override_tar_name\"),\n    (lit(null).cast(StringType)).as(\"constituent_group\"),\n    (lit(null).cast(StringType)).as(\"constituent_reqd\"),\n    (lit(null)).as(\"constituent_rank\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
                "scriptMethodFooter" : "out"
              }
            },
            "OFILE_Normaize_TAL_data_UDL_level" : {
              "id" : "OFILE_Normaize_TAL_data_UDL_level",
              "component" : "Target",
              "metadata" : {
                "label" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__OFILE_Normaize_TAL_data_UDL_level",
                "slug" : "OFILE_Normaize_TAL_data_UDL_level",
                "x" : 620,
                "y" : 120,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__OFILE_Normaize_TAL_data_UDL_level__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__OFILE_Normaize_TAL_data_UDL_level"
              }
            },
            "s_UnionAll" : {
              "id" : "s_UnionAll",
              "component" : "SetOperation",
              "metadata" : {
                "label" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll",
                "slug" : "s_UnionAll",
                "x" : 220,
                "y" : 120,
                "phase" : 5,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__in3",
                  "slug" : "in3",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__in2",
                  "slug" : "in2",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Container_Assoc__Expand_TAL_Data_At_UDL_level__s_UnionAll__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "operationType" : "unionAll",
                "allowMissingColumns" : false
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
                "projectName" : "ProphecySparkBasicsScala"
              }
            }
          }
        }
      }
    },
    "LKP_CLIN_INDCN_lookup" : {
      "id" : "LKP_CLIN_INDCN_lookup",
      "component" : "Lookup",
      "metadata" : {
        "label" : "LKP_CLIN_INDCN_lookup",
        "slug" : "LKP_CLIN_INDCN_lookup",
        "x" : 220,
        "y" : 420,
        "phase" : -3,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "LKP_CLIN_INDCN_lookup__in",
          "slug" : "in",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "tal_assoc_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tal_assoc_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_id",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_name",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "clinical_indn_desc",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "rank",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "isRange" : false,
        "keyColumns" : [ "tal_assoc_name" ],
        "valueColumns" : [ "tal_assoc_id", "tal_assoc_name", "clinical_indn_id", "clinical_indn_name", "clinical_indn_desc", "rank" ],
        "processName" : "LKP_CLIN_INDCN"
      }
    },
    "TAL_Assoc_Crosswalk" : {
      "id" : "TAL_Assoc_Crosswalk",
      "component" : "Subgraph",
      "metadata" : {
        "label" : "TAL_Assoc_Crosswalk",
        "slug" : "TAL_Assoc_Crosswalk",
        "x" : 20,
        "y" : 220,
        "phase" : -4,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : { },
      "connections" : [ {
        "id" : "e15",
        "source" : "TAL_Assoc_Dtl",
        "sourcePort" : "TAL_Assoc_Crosswalk__TAL_Assoc_Dtl__out",
        "target" : "Process_TAL_Association_Rows_input_select_filter",
        "targetPort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_input_select_filter__in"
      }, {
        "id" : "e8",
        "source" : "Process_TAL_Association_Rows_Reformat",
        "sourcePort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_Reformat__out",
        "target" : "Process_TAL_Association_Rows_output_select_filter",
        "targetPort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__in"
      }, {
        "id" : "e4",
        "source" : "Process_TAL_Association_Rows_output_select_filter",
        "sourcePort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__out",
        "target" : "TAL_ASSOC_XWALK",
        "targetPort" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK__in"
      }, {
        "id" : "e3",
        "source" : "Process_TAL_Association_Rows_output_select_filter",
        "sourcePort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__out",
        "target" : "TAL_ASSOC_XWALK_lookup",
        "targetPort" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK_lookup__in"
      }, {
        "id" : "e38",
        "source" : "Process_TAL_Association_Rows_output_select_filter",
        "sourcePort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__out",
        "target" : "Expand_TAL_Assoc_Data_At_UDL_level",
        "targetPort" : "altexp_generate_cag_tal_container_xwalk__TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__in"
      }, {
        "id" : "oMTIffh2QA2P4ujLRiuH2",
        "source" : "Process_TAL_Association_Rows_input_select_filter",
        "sourcePort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_input_select_filter__out",
        "target" : "tIeHH3ZzKfVwf8Q4a-yad$$PAgPIPtFRDrDeBmbizM6R",
        "targetPort" : "NhZtf0VoTL2lHtiuPhFo4$$ECohY-qUkagj3JJytReIi"
      }, {
        "id" : "OvswBl02L78EjdKDYBeKH$$rSZZpqfw4YFXtfV6dRvUM",
        "source" : "tIeHH3ZzKfVwf8Q4a-yad$$PAgPIPtFRDrDeBmbizM6R",
        "sourcePort" : "6Jcvo3egGxee_d29A9tUa$$Nn3PR1_wKvWtCmDC4Op68",
        "target" : "Process_TAL_Association_Rows_Reformat",
        "targetPort" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_Reformat__in"
      } ],
      "processes" : {
        "TAL_Assoc_Dtl" : {
          "id" : "TAL_Assoc_Dtl",
          "component" : "Source",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__TAL_Assoc_Dtl",
            "slug" : "TAL_Assoc_Dtl",
            "x" : 20,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__TAL_Assoc_Dtl__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/TAL_Assoc_Crosswalk__TAL_Assoc_Dtl"
          }
        },
        "TAL_ASSOC_XWALK_lookup" : {
          "id" : "TAL_ASSOC_XWALK_lookup",
          "component" : "Lookup",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK_lookup",
            "slug" : "TAL_ASSOC_XWALK_lookup",
            "x" : 1020,
            "y" : 20,
            "phase" : -3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "removalCondition" : "_root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(_root_.io.prophecy.abinitio.ScalaFunctions._is_blank(context.config.TAL_ASSOC_NAME))"
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK_lookup__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "isRange" : false,
            "keyColumns" : [ "tal_assoc_name" ],
            "valueColumns" : [ "tal_assoc_dtl_id", "tal_assoc_id", "tal_assoc_name", "clinical_indn_desc", "tal_assoc_desc", "tal_assoc_type_cd", "target_udl_info", "alt_udl_info", "shared_qual", "override_tac_name", "override_tar_name", "newline" ],
            "processName" : "TAL_ASSOC_XWALK"
          }
        },
        "Process_TAL_Association_Rows_input_select_filter" : {
          "id" : "Process_TAL_Association_Rows_input_select_filter",
          "component" : "Filter",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_input_select_filter",
            "slug" : "Process_TAL_Association_Rows_input_select_filter",
            "x" : 220,
            "y" : 220,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_input_select_filter__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_input_select_filter__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "condition" : {
              "format" : "scala",
              "expression" : "when(is_not_blank(lit(Config.TAL_ASSOC_NAME)),\n       array_contains(split(lit(Config.TAL_ASSOC_NAME), \",\"), col(\"tal_assoc_name\"))\n  ).otherwise(lookup_match(\"TAL_DTL_XWALK\", col(\"tal_assoc_name\"))).cast(BooleanType)"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "TAL_ASSOC_XWALK" : {
          "id" : "TAL_ASSOC_XWALK",
          "component" : "Target",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK",
            "slug" : "TAL_ASSOC_XWALK",
            "x" : 1020,
            "y" : 220,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "datasetId" : "datasets/TAL_Assoc_Crosswalk__TAL_ASSOC_XWALK"
          }
        },
        "Expand_TAL_Assoc_Data_At_UDL_level" : {
          "id" : "Expand_TAL_Assoc_Data_At_UDL_level",
          "component" : "Subgraph",
          "metadata" : {
            "label" : "Expand_TAL_Assoc_Data_At_UDL_level",
            "slug" : "Expand_TAL_Assoc_Data_At_UDL_level",
            "x" : 1020,
            "y" : 420,
            "phase" : 3,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false,
            "removalCondition" : "_root_.io.prophecy.abinitio.ScalaFunctions._not(_root_.io.prophecy.abinitio.ScalaFunctions.convertToBoolean(_root_.io.prophecy.abinitio.ScalaFunctions._is_blank(context.config.TAL_ASSOC_NAME)))"
          },
          "ports" : {
            "inputs" : [ {
              "id" : "altexp_generate_cag_tal_container_xwalk__TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : { },
          "connections" : [ {
            "id" : "e1",
            "source" : "MRG_UnionAll",
            "sourcePort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__out",
            "target" : "MRG",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG__in"
          }, {
            "id" : "e24",
            "source" : "MRG",
            "sourcePort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG__out",
            "target" : "OFILE_Normalize_TAL_Assoc_data_UDL_level",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__OFILE_Normalize_TAL_Assoc_data_UDL_level__in"
          }, {
            "id" : "e39",
            "source" : "Expand_TAL_Assoc_Data_At_UDL_level",
            "sourcePort" : "altexp_generate_cag_tal_container_xwalk__TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__in",
            "target" : "Expand_target_UDL",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_target_UDL__in"
          }, {
            "id" : "e40",
            "source" : "Expand_TAL_Assoc_Data_At_UDL_level",
            "sourcePort" : "altexp_generate_cag_tal_container_xwalk__TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__in",
            "target" : "Expand_Alternate_UDL",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_Alternate_UDL__in"
          }, {
            "id" : "e26",
            "source" : "Expand_Alternate_UDL",
            "sourcePort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_Alternate_UDL__out",
            "target" : "MRG_UnionAll",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__in3"
          }, {
            "id" : "e25",
            "source" : "Expand_target_UDL",
            "sourcePort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_target_UDL__out",
            "target" : "MRG_UnionAll",
            "targetPort" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__in2"
          } ],
          "processes" : {
            "MRG" : {
              "id" : "MRG",
              "component" : "OrderBy",
              "metadata" : {
                "label" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG",
                "slug" : "MRG",
                "x" : 420,
                "y" : 120,
                "phase" : 4,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "columnsSelector" : [ ],
                "orders" : [ {
                  "expression" : {
                    "format" : "scala",
                    "expression" : "col(\"tal_assoc_id\")"
                  },
                  "sortType" : "asc"
                } ]
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/OrderBy",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "MRG_UnionAll" : {
              "id" : "MRG_UnionAll",
              "component" : "SetOperation",
              "metadata" : {
                "label" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll",
                "slug" : "MRG_UnionAll",
                "x" : 220,
                "y" : 120,
                "phase" : 4,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__in3",
                  "slug" : "in3",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                }, {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__in2",
                  "slug" : "in2",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__MRG_UnionAll__out",
                  "slug" : "out"
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "operationType" : "unionAll",
                "allowMissingColumns" : false
              },
              "componentInfo" : {
                "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/SetOperation",
                "projectName" : "ProphecySparkBasicsScala"
              }
            },
            "Expand_Alternate_UDL" : {
              "id" : "Expand_Alternate_UDL",
              "component" : "Script",
              "metadata" : {
                "label" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_Alternate_UDL",
                "slug" : "Expand_Alternate_UDL",
                "x" : 20,
                "y" : 20,
                "phase" : 4,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_Alternate_UDL__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_udl_info",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl_info",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_Alternate_UDL__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"alt_udl_info\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"udl_nm\")).as(\"udl_id\"),\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"udl_desc\")).as(\"udl_desc\"),\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"products\")).as(\"products\"),\n      (col(\"index\") + lit(1)).as(\"alt_rank\"),\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"constituent_group\")).as(\"constituent_group\"),\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"constituent_reqd\")).as(\"constituent_reqd\"),\n      (element_at(col(\"alt_udl_info\"), col(\"index\") + lit(1)).getField(\"constituent_rank\")).as(\"constituent_rank\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"tal_assoc_dtl_id\").cast(DecimalType(10, 0))).as(\"tal_assoc_dtl_id\"),\n    (col(\"tal_assoc_id\").cast(DecimalType(10,     0))).as(\"tal_assoc_id\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\"),\n    (col(\"tal_assoc_desc\")).as(\"tal_assoc_desc\"),\n    (col(\"tal_assoc_type_cd\").cast(StringType)).as(\"tal_assoc_type_cd\"),\n    (col(\"udl_id\")).as(\"udl_id\"),\n    (col(\"udl_desc\")).as(\"udl_desc\"),\n    (lit(\"ALTERNATIVE\")).as(\"Target_Alternative\"),\n    (col(\"products\")).as(\"products\"),\n    (col(\"alt_rank\")).as(\"alt_rank\"),\n    (col(\"shared_qual\")).as(\"shared_qual\"),\n    (col(\"override_tac_name\")).as(\"override_tac_name\"),\n    (col(\"override_tar_name\")).as(\"override_tar_name\"),\n    (col(\"constituent_group\")).as(\"constituent_group\"),\n    (col(\"constituent_reqd\")).as(\"constituent_reqd\"),\n    (col(\"constituent_rank\")).as(\"constituent_rank\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
                "scriptMethodFooter" : "out"
              }
            },
            "Expand_target_UDL" : {
              "id" : "Expand_target_UDL",
              "component" : "Script",
              "metadata" : {
                "label" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_target_UDL",
                "slug" : "Expand_target_UDL",
                "x" : 20,
                "y" : 220,
                "phase" : 4,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_target_UDL__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "target_udl_info",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_udl_info",
                      "type" : {
                        "type" : "array",
                        "elementType" : {
                          "type" : "struct",
                          "fields" : [ {
                            "name" : "udl_nm",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "udl_desc",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "products",
                            "type" : "binary",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_group",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_reqd",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          }, {
                            "name" : "constituent_rank",
                            "type" : "string",
                            "nullable" : true,
                            "metadata" : {
                              "description" : "",
                              "mappings" : [ ],
                              "tags" : [ ]
                            }
                          } ]
                        },
                        "containsNull" : true
                      },
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : false,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__Expand_target_UDL__out",
                  "slug" : "out",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : true,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "script" : "\n  val normalize_out_DF = in.normalize(\n    lengthExpression = Some(size(col(\"target_udl_info\"))),\n    finishedExpression = None,\n    finishedCondition = None,\n    alias = \"index\",\n    colsToSelect = List(\n      (element_at(col(\"target_udl_info\"), col(\"index\") + lit(1)).getField(\"udl_nm\")).as(\"udl_id\"),\n      (element_at(col(\"target_udl_info\"), col(\"index\") + lit(1)).getField(\"udl_desc\")).as(\"udl_desc\"),\n      (element_at(col(\"target_udl_info\"), col(\"index\") + lit(1)).getField(\"products\")).as(\"products\")\n    ),\n    lengthRelatedGlobalExpressions = Map(),\n    tempWindowExpr = Map()\n  )\n\n  val simpleSelect_in_DF = normalize_out_DF.select(\n    (col(\"tal_assoc_dtl_id\").cast(DecimalType(10, 0))).as(\"tal_assoc_dtl_id\"),\n    (col(\"tal_assoc_id\").cast(DecimalType(10,     0))).as(\"tal_assoc_id\"),\n    (col(\"tal_assoc_name\")).as(\"tal_assoc_name\"),\n    (col(\"clinical_indn_desc\")).as(\"clinical_indn_desc\"),\n    (col(\"tal_assoc_desc\")).as(\"tal_assoc_desc\"),\n    (col(\"tal_assoc_type_cd\").cast(StringType)).as(\"tal_assoc_type_cd\"),\n    (col(\"udl_id\")).as(\"udl_id\"),\n    (col(\"udl_desc\")).as(\"udl_desc\"),\n    (lit(\"TARGET\")).as(\"Target_Alternative\"),\n    (col(\"products\")).as(\"products\"),\n    (lit(null)).as(\"alt_rank\"),\n    (col(\"shared_qual\")).as(\"shared_qual\"),\n    (col(\"override_tac_name\")).as(\"override_tac_name\"),\n    (col(\"override_tar_name\")).as(\"override_tar_name\"),\n    (lit(null).cast(StringType)).as(\"constituent_group\"),\n    (lit(null).cast(StringType)).as(\"constituent_reqd\"),\n    (lit(null)).as(\"constituent_rank\"),\n    (col(\"newline\")).as(\"newline\")\n  )\n\n  val out = simpleSelect_in_DF\n",
                "scriptMethodHeader" : "def apply(spark: SparkSession, in: DataFrame) : Script = {",
                "scriptMethodFooter" : "out"
              }
            },
            "OFILE_Normalize_TAL_Assoc_data_UDL_level" : {
              "id" : "OFILE_Normalize_TAL_Assoc_data_UDL_level",
              "component" : "Target",
              "metadata" : {
                "label" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__OFILE_Normalize_TAL_Assoc_data_UDL_level",
                "slug" : "OFILE_Normalize_TAL_Assoc_data_UDL_level",
                "x" : 620,
                "y" : 120,
                "phase" : 3,
                "cache" : false,
                "detailedStats" : false,
                "isImported" : false
              },
              "ports" : {
                "inputs" : [ {
                  "id" : "TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__OFILE_Normalize_TAL_Assoc_data_UDL_level__in",
                  "slug" : "in",
                  "schema" : {
                    "type" : "struct",
                    "fields" : [ {
                      "name" : "tal_assoc_dtl_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_id",
                      "type" : "decimal(10,0)",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "clinical_indn_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "tal_assoc_type_cd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_id",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "udl_desc",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "Target_Alternative",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "products",
                      "type" : "binary",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "alt_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "shared_qual",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tac_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "override_tar_name",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_group",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_reqd",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "constituent_rank",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    }, {
                      "name" : "newline",
                      "type" : "string",
                      "nullable" : true,
                      "metadata" : {
                        "description" : "",
                        "mappings" : [ ],
                        "tags" : [ ]
                      }
                    } ]
                  },
                  "isStreaming" : false
                } ],
                "outputs" : [ ],
                "selectedInputFields" : [ ],
                "isCustomOutputSchema" : false,
                "autoUpdateOnRun" : false
              },
              "properties" : {
                "datasetId" : "datasets/TAL_Assoc_Crosswalk__Expand_TAL_Assoc_Data_At_UDL_level__OFILE_Normalize_TAL_Assoc_data_UDL_level"
              }
            }
          }
        },
        "Process_TAL_Association_Rows_output_select_filter" : {
          "id" : "Process_TAL_Association_Rows_output_select_filter",
          "component" : "Filter",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter",
            "slug" : "Process_TAL_Association_Rows_output_select_filter",
            "x" : 820,
            "y" : 220,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : false,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__in##tal_assoc_type_cd", "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__in##target_udl_info", "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_output_select_filter__in##alt_udl_info" ],
            "condition" : {
              "format" : "scala",
              "expression" : "when(\n    (array_contains(array(lit(1), lit(2)), col(\"tal_assoc_type_cd\").cast(IntegerType))\n      .and(!size(col(\"target_udl_info\")).cast(BooleanType)))\n      .or((!size(col(\"target_udl_info\")).cast(BooleanType)).and(!size(col(\"alt_udl_info\")).cast(BooleanType))),\n    lit(0).cast(BooleanType)\n  ).otherwise(lit(1).cast(BooleanType))"
            }
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Filter",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "Process_TAL_Association_Rows_Reformat" : {
          "id" : "Process_TAL_Association_Rows_Reformat",
          "component" : "Reformat",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_Reformat",
            "slug" : "Process_TAL_Association_Rows_Reformat",
            "x" : 620,
            "y" : 220,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_Reformat__in",
              "slug" : "in",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows_Reformat__out",
              "slug" : "out"
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "expressions" : [ {
              "target" : "tal_assoc_dtl_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_dtl_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_id",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_id\").cast(DecimalType(10, 0))"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_name\")"
              },
              "description" : ""
            }, {
              "target" : "clinical_indn_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"clinical_indn_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_desc",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_desc\")"
              },
              "description" : ""
            }, {
              "target" : "tal_assoc_type_cd",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"tal_assoc_type_cd\").cast(StringType)"
              },
              "description" : ""
            }, {
              "target" : "target_udl_info",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"target_udl_info\")"
              },
              "description" : ""
            }, {
              "target" : "alt_udl_info",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"alt_udl_info\")"
              },
              "description" : ""
            }, {
              "target" : "shared_qual",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"shared_qual\")"
              },
              "description" : ""
            }, {
              "target" : "override_tac_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"override_tac_name\")"
              },
              "description" : ""
            }, {
              "target" : "override_tar_name",
              "expression" : {
                "format" : "scala",
                "expression" : "col(\"override_tar_name\")"
              },
              "description" : ""
            }, {
              "target" : "newline",
              "expression" : {
                "format" : "scala",
                "expression" : "coalesce(col(\"newline\"), lit(\"\\n\"))"
              },
              "description" : ""
            } ]
          },
          "componentInfo" : {
            "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12651.git&subPath=&tag=0.1.2&projectSubscriptionProjectId=12651&path=gems/Reformat",
            "projectName" : "ProphecySparkBasicsScala"
          }
        },
        "tIeHH3ZzKfVwf8Q4a-yad$$PAgPIPtFRDrDeBmbizM6R" : {
          "id" : "tIeHH3ZzKfVwf8Q4a-yad$$PAgPIPtFRDrDeBmbizM6R",
          "component" : "Script",
          "metadata" : {
            "label" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows",
            "slug" : "TAL_Assoc_Crosswalk__Process_TAL_Association_Rows",
            "x" : 440,
            "y" : 220,
            "phase" : 4,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "NhZtf0VoTL2lHtiuPhFo4$$ECohY-qUkagj3JJytReIi",
              "slug" : "in0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_rank",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_group",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "constituent_reqd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "6Jcvo3egGxee_d29A9tUa$$Nn3PR1_wKvWtCmDC4Op68",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "tal_assoc_dtl_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_id",
                  "type" : "decimal(10,0)",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "clinical_indn_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_desc",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "tal_assoc_type_cd",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "target_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "alt_udl_info",
                  "type" : {
                    "type" : "array",
                    "elementType" : {
                      "type" : "struct",
                      "fields" : [ {
                        "name" : "udl_nm",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "udl_desc",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "products",
                        "type" : "binary",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_group",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_reqd",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      }, {
                        "name" : "constituent_rank",
                        "type" : "string",
                        "nullable" : true,
                        "metadata" : {
                          "description" : "",
                          "mappings" : [ ],
                          "tags" : [ ]
                        }
                      } ]
                    },
                    "containsNull" : true
                  },
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "shared_qual",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tac_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "override_tar_name",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                }, {
                  "name" : "newline",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  }
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true,
            "autoUpdateOnRun" : false
          },
          "properties" : {
            "script" : "import _root_.io.prophecy.abinitio.ScalaFunctions._\nval process_udf = udf(\n    { (inputRows: Seq[Row], clinical_indn_desc: Array[String]) \n    var target_prdcts_info  = Array[Row]()\n    var all_target_prdcts   = Array[Byte]()\n    var all_alt_prdcts      = Array[Byte]()\n    var alt_prdcts_info     = Array[Row]()\n    var target_udl_name     = Array[String]()\n    var alternate_udl_name  = Array[String]()\n    var clinc_indi_info     = Array[Row]()\n    var _tal_assoc_name     = Array[String]()\n    var _clinical_indn_desc = Array[String]()\n\n    inputRows.foreach { row \n        if (\n        !_isnull(row.getAs[String](\"target_udl_name\")) && !target_udl_name\n            .contains(row.getAs[String](\"target_udl_name\"))\n        ) {\n        var trgt_prdcts_lkp = row.getAs[Row](\"trgt_prdcts_lkp\")\n        if (!_isnull(trgt_prdcts_lkp.getAs[String](\"udl_nm\"))) {\n            if (_bv_count_one_bits(trgt_prdcts_lkp.getAs[Array[Byte]](\"products\")) > 0) {\n            target_prdcts_info = Array.concat(target_prdcts_info, Array.fill(1)(trgt_prdcts_lkp))\n            }\n        }\n        target_udl_name = Array.concat(target_udl_name, Array.fill(1)(row.getAs[String](\"target_udl_name\")))\n        }\n\n        if (\n        !_isnull(row.getAs[String](\"alt_udl_name\")) && !alternate_udl_name\n            .contains(row.getAs[String](\"alt_udl_name\"))\n        ) {\n        var alt_prdcts_lkp = row.getAs[Row](\"alt_prdcts_lkp\")\n        if (!_isnull(alt_prdcts_lkp.getAs[String](\"udl_nm\"))) {\n            if (_bv_count_one_bits(alt_prdcts_lkp.getAs[Array[Byte]](\"products\")) > 0) {\n            alt_prdcts_info = Array.concat(alt_prdcts_info, Array.fill(1)(alt_prdcts_lkp))\n            }\n        }\n        alternate_udl_name = Array.concat(alternate_udl_name, Array.fill(1)(row.getAs[String](\"alt_udl_name\")))\n        }\n    }\n\n    var lastRow = inputRows.toArray.last\n\n    if (!_tal_assoc_name.contains(lastRow.getAs[String](\"tal_assoc_name\"))) {\n        _clinical_indn_desc = clinical_indn_desc\n        clinc_indi_info =\n        Array.concat(clinc_indi_info,\n                        Array.fill(1)(Row(lastRow.getAs[String](\"tal_assoc_name\"), _clinical_indn_desc))\n        )\n    } else {\n        var idx = _tal_assoc_name.indexOf(lastRow.getAs[String](\"tal_assoc_name\"))\n        if (idx < _clinical_indn_desc.length)\n        _clinical_indn_desc = clinc_indi_info(idx).getAs[Array[String]](1)\n    }\n    if (lastRow.getAs[String](\"tal_assoc_type_cd\").toInt == 3) {\n        target_prdcts_info =\n        if (target_prdcts_info.isEmpty && alt_prdcts_info.nonEmpty) Array(Row(\"\", \"\", _bv_all_zeros()))\n        else target_prdcts_info\n        alt_prdcts_info =\n        if (target_prdcts_info.nonEmpty && alt_prdcts_info.isEmpty) Array(Row(\"\", \"\", _bv_all_zeros(), \"\", \"\", \"\"))\n        else alt_prdcts_info\n    }\n\n    Row(\n        lastRow.getAs[java.math.BigDecimal](\"tal_assoc_dtl_id\"),\n        lastRow.getAs[java.math.BigDecimal](\"tal_assoc_id\"),\n        lastRow.getAs[String](\"tal_assoc_name\"),\n        _clinical_indn_desc.mkString(\"\\\\|\"),\n        lastRow.getAs[String](\"tal_assoc_desc\"),\n        lastRow.getAs[String](\"tal_assoc_type_cd\"),\n        target_prdcts_info,\n        alt_prdcts_info,\n        lastRow.getAs[String](\"shared_qual\"),\n        lastRow.getAs[String](\"override_tac_name\"),\n        lastRow.getAs[String](\"override_tar_name\"),\n        lastRow.getAs[String](\"newline\")\n    )\n    },\n    StructType(\n    List(\n        StructField(\"tal_assoc_dtl_id\",   DecimalType(10, 0), true),\n        StructField(\"tal_assoc_id\",       DecimalType(10, 0), true),\n        StructField(\"tal_assoc_name\",     StringType,         true),\n        StructField(\"clinical_indn_desc\", StringType,         true),\n        StructField(\"tal_assoc_desc\",     StringType,         true),\n        StructField(\"tal_assoc_type_cd\",  StringType,         true),\n        StructField(\n        \"target_udl_info\",\n        ArrayType(StructType(\n                    List(StructField(\"udl_nm\",   StringType, true),\n                            StructField(\"udl_desc\", StringType, true),\n                            StructField(\"products\", BinaryType, true)\n                    )\n                    ),\n                    true\n        ),\n        true\n        ),\n        StructField(\n        \"alt_udl_info\",\n        ArrayType(\n            StructType(\n            List(\n                StructField(\"udl_nm\",            StringType, true),\n                StructField(\"udl_desc\",          StringType, true),\n                StructField(\"products\",          BinaryType, true),\n                StructField(\"constituent_group\", StringType, true),\n                StructField(\"constituent_reqd\",  StringType, true),\n                StructField(\"constituent_rank\",  StringType, true)\n            )\n            ),\n            true\n        ),\n        true\n        ),\n        StructField(\"shared_qual\",       StringType, true),\n        StructField(\"override_tac_name\", StringType, true),\n        StructField(\"override_tar_name\", StringType, true),\n        StructField(\"newline\",           StringType, true)\n    )\n    )\n)\n\nval origColumns = in0.columns.map(col)\nval out0 = in0\n    .groupBy(\"tal_assoc_id\")\n    .agg(\n    collect_list(\n        struct(\n        (origColumns :+ lookup(\"Expanded_UDL\", col(\"target_udl_name\")).alias(\"trgt_prdcts_lkp\")\n            :+ lookup(\"Expanded_UDL\", col(\"alt_udl_name\")).alias(\"alt_prdcts_lkp\"): _*) //15,16\n        ).alias(\"inputRows\")\n    ),\n    transform(lookup_row(\"LKP_CLIN_INDCN\", last(col(\"tal_assoc_name\"))),\n                xx  coalesce(xx.getField(\"clinical_indn_desc\"), lit(\"N/A\"))\n    ).alias(\"clinical_indn_desc\")\n    )\n    .select((process_udf(col(\"inputRows\"), col(\"clinical_indn_desc\"))).alias(\"output\"))\n    .select(col(\"output.*\"))",
            "scriptMethodHeader" : "def apply(spark: SparkSession, in0: DataFrame): DataFrame = {",
            "scriptMethodFooter" : "    out0\n}"
          }
        }
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}