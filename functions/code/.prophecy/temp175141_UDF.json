{"initCode":"","code":"udf((_nested_tal_l1_dtl: Seq[Row], _priority: String, _nested_tal_l1_cnt: Integer, _TAL_Container_Dtls_lookup_count_2: Integer, __l1_denominator: String, __l2_factor: String, _i: Integer, _TAL_Container_Dtls_lookup_count: Integer, _TAL_Container_Dtls_lookup_row: Seq[Row], _tal_dtl_final: Seq[Row], __l1_factor: String, __l1_assocition_cnt: String) => {\n  var nested_tal_l1_dtl = (_nested_tal_l1_dtl).toArray\nvar priority = convertToBigDecimal(_priority)\nvar nested_tal_l1_cnt = _nested_tal_l1_cnt\nvar TAL_Container_Dtls_lookup_count_2 = _TAL_Container_Dtls_lookup_count_2\nvar _l1_denominator = convertToBigDecimal(__l1_denominator)\nvar j = 0\nvar _l2_factor = convertToBigDecimal(__l2_factor)\nvar i = _i\nvar TAL_Container_Dtls_lookup_count = _TAL_Container_Dtls_lookup_count\nvar TAL_Container_Dtls_lookup_row = (_TAL_Container_Dtls_lookup_row).toArray\nvar tal_dtl_final = (_tal_dtl_final).toArray\nvar _l1_factor = convertToBigDecimal(__l1_factor)\nvar nested_tal_l2_cnt = 0\nvar _l1_assocition_cnt = convertToBigDecimal(__l1_assocition_cnt)\n\nwhile(compareTo(i, nested_tal_l1_cnt) < 0) {\nif(!_isnull(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_assoc_name\"))){\nnested_tal_l1_dtl(i) = Row(convertToBigDecimal(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_dtl_id\")), convertToBigDecimal(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_id\")), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_name\"), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_desc\"), convertToBigDecimal(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_dtl_type_cd\")), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"nested_tal_name\"), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"tal_assoc_name\"), priority + (convertToBigDecimal(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"priority\")) / (_l1_denominator * convertToBigDecimal(_l1_factor / _l1_assocition_cnt))), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"eff_dt\"), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"term_dt\"), nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"newline\"))\ntal_dtl_final = Array.concat(tal_dtl_final,Array.fill(1)(nested_tal_l1_dtl(convertToInt(i))))\n} else {nested_tal_l2_cnt = convertToInt(TAL_Container_Dtls_lookup_count)\nvar j = 0\nval (tal_dtl_final, nested_tal_l2_dtl, j) = temp174017_UDF(nested_tal_l1_dtl, priority, _l1_denominator, 0, _l2_factor, i, TAL_Container_Dtls_lookup_count, TAL_Container_Dtls_lookup_row_175327(convertToInt(i)), tal_dtl_final, _l1_factor, _l1_assocition_cnt)}\ni = i + 1\n}\n\nRow(nested_tal_l1_dtl.map{x => Row((x.get(0)).toString, (x.get(1)).toString, (x.get(2)).toString, (x.get(3)).toString, (x.get(4)).toString, (x.get(5)).toString, (x.get(6)).toString, (x.get(7)).toString, x.get(8), x.get(9), (x.get(10)).toString)}.toArray, convertToInt(j), convertToInt(i), tal_dtl_final.map{x => Row((x.get(0)).toString, (x.get(1)).toString, (x.get(2)).toString, (x.get(3)).toString, (x.get(4)).toString, (x.get(5)).toString, (x.get(6)).toString, (x.get(7)).toString, x.get(8), x.get(9), (x.get(10)).toString)}.toArray, convertToInt(nested_tal_l2_cnt))\n},  StructType(\n      List(\n      StructField(\"nested_tal_l1_dtl\", ArrayType( StructType(\n      List(\n      StructField(\"tal_dtl_id\", DecimalType(9, 0), false),StructField(\"tal_id\", DecimalType(9, 0), false),StructField(\"tal_name\", StringType, false),StructField(\"tal_desc\", StringType, false),StructField(\"tal_dtl_type_cd\", DecimalType(38, 0), false),StructField(\"nested_tal_name\", StringType, true),StructField(\"tal_assoc_name\", StringType, true),StructField(\"priority\", DecimalType(38, 6), false),StructField(\"eff_dt\", StringType, false),StructField(\"term_dt\", StringType, false),StructField(\"newline\", StringType, true)\n      )\n    )), false),StructField(\"j\", IntegerType, false),StructField(\"i\", IntegerType, false),StructField(\"tal_dtl_final\", ArrayType( StructType(\n      List(\n      StructField(\"tal_dtl_id\", DecimalType(9, 0), false),StructField(\"tal_id\", DecimalType(9, 0), false),StructField(\"tal_name\", StringType, false),StructField(\"tal_desc\", StringType, false),StructField(\"tal_dtl_type_cd\", DecimalType(38, 0), false),StructField(\"nested_tal_name\", StringType, true),StructField(\"tal_assoc_name\", StringType, true),StructField(\"priority\", DecimalType(38, 6), false),StructField(\"eff_dt\", StringType, false),StructField(\"term_dt\", StringType, false),StructField(\"newline\", StringType, true)\n      )\n    )), false),StructField(\"nested_tal_l2_cnt\", IntegerType, false)\n      )\n    ))"}