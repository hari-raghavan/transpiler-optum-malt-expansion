{"initCode":"","code":"udf((_nested_tal_l1_dtl: Seq[Row], _priority: String, __l1_denominator: String, _j: Integer, __l2_factor: String, _i: Integer, _TAL_Container_Dtls_lookup_count: Integer, _TAL_Container_Dtls_lookup_row: Seq[Row], _tal_dtl_final: Seq[Row], __l1_factor: String, __l1_assocition_cnt: String) => {\n  var nested_tal_l1_dtl = (_nested_tal_l1_dtl).toArray\nvar priority = convertToBigDecimal(_priority)\nvar _l1_denominator = convertToBigDecimal(__l1_denominator)\nvar j = _j\nvar nested_tal_l2_dtl = Row(0.0, 0.0, \"\", \"\", 0.0, null, null, 0.0, \" \", \" \", \"\"\"\n\"\"\")\nvar _l2_factor = convertToBigDecimal(__l2_factor)\nvar i = _i\nvar TAL_Container_Dtls_lookup_count = _TAL_Container_Dtls_lookup_count\nvar TAL_Container_Dtls_lookup_row = (_TAL_Container_Dtls_lookup_row).toArray\nvar tal_dtl_final = (_tal_dtl_final).toArray\nvar _l1_factor = convertToBigDecimal(__l1_factor)\nvar _l1_assocition_cnt = convertToBigDecimal(__l1_assocition_cnt)\n\nwhile(compareTo(j, convertToInt(TAL_Container_Dtls_lookup_count)) < 0) {\nvar nested_tal_l2_dtl = Row(0.0, 0.0, \"\", \"\", 0.0, null, null, 0.0, \" \", \" \", \"\"\"\n\"\"\")\nnested_tal_l2_dtl = TAL_Container_Dtls_lookup_row(convertToInt(j))\nnested_tal_l2_dtl = updateIndexInRow(nested_tal_l2_dtl, 7, (priority + (convertToBigDecimal(nested_tal_l1_dtl(convertToInt(i)).getAs[String](\"priority\")) / (_l1_denominator * convertToBigDecimal(_l1_factor / _l1_assocition_cnt)))) + (convertToBigDecimal(nested_tal_l2_dtl.getAs[String](\"priority\")) / (_l2_factor * convertToBigDecimal(_l2_factor))))\ntal_dtl_final = Array.concat(tal_dtl_final,Array.fill(1)(nested_tal_l2_dtl))\nj = j + 1\n}\n\nRow(tal_dtl_final.map{x => Row((x.get(0)).toString, (x.get(1)).toString, (x.get(2)).toString, (x.get(3)).toString, (x.get(4)).toString, (x.get(5)).toString, (x.get(6)).toString, (x.get(7)).toString, x.get(8), x.get(9), (x.get(10)).toString)}.toArray, Row((nested_tal_l2_dtl.get(0)).toString, (nested_tal_l2_dtl.get(1)).toString, (nested_tal_l2_dtl.get(2)).toString, (nested_tal_l2_dtl.get(3)).toString, (nested_tal_l2_dtl.get(4)).toString, (nested_tal_l2_dtl.get(5)).toString, (nested_tal_l2_dtl.get(6)).toString, (nested_tal_l2_dtl.get(7)).toString, nested_tal_l2_dtl.get(8), nested_tal_l2_dtl.get(9), (nested_tal_l2_dtl.get(10)).toString), convertToInt(j))\n},  StructType(\n      List(\n      StructField(\"tal_dtl_final\", ArrayType( StructType(\n      List(\n      StructField(\"tal_dtl_id\", DecimalType(9, 0), false),StructField(\"tal_id\", DecimalType(9, 0), false),StructField(\"tal_name\", StringType, false),StructField(\"tal_desc\", StringType, false),StructField(\"tal_dtl_type_cd\", DecimalType(38, 0), false),StructField(\"nested_tal_name\", StringType, true),StructField(\"tal_assoc_name\", StringType, true),StructField(\"priority\", DecimalType(38, 6), false),StructField(\"eff_dt\", StringType, false),StructField(\"term_dt\", StringType, false),StructField(\"newline\", StringType, true)\n      )\n    )), false),StructField(\"nested_tal_l2_dtl\",  StructType(\n      List(\n      StructField(\"tal_dtl_id\", DecimalType(9, 0), false),StructField(\"tal_id\", DecimalType(9, 0), false),StructField(\"tal_name\", StringType, false),StructField(\"tal_desc\", StringType, false),StructField(\"tal_dtl_type_cd\", DecimalType(38, 0), false),StructField(\"nested_tal_name\", StringType, true),StructField(\"tal_assoc_name\", StringType, true),StructField(\"priority\", DecimalType(38, 6), false),StructField(\"eff_dt\", StringType, false),StructField(\"term_dt\", StringType, false),StructField(\"newline\", StringType, true)\n      )\n    ), false),StructField(\"j\", IntegerType, false)\n      )\n    ))"}